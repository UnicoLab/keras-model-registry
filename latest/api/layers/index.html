
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../examples/data_analyzer_examples/">
      
      
        <link rel="next" href="../models/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>Layers - KerasFactory</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.75 1.75 0 0 1 1 7.775m1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.5 1.75v11.5c0 .138.112.25.25.25h3.17a.75.75 0 0 1 0 1.5H2.75A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8.5C12.216 0 13 .784 13 1.75v7.736a.75.75 0 0 1-1.5 0V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25m13.274 9.537zl-4.557 4.45a.75.75 0 0 1-1.055-.008l-1.943-1.95a.75.75 0 0 1 1.062-1.058l1.419 1.425 4.026-3.932a.75.75 0 1 1 1.048 1.074M4.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5M4 7.75A.75.75 0 0 1 4.75 7h2a.75.75 0 0 1 0 1.5h-2A.75.75 0 0 1 4 7.75"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13M6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75M8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3.499.75a.75.75 0 0 1 1.5 0v.996C5.9 2.903 6.793 3.65 7.662 4.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873 10.794-.045 12.622.26 14.408.558 16 1.94 16 4.25c0 1.278-.954 2.575-2.44 2.734l.146.508.065.22c.203.701.412 1.455.476 2.226.142 1.707-.4 3.03-1.487 3.898C11.714 14.671 10.27 15 8.75 15h-6a.75.75 0 0 1 0-1.5h1.376a4.5 4.5 0 0 1-.563-1.191 3.84 3.84 0 0 1-.05-2.063 4.65 4.65 0 0 1-2.025-.293.75.75 0 0 1 .525-1.406c1.357.507 2.376-.006 2.698-.318l.009-.01a.747.747 0 0 1 1.06 0 .75.75 0 0 1-.012 1.074c-.912.92-.992 1.835-.768 2.586.221.74.745 1.337 1.196 1.621H8.75c1.343 0 2.398-.296 3.074-.836.635-.507 1.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.4 2.4 0 0 1-.507-.441 3.1 3.1 0 0 1-.633-1.248.75.75 0 0 1 1.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738 0 1.25-.615 1.25-1.25 0-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706 1.345-.46.92-.27 1.774.019 3.062l.042.19.01.05c.348.443.666.949.94 1.553a.75.75 0 1 1-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7 5.527c-.814-.68-1.75-1.462-2.692-2.619a3.7 3.7 0 0 0-1.023.88c-.406.495-.663 1.036-.722 1.508.116.122.306.21.591.239.388.038.797-.06 1.032-.19a.75.75 0 0 1 .728 1.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75 5.677V5.5c0-.984.48-1.94 1.077-2.664.46-.559 1.05-1.055 1.673-1.353z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.75.75 0 0 1 .018-1.042.75.75 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13M6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.76 2.76 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6 6 0 0 0-.26.16 1 1 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661q.154-.1.313-.195l.007-.004c.1-.061.182-.11.258-.161a1 1 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.61.61 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1 1 0 0 0-.34.398M9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0M9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.344 2.343za8 8 0 0 1 11.314 11.314A8.002 8.002 0 0 1 .234 10.089a8 8 0 0 1 2.11-7.746m1.06 10.253a6.5 6.5 0 1 0 9.108-9.275 6.5 6.5 0 0 0-9.108 9.275M6.03 4.97 8 6.94l1.97-1.97a.749.749 0 0 1 1.275.326.75.75 0 0 1-.215.734L9.06 8l1.97 1.97a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215L8 9.06l-1.97 1.97a.749.749 0 0 1-1.275-.326.75.75 0 0 1 .215-.734L6.94 8 4.97 6.03a.75.75 0 0 1 .018-1.042.75.75 0 0 1 1.042-.018"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M9.504.43a1.516 1.516 0 0 1 2.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.25 1.25 0 0 1-.871.354h-.302a1.25 1.25 0 0 1-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004zm1.047 1.074L3.286 8.571A.25.25 0 0 0 3.462 9H6.75a.75.75 0 0 1 .694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0 0 12.538 7H9.25a.75.75 0 0 1-.683-1.06l2.008-4.418.003-.006-.004-.009-.006-.006-.008-.001q-.005 0-.009.004"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4.72.22a.75.75 0 0 1 1.06 0l1 .999a3.5 3.5 0 0 1 2.441 0l.999-1a.748.748 0 0 1 1.265.332.75.75 0 0 1-.205.729l-.775.776c.616.63.995 1.493.995 2.444v.327q0 .15-.025.292c.408.14.764.392 1.029.722l1.968-.787a.75.75 0 0 1 .556 1.392L13 7.258V9h2.25a.75.75 0 0 1 0 1.5H13v.5q-.002.615-.141 1.186l2.17.868a.75.75 0 0 1-.557 1.392l-2.184-.873A5 5 0 0 1 8 16a5 5 0 0 1-4.288-2.427l-2.183.873a.75.75 0 0 1-.558-1.392l2.17-.868A5 5 0 0 1 3 11v-.5H.75a.75.75 0 0 1 0-1.5H3V7.258L.971 6.446a.75.75 0 0 1 .558-1.392l1.967.787c.265-.33.62-.583 1.03-.722a1.7 1.7 0 0 1-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72 1.28a.75.75 0 0 1 0-1.06m.53 6.28a.75.75 0 0 0-.75.75V11a3.5 3.5 0 1 0 7 0V7.25a.75.75 0 0 0-.75-.75ZM6.173 5h3.654A.17.17 0 0 0 10 4.827V4.5a2 2 0 1 0-4 0v.327c0 .096.077.173.173.173"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.75.75 0 0 1 9.5 6Z"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.75 2.5h10.5a.75.75 0 0 1 0 1.5H1.75a.75.75 0 0 1 0-1.5m4 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5m0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5M2.5 7.75v6a.75.75 0 0 1-1.5 0v-6a.75.75 0 0 1 1.5 0"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="pink">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#layers-api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="KerasFactory" class="md-header__button md-logo" aria-label="KerasFactory" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 11a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1M4.22 4.22C5.65 2.79 8.75 3.43 12 5.56c3.25-2.13 6.35-2.77 7.78-1.34s.79 4.53-1.34 7.78c2.13 3.25 2.77 6.35 1.34 7.78s-4.53.79-7.78-1.34c-3.25 2.13-6.35 2.77-7.78 1.34S3.43 15.25 5.56 12C3.43 8.75 2.79 5.65 4.22 4.22m11.32 4.24c.61.62 1.17 1.25 1.69 1.88 1.38-2.13 1.88-3.96 1.13-4.7-.74-.75-2.57-.25-4.7 1.13.63.52 1.26 1.08 1.88 1.69m-7.08 7.08c-.61-.62-1.17-1.25-1.69-1.88-1.38 2.13-1.88 3.96-1.13 4.7.74.75 2.57.25 4.7-1.13-.63-.52-1.26-1.08-1.88-1.69m-2.82-9.9c-.75.74-.25 2.57 1.13 4.7.52-.63 1.08-1.26 1.69-1.88.62-.61 1.25-1.17 1.88-1.69-2.13-1.38-3.96-1.88-4.7-1.13m4.24 8.48c.7.7 1.42 1.34 2.12 1.91.7-.57 1.42-1.21 2.12-1.91s1.34-1.42 1.91-2.12c-.57-.7-1.21-1.42-1.91-2.12S12.7 8.54 12 7.97c-.7.57-1.42 1.21-2.12 1.91S8.54 11.3 7.97 12c.57.7 1.21 1.42 1.91 2.12m8.48 4.24c.75-.74.25-2.57-1.13-4.7-.52.63-1.08 1.26-1.69 1.88-.62.61-1.25 1.17-1.88 1.69 2.13 1.38 3.96 1.88 4.7 1.13"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            KerasFactory
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Layers
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="pink"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="pink"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/UnicoLab/KerasFactory" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    KerasFactory
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting-started/quickstart/" class="md-tabs__link">
          
  
    
  
  üöÄ Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../layers_overview/" class="md-tabs__link">
          
  
    
  
  üß© Layers

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tutorials/basic-workflows/" class="md-tabs__link">
          
  
    
  
  üìö Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../examples/" class="md-tabs__link">
          
  
    
  
  üìñ Examples

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
    
  
  üìë API Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../contributing/" class="md-tabs__link">
          
  
    
  
  ü§ù Contributing

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="KerasFactory" class="md-nav__button md-logo" aria-label="KerasFactory" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 11a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1M4.22 4.22C5.65 2.79 8.75 3.43 12 5.56c3.25-2.13 6.35-2.77 7.78-1.34s.79 4.53-1.34 7.78c2.13 3.25 2.77 6.35 1.34 7.78s-4.53.79-7.78-1.34c-3.25 2.13-6.35 2.77-7.78 1.34S3.43 15.25 5.56 12C3.43 8.75 2.79 5.65 4.22 4.22m11.32 4.24c.61.62 1.17 1.25 1.69 1.88 1.38-2.13 1.88-3.96 1.13-4.7-.74-.75-2.57-.25-4.7 1.13.63.52 1.26 1.08 1.88 1.69m-7.08 7.08c-.61-.62-1.17-1.25-1.69-1.88-1.38 2.13-1.88 3.96-1.13 4.7.74.75 2.57.25 4.7-1.13-.63-.52-1.26-1.08-1.88-1.69m-2.82-9.9c-.75.74-.25 2.57 1.13 4.7.52-.63 1.08-1.26 1.69-1.88.62-.61 1.25-1.17 1.88-1.69-2.13-1.38-3.96-1.88-4.7-1.13m4.24 8.48c.7.7 1.42 1.34 2.12 1.91.7-.57 1.42-1.21 2.12-1.91s1.34-1.42 1.91-2.12c-.57-.7-1.21-1.42-1.91-2.12S12.7 8.54 12 7.97c-.7.57-1.42 1.21-2.12 1.91S8.54 11.3 7.97 12c.57.7 1.21 1.42 1.91 2.12m8.48 4.24c.75-.74.25-2.57-1.13-4.7-.52.63-1.08 1.26-1.69 1.88-.62.61-1.25 1.17-1.88 1.69 2.13 1.38 3.96 1.88 4.7 1.13"/></svg>

    </a>
    KerasFactory
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/UnicoLab/KerasFactory" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    KerasFactory
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üöÄ Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            üöÄ Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick Start
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/concepts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Core Concepts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üß© Layers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            üß© Layers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Layer Overview & Explorer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üß† Attention
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            üß† Attention
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/tabular-attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TabularAttention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/multi-resolution-tabular-attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MultiResolutionTabularAttention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/column-attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ColumnAttention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/row-attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RowAttention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/interpretable-multi-head-attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    InterpretableMultiHeadAttention
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üîß Preprocessing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            üîß Preprocessing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/differentiable-tabular-preprocessor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DifferentiableTabularPreprocessor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/differential-preprocessing-layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DifferentialPreprocessingLayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/date-parsing-layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DateParsingLayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/date-encoding-layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DateEncodingLayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/season-layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SeasonLayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/cast-to-float32-layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CastToFloat32Layer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ‚öôÔ∏è Feature Engineering
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            ‚öôÔ∏è Feature Engineering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/variable-selection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VariableSelection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/gated-feature-selection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GatedFeatureSelection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/gated-feature-fusion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GatedFeatureFusion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/advanced-numerical-embedding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AdvancedNumericalEmbedding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/distribution-aware-encoder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DistributionAwareEncoder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/distribution-transform-layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DistributionTransformLayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/sparse-attention-weighting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SparseAttentionWeighting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/feature-cutout/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FeatureCutout
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üèóÔ∏è Specialized
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            üèóÔ∏è Specialized
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/gated-residual-network/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GatedResidualNetwork
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/gated-linear-unit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GatedLinearUnit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/transformer-block/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TransformerBlock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/tabular-moe-layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TabularMoELayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/boosting-block/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BoostingBlock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/boosting-ensemble-layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BoostingEnsembleLayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/business-rules-layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BusinessRulesLayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/stochastic-depth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StochasticDepth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/slow-network/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SlowNetwork
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/hyper-zzw-operator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HyperZZWOperator
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üõ†Ô∏è Utility
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            üõ†Ô∏è Utility
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/advanced-graph-feature/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AdvancedGraphFeature
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/graph-feature-aggregation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GraphFeatureAggregation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/multi-head-graph-feature-preprocessor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MultiHeadGraphFeaturePreprocessor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/numerical-anomaly-detection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NumericalAnomalyDetection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/categorical-anomaly-detection-layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CategoricalAnomalyDetectionLayer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ‚è∞ Time Series
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            ‚è∞ Time Series
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/moving-average/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MovingAverage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/series-decomposition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SeriesDecomposition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/dft-series-decomposition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFTSeriesDecomposition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/reversible-instance-norm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReversibleInstanceNorm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/reversible-instance-norm-multivariate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReversibleInstanceNormMultivariate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/positional-embedding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PositionalEmbedding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/fixed-embedding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FixedEmbedding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/token-embedding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TokenEmbedding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/temporal-embedding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TemporalEmbedding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/data-embedding-without-position/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DataEmbeddingWithoutPosition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/temporal-mixing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TemporalMixing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/feature-mixing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FeatureMixing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/mixing-layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MixingLayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/multi-scale-season-mixing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MultiScaleSeasonMixing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/multi-scale-trend-mixing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MultiScaleTrendMixing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/past-decomposable-mixing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PastDecomposableMixing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üìö Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            üìö Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/basic-workflows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Workflows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/feature-engineering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feature Engineering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/model-building/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Building
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../examples/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    üìñ Examples
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            üìñ Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/rich_docstrings_showcase/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rich Docstrings Showcase
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/feed_forward_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BaseFeedForwardModel Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/kdp_integration_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    KDP Integration Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/data_analyzer_examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Analyzer Examples
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    üìë API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            üìë API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Layers
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Layers
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#time-series-forecasting" class="md-nav__link">
    <span class="md-ellipsis">
      ‚è±Ô∏è Time Series &amp; Forecasting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="‚è±Ô∏è Time Series & Forecasting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#positionalembedding" class="md-nav__link">
    <span class="md-ellipsis">
      üìç PositionalEmbedding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.PositionalEmbedding" class="md-nav__link">
    <span class="md-ellipsis">
      PositionalEmbedding
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PositionalEmbedding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.PositionalEmbedding-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.PositionalEmbedding.PositionalEmbedding" class="md-nav__link">
    <span class="md-ellipsis">
      PositionalEmbedding
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fixedembedding" class="md-nav__link">
    <span class="md-ellipsis">
      üîß FixedEmbedding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.FixedEmbedding" class="md-nav__link">
    <span class="md-ellipsis">
      FixedEmbedding
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FixedEmbedding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.FixedEmbedding-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.FixedEmbedding.FixedEmbedding" class="md-nav__link">
    <span class="md-ellipsis">
      FixedEmbedding
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tokenembedding" class="md-nav__link">
    <span class="md-ellipsis">
      üé´ TokenEmbedding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TokenEmbedding" class="md-nav__link">
    <span class="md-ellipsis">
      TokenEmbedding
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TokenEmbedding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TokenEmbedding-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TokenEmbedding.TokenEmbedding" class="md-nav__link">
    <span class="md-ellipsis">
      TokenEmbedding
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#temporalembedding" class="md-nav__link">
    <span class="md-ellipsis">
      ‚è∞ TemporalEmbedding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TemporalEmbedding" class="md-nav__link">
    <span class="md-ellipsis">
      TemporalEmbedding
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TemporalEmbedding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TemporalEmbedding-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TemporalEmbedding.TemporalEmbedding" class="md-nav__link">
    <span class="md-ellipsis">
      TemporalEmbedding
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataembeddingwithoutposition" class="md-nav__link">
    <span class="md-ellipsis">
      üéØ DataEmbeddingWithoutPosition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DataEmbeddingWithoutPosition" class="md-nav__link">
    <span class="md-ellipsis">
      DataEmbeddingWithoutPosition
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DataEmbeddingWithoutPosition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DataEmbeddingWithoutPosition-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DataEmbeddingWithoutPosition.DataEmbeddingWithoutPosition" class="md-nav__link">
    <span class="md-ellipsis">
      DataEmbeddingWithoutPosition
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#movingaverage" class="md-nav__link">
    <span class="md-ellipsis">
      üèÉ MovingAverage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MovingAverage" class="md-nav__link">
    <span class="md-ellipsis">
      MovingAverage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MovingAverage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MovingAverage-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MovingAverage.MovingAverage" class="md-nav__link">
    <span class="md-ellipsis">
      MovingAverage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seriesdecomposition" class="md-nav__link">
    <span class="md-ellipsis">
      üîÄ SeriesDecomposition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.SeriesDecomposition" class="md-nav__link">
    <span class="md-ellipsis">
      SeriesDecomposition
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SeriesDecomposition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.SeriesDecomposition-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.SeriesDecomposition.SeriesDecomposition" class="md-nav__link">
    <span class="md-ellipsis">
      SeriesDecomposition
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dftseriesdecomposition" class="md-nav__link">
    <span class="md-ellipsis">
      üìä DFTSeriesDecomposition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DFTSeriesDecomposition" class="md-nav__link">
    <span class="md-ellipsis">
      DFTSeriesDecomposition
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DFTSeriesDecomposition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DFTSeriesDecomposition-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DFTSeriesDecomposition.DFTSeriesDecomposition" class="md-nav__link">
    <span class="md-ellipsis">
      DFTSeriesDecomposition
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reversibleinstancenorm" class="md-nav__link">
    <span class="md-ellipsis">
      üîÑ ReversibleInstanceNorm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.ReversibleInstanceNorm" class="md-nav__link">
    <span class="md-ellipsis">
      ReversibleInstanceNorm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ReversibleInstanceNorm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.ReversibleInstanceNorm-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.ReversibleInstanceNorm.ReversibleInstanceNorm" class="md-nav__link">
    <span class="md-ellipsis">
      ReversibleInstanceNorm
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reversibleinstancenormmultivariate" class="md-nav__link">
    <span class="md-ellipsis">
      üèóÔ∏è ReversibleInstanceNormMultivariate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.ReversibleInstanceNormMultivariate" class="md-nav__link">
    <span class="md-ellipsis">
      ReversibleInstanceNormMultivariate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ReversibleInstanceNormMultivariate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.ReversibleInstanceNormMultivariate-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.ReversibleInstanceNormMultivariate.ReversibleInstanceNormMultivariate" class="md-nav__link">
    <span class="md-ellipsis">
      ReversibleInstanceNormMultivariate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiscaleseasonmixing" class="md-nav__link">
    <span class="md-ellipsis">
      üåä MultiScaleSeasonMixing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MultiScaleSeasonMixing" class="md-nav__link">
    <span class="md-ellipsis">
      MultiScaleSeasonMixing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MultiScaleSeasonMixing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MultiScaleSeasonMixing-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MultiScaleSeasonMixing.MultiScaleSeasonMixing" class="md-nav__link">
    <span class="md-ellipsis">
      MultiScaleSeasonMixing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiscaletrendmixing" class="md-nav__link">
    <span class="md-ellipsis">
      üìà MultiScaleTrendMixing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MultiScaleTrendMixing" class="md-nav__link">
    <span class="md-ellipsis">
      MultiScaleTrendMixing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MultiScaleTrendMixing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MultiScaleTrendMixing-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MultiScaleTrendMixing.MultiScaleTrendMixing" class="md-nav__link">
    <span class="md-ellipsis">
      MultiScaleTrendMixing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pastdecomposablemixing" class="md-nav__link">
    <span class="md-ellipsis">
      üîÄ PastDecomposableMixing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.PastDecomposableMixing" class="md-nav__link">
    <span class="md-ellipsis">
      PastDecomposableMixing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PastDecomposableMixing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.PastDecomposableMixing-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.PastDecomposableMixing.PastDecomposableMixing" class="md-nav__link">
    <span class="md-ellipsis">
      PastDecomposableMixing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#temporalmixing" class="md-nav__link">
    <span class="md-ellipsis">
      ‚è±Ô∏è TemporalMixing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TemporalMixing" class="md-nav__link">
    <span class="md-ellipsis">
      TemporalMixing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TemporalMixing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TemporalMixing-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TemporalMixing.TemporalMixing" class="md-nav__link">
    <span class="md-ellipsis">
      TemporalMixing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#featuremixing" class="md-nav__link">
    <span class="md-ellipsis">
      üîÄ FeatureMixing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.FeatureMixing" class="md-nav__link">
    <span class="md-ellipsis">
      FeatureMixing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureMixing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.FeatureMixing-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.FeatureMixing.FeatureMixing" class="md-nav__link">
    <span class="md-ellipsis">
      FeatureMixing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixinglayer" class="md-nav__link">
    <span class="md-ellipsis">
      üîÄ MixingLayer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MixingLayer" class="md-nav__link">
    <span class="md-ellipsis">
      MixingLayer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MixingLayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MixingLayer-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MixingLayer.MixingLayer" class="md-nav__link">
    <span class="md-ellipsis">
      MixingLayer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#feature-selection-gating" class="md-nav__link">
    <span class="md-ellipsis">
      üéØ Feature Selection &amp; Gating
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üéØ Feature Selection & Gating">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#variableselection" class="md-nav__link">
    <span class="md-ellipsis">
      üîÄ VariableSelection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.VariableSelection" class="md-nav__link">
    <span class="md-ellipsis">
      VariableSelection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="VariableSelection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.VariableSelection-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.VariableSelection.VariableSelection" class="md-nav__link">
    <span class="md-ellipsis">
      VariableSelection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="VariableSelection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.VariableSelection.VariableSelection-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gatedfeatureselection" class="md-nav__link">
    <span class="md-ellipsis">
      üö™ GatedFeatureSelection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.GatedFeatureSelection" class="md-nav__link">
    <span class="md-ellipsis">
      GatedFeatureSelection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GatedFeatureSelection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.GatedFeatureSelection-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.GatedFeatureSelection.from_config" class="md-nav__link">
    <span class="md-ellipsis">
      from_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gatedfeaturefusion" class="md-nav__link">
    <span class="md-ellipsis">
      üåä GatedFeatureFusion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.GatedFeatureFusion" class="md-nav__link">
    <span class="md-ellipsis">
      GatedFeatureFusion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GatedFeatureFusion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.GatedFeatureFusion-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.GatedFeatureFusion.GatedFeatureFusion" class="md-nav__link">
    <span class="md-ellipsis">
      GatedFeatureFusion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gatedlinearunit" class="md-nav__link">
    <span class="md-ellipsis">
      üìç GatedLinearUnit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.GatedLinearUnit" class="md-nav__link">
    <span class="md-ellipsis">
      GatedLinearUnit
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GatedLinearUnit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.GatedLinearUnit-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.GatedLinearUnit.GatedLinearUnit" class="md-nav__link">
    <span class="md-ellipsis">
      GatedLinearUnit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gatedresidualnetwork" class="md-nav__link">
    <span class="md-ellipsis">
      üîó GatedResidualNetwork
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.GatedResidualNetwork" class="md-nav__link">
    <span class="md-ellipsis">
      GatedResidualNetwork
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GatedResidualNetwork">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.GatedResidualNetwork-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.GatedResidualNetwork.GatedResidualNetwork" class="md-nav__link">
    <span class="md-ellipsis">
      GatedResidualNetwork
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attention-mechanisms" class="md-nav__link">
    <span class="md-ellipsis">
      üëÅÔ∏è Attention Mechanisms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üëÅÔ∏è Attention Mechanisms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tabularattention" class="md-nav__link">
    <span class="md-ellipsis">
      üéØ TabularAttention
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TabularAttention" class="md-nav__link">
    <span class="md-ellipsis">
      TabularAttention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TabularAttention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TabularAttention-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TabularAttention.TabularAttention" class="md-nav__link">
    <span class="md-ellipsis">
      TabularAttention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TabularAttention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TabularAttention.TabularAttention-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiresolutiontabularattention" class="md-nav__link">
    <span class="md-ellipsis">
      üìä MultiResolutionTabularAttention
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MultiResolutionTabularAttention" class="md-nav__link">
    <span class="md-ellipsis">
      MultiResolutionTabularAttention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MultiResolutionTabularAttention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MultiResolutionTabularAttention-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MultiResolutionTabularAttention.MultiResolutionTabularAttention" class="md-nav__link">
    <span class="md-ellipsis">
      MultiResolutionTabularAttention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MultiResolutionTabularAttention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MultiResolutionTabularAttention.MultiResolutionTabularAttention-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interpretablemultiheadattention" class="md-nav__link">
    <span class="md-ellipsis">
      üîç InterpretableMultiHeadAttention
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.InterpretableMultiHeadAttention" class="md-nav__link">
    <span class="md-ellipsis">
      InterpretableMultiHeadAttention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="InterpretableMultiHeadAttention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.InterpretableMultiHeadAttention-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.InterpretableMultiHeadAttention.InterpretableMultiHeadAttention" class="md-nav__link">
    <span class="md-ellipsis">
      InterpretableMultiHeadAttention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="InterpretableMultiHeadAttention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.InterpretableMultiHeadAttention.InterpretableMultiHeadAttention-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transformerblock" class="md-nav__link">
    <span class="md-ellipsis">
      üß† TransformerBlock
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TransformerBlock" class="md-nav__link">
    <span class="md-ellipsis">
      TransformerBlock
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TransformerBlock">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TransformerBlock-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TransformerBlock.TransformerBlock" class="md-nav__link">
    <span class="md-ellipsis">
      TransformerBlock
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TransformerBlock">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TransformerBlock.TransformerBlock-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#columnattention" class="md-nav__link">
    <span class="md-ellipsis">
      üìå ColumnAttention
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.ColumnAttention" class="md-nav__link">
    <span class="md-ellipsis">
      ColumnAttention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ColumnAttention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.ColumnAttention-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.ColumnAttention.ColumnAttention" class="md-nav__link">
    <span class="md-ellipsis">
      ColumnAttention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ColumnAttention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.ColumnAttention.ColumnAttention-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rowattention" class="md-nav__link">
    <span class="md-ellipsis">
      üìç RowAttention
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.RowAttention" class="md-nav__link">
    <span class="md-ellipsis">
      RowAttention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RowAttention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.RowAttention-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.RowAttention.RowAttention" class="md-nav__link">
    <span class="md-ellipsis">
      RowAttention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RowAttention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.RowAttention.RowAttention-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-preprocessing-transformation" class="md-nav__link">
    <span class="md-ellipsis">
      üìä Data Preprocessing &amp; Transformation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üìä Data Preprocessing & Transformation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#distributiontransformlayer" class="md-nav__link">
    <span class="md-ellipsis">
      üîÑ DistributionTransformLayer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DistributionTransformLayer" class="md-nav__link">
    <span class="md-ellipsis">
      DistributionTransformLayer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DistributionTransformLayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DistributionTransformLayer-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DistributionTransformLayer.DistributionTransformLayer" class="md-nav__link">
    <span class="md-ellipsis">
      DistributionTransformLayer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#distributionawareencoder" class="md-nav__link">
    <span class="md-ellipsis">
      üéì DistributionAwareEncoder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DistributionAwareEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      DistributionAwareEncoder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DistributionAwareEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DistributionAwareEncoder-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DistributionAwareEncoder.DistributionAwareEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      DistributionAwareEncoder
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advancednumericalembedding" class="md-nav__link">
    <span class="md-ellipsis">
      üìà AdvancedNumericalEmbedding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.AdvancedNumericalEmbedding" class="md-nav__link">
    <span class="md-ellipsis">
      AdvancedNumericalEmbedding
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AdvancedNumericalEmbedding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.AdvancedNumericalEmbedding-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.AdvancedNumericalEmbedding.AdvancedNumericalEmbedding" class="md-nav__link">
    <span class="md-ellipsis">
      AdvancedNumericalEmbedding
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AdvancedNumericalEmbedding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.AdvancedNumericalEmbedding.AdvancedNumericalEmbedding-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dateparsinglayer" class="md-nav__link">
    <span class="md-ellipsis">
      üìÖ DateParsingLayer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DateParsingLayer" class="md-nav__link">
    <span class="md-ellipsis">
      DateParsingLayer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DateParsingLayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DateParsingLayer-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DateParsingLayer.DateParsingLayer" class="md-nav__link">
    <span class="md-ellipsis">
      DateParsingLayer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DateParsingLayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DateParsingLayer.DateParsingLayer-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dateencodinglayer" class="md-nav__link">
    <span class="md-ellipsis">
      üïê DateEncodingLayer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DateEncodingLayer" class="md-nav__link">
    <span class="md-ellipsis">
      DateEncodingLayer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DateEncodingLayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DateEncodingLayer-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DateEncodingLayer.DateEncodingLayer" class="md-nav__link">
    <span class="md-ellipsis">
      DateEncodingLayer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DateEncodingLayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DateEncodingLayer.DateEncodingLayer-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seasonlayer" class="md-nav__link">
    <span class="md-ellipsis">
      üåô SeasonLayer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.SeasonLayer" class="md-nav__link">
    <span class="md-ellipsis">
      SeasonLayer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SeasonLayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.SeasonLayer-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.SeasonLayer.SeasonLayer" class="md-nav__link">
    <span class="md-ellipsis">
      SeasonLayer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SeasonLayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.SeasonLayer.SeasonLayer-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#differentialpreprocessinglayer" class="md-nav__link">
    <span class="md-ellipsis">
      üîÄ DifferentialPreprocessingLayer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DifferentialPreprocessingLayer" class="md-nav__link">
    <span class="md-ellipsis">
      DifferentialPreprocessingLayer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DifferentialPreprocessingLayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DifferentialPreprocessingLayer-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DifferentialPreprocessingLayer.DifferentialPreprocessingLayer" class="md-nav__link">
    <span class="md-ellipsis">
      DifferentialPreprocessingLayer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#differentiabletabularpreprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      üîß DifferentiableTabularPreprocessor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DifferentiableTabularPreprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      DifferentiableTabularPreprocessor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DifferentiableTabularPreprocessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DifferentiableTabularPreprocessor-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.DifferentiableTabularPreprocessor.DifferentiableTabularPreprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      DifferentiableTabularPreprocessor
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#casttofloat32layer" class="md-nav__link">
    <span class="md-ellipsis">
      üé® CastToFloat32Layer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.CastToFloat32Layer" class="md-nav__link">
    <span class="md-ellipsis">
      CastToFloat32Layer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CastToFloat32Layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.CastToFloat32Layer-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.CastToFloat32Layer.CastToFloat32Layer" class="md-nav__link">
    <span class="md-ellipsis">
      CastToFloat32Layer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CastToFloat32Layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.CastToFloat32Layer.CastToFloat32Layer-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#graph-ensemble-methods" class="md-nav__link">
    <span class="md-ellipsis">
      üåê Graph &amp; Ensemble Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üåê Graph & Ensemble Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphfeatureaggregation" class="md-nav__link">
    <span class="md-ellipsis">
      üìä GraphFeatureAggregation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.GraphFeatureAggregation" class="md-nav__link">
    <span class="md-ellipsis">
      GraphFeatureAggregation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GraphFeatureAggregation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.GraphFeatureAggregation-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.GraphFeatureAggregation.GraphFeatureAggregation" class="md-nav__link">
    <span class="md-ellipsis">
      GraphFeatureAggregation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advancedgraphfeaturelayer" class="md-nav__link">
    <span class="md-ellipsis">
      üß¨ AdvancedGraphFeatureLayer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.AdvancedGraphFeatureLayer" class="md-nav__link">
    <span class="md-ellipsis">
      AdvancedGraphFeatureLayer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AdvancedGraphFeatureLayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.AdvancedGraphFeatureLayer-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.AdvancedGraphFeatureLayer.compute_output_shape" class="md-nav__link">
    <span class="md-ellipsis">
      compute_output_shape
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiheadgraphfeaturepreprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      üë• MultiHeadGraphFeaturePreprocessor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MultiHeadGraphFeaturePreprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      MultiHeadGraphFeaturePreprocessor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MultiHeadGraphFeaturePreprocessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MultiHeadGraphFeaturePreprocessor-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MultiHeadGraphFeaturePreprocessor.MultiHeadGraphFeaturePreprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      MultiHeadGraphFeaturePreprocessor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MultiHeadGraphFeaturePreprocessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.MultiHeadGraphFeaturePreprocessor.MultiHeadGraphFeaturePreprocessor-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boostingblock" class="md-nav__link">
    <span class="md-ellipsis">
      üìà BoostingBlock
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.BoostingBlock" class="md-nav__link">
    <span class="md-ellipsis">
      BoostingBlock
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BoostingBlock">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.BoostingBlock-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.BoostingBlock.BoostingBlock" class="md-nav__link">
    <span class="md-ellipsis">
      BoostingBlock
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boostingensemblelayer" class="md-nav__link">
    <span class="md-ellipsis">
      üéØ BoostingEnsembleLayer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.BoostingEnsembleLayer" class="md-nav__link">
    <span class="md-ellipsis">
      BoostingEnsembleLayer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BoostingEnsembleLayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.BoostingEnsembleLayer-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.BoostingEnsembleLayer.BoostingEnsembleLayer" class="md-nav__link">
    <span class="md-ellipsis">
      BoostingEnsembleLayer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tabularmoelayer" class="md-nav__link">
    <span class="md-ellipsis">
      üìä TabularMoELayer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TabularMoELayer" class="md-nav__link">
    <span class="md-ellipsis">
      TabularMoELayer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TabularMoELayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TabularMoELayer-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.TabularMoELayer.TabularMoELayer" class="md-nav__link">
    <span class="md-ellipsis">
      TabularMoELayer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#businessruleslayer" class="md-nav__link">
    <span class="md-ellipsis">
      üèóÔ∏è BusinessRulesLayer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.BusinessRulesLayer" class="md-nav__link">
    <span class="md-ellipsis">
      BusinessRulesLayer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BusinessRulesLayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.BusinessRulesLayer-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.BusinessRulesLayer.BusinessRulesLayer" class="md-nav__link">
    <span class="md-ellipsis">
      BusinessRulesLayer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BusinessRulesLayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.BusinessRulesLayer.BusinessRulesLayer-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regularization-robustness" class="md-nav__link">
    <span class="md-ellipsis">
      üõ°Ô∏è Regularization &amp; Robustness
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üõ°Ô∏è Regularization & Robustness">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stochasticdepth" class="md-nav__link">
    <span class="md-ellipsis">
      üé≤ StochasticDepth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.StochasticDepth" class="md-nav__link">
    <span class="md-ellipsis">
      StochasticDepth
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StochasticDepth">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.StochasticDepth-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.StochasticDepth.StochasticDepth" class="md-nav__link">
    <span class="md-ellipsis">
      StochasticDepth
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StochasticDepth">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.StochasticDepth.StochasticDepth-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#featurecutout" class="md-nav__link">
    <span class="md-ellipsis">
      üóëÔ∏è FeatureCutout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.FeatureCutout" class="md-nav__link">
    <span class="md-ellipsis">
      FeatureCutout
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureCutout">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.FeatureCutout-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.FeatureCutout.FeatureCutout" class="md-nav__link">
    <span class="md-ellipsis">
      FeatureCutout
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureCutout">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.FeatureCutout.FeatureCutout-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sparseattentionweighting" class="md-nav__link">
    <span class="md-ellipsis">
      üéØ SparseAttentionWeighting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.SparseAttentionWeighting" class="md-nav__link">
    <span class="md-ellipsis">
      SparseAttentionWeighting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SparseAttentionWeighting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.SparseAttentionWeighting-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.SparseAttentionWeighting.SparseAttentionWeighting" class="md-nav__link">
    <span class="md-ellipsis">
      SparseAttentionWeighting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SparseAttentionWeighting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.SparseAttentionWeighting.SparseAttentionWeighting-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#specialized-processing" class="md-nav__link">
    <span class="md-ellipsis">
      üîß Specialized Processing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üîß Specialized Processing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#slownetwork" class="md-nav__link">
    <span class="md-ellipsis">
      üê¢ SlowNetwork
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.SlowNetwork" class="md-nav__link">
    <span class="md-ellipsis">
      SlowNetwork
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SlowNetwork">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.SlowNetwork-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.SlowNetwork.SlowNetwork" class="md-nav__link">
    <span class="md-ellipsis">
      SlowNetwork
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hyperzzwoperator" class="md-nav__link">
    <span class="md-ellipsis">
      ‚ö° HyperZZWOperator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.HyperZZWOperator" class="md-nav__link">
    <span class="md-ellipsis">
      HyperZZWOperator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HyperZZWOperator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.HyperZZWOperator-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.HyperZZWOperator.HyperZZWOperator" class="md-nav__link">
    <span class="md-ellipsis">
      HyperZZWOperator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#anomaly-detection" class="md-nav__link">
    <span class="md-ellipsis">
      üö® Anomaly Detection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üö® Anomaly Detection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#numericalanomalydetection" class="md-nav__link">
    <span class="md-ellipsis">
      üìâ NumericalAnomalyDetection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.NumericalAnomalyDetection" class="md-nav__link">
    <span class="md-ellipsis">
      NumericalAnomalyDetection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NumericalAnomalyDetection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.NumericalAnomalyDetection-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.NumericalAnomalyDetection.NumericalAnomalyDetection" class="md-nav__link">
    <span class="md-ellipsis">
      NumericalAnomalyDetection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NumericalAnomalyDetection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.NumericalAnomalyDetection.NumericalAnomalyDetection-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#categoricalanomalydetectionlayer" class="md-nav__link">
    <span class="md-ellipsis">
      üìä CategoricalAnomalyDetectionLayer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.CategoricalAnomalyDetectionLayer" class="md-nav__link">
    <span class="md-ellipsis">
      CategoricalAnomalyDetectionLayer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CategoricalAnomalyDetectionLayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.CategoricalAnomalyDetectionLayer-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.CategoricalAnomalyDetectionLayer.CategoricalAnomalyDetectionLayer" class="md-nav__link">
    <span class="md-ellipsis">
      CategoricalAnomalyDetectionLayer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CategoricalAnomalyDetectionLayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.CategoricalAnomalyDetectionLayer.CategoricalAnomalyDetectionLayer-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerasfactory.layers.CategoricalAnomalyDetectionLayer.CategoricalAnomalyDetectionLayer-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/tsmixer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TSMixer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/timemixer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TimeMixer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/base-feed-forward-model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BaseFeedForwardModel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/sfne-block/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SFNEBlock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/terminator-model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TerminatorModel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/autoencoder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Autoencoder
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ü§ù Contributing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            ü§ù Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers_implementation_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Layer Implementation Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models_implementation_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Implementation Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_analyzer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Analyzer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  
  
  
                  

  
    <a href="https://github.com/UnicoLab/KerasFactory/edit/master/docs/api/layers.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/UnicoLab/KerasFactory/raw/master/docs/api/layers.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="layers-api-reference">üß© Layers API Reference</h1>
<p>Welcome to the KerasFactory Layers documentation! All layers are designed to work exclusively with <strong>Keras 3</strong> and provide specialized implementations for advanced tabular data processing, feature engineering, attention mechanisms, and time series forecasting.</p>
<div class="admonition tip">
<p class="admonition-title">What You'll Find Here</p>
<p>Each layer includes detailed documentation with:
- ‚ú® <strong>Complete parameter descriptions</strong> with types and defaults
- üéØ <strong>Usage examples</strong> showing real-world applications
- ‚ö° <strong>Best practices</strong> and performance considerations
- üé® <strong>When to use</strong> guidance for each layer
- üîß <strong>Implementation notes</strong> for developers</p>
</div>
<div class="admonition success">
<p class="admonition-title">Modular &amp; Composable</p>
<p>These layers can be combined together to create complex neural network architectures tailored to your specific needs.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Keras 3 Compatible</p>
<p>All layers are built on top of Keras base classes and are fully compatible with Keras 3.</p>
</div>
<h2 id="time-series-forecasting">‚è±Ô∏è Time Series &amp; Forecasting</h2>
<h3 id="positionalembedding">üìç PositionalEmbedding</h3>
<p>Fixed sinusoidal positional encoding for transformers and sequence models.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.PositionalEmbedding" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.PositionalEmbedding</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Positional Embedding layer for transformer-based models.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.PositionalEmbedding-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.PositionalEmbedding.PositionalEmbedding" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">PositionalEmbedding</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">PositionalEmbedding</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">d_model</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">max_len</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-6"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Sinusoidal positional encoding layer.</p>
<p>Generates fixed positional encodings using sine and cosine functions with
different frequencies. These are added to input embeddings to provide
positional information to the model.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>d_model</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of the positional embeddings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>max_len</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Maximum length of sequences (default: 5000).</p>
            </div>
          </td>
          <td>
                <code>5000</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>(batch_size, seq_len, ...)</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>(1, seq_len, d_model)</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">PositionalEmbedding</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create positional embeddings</span>
</span><span id="__span-0-5"><span class="n">pos_emb</span> <span class="o">=</span> <span class="n">PositionalEmbedding</span><span class="p">(</span><span class="n">d_model</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">max_len</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>
</span><span id="__span-0-6"><span class="n">positions</span> <span class="o">=</span> <span class="n">pos_emb</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">64</span><span class="p">)))</span>
</span><span id="__span-0-7"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Positional embeddings shape:&quot;</span><span class="p">,</span> <span class="n">positions</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (1, 100, 64)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the PositionalEmbedding layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>d_model</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of positional embeddings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>max_len</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Maximum sequence length.</p>
            </div>
          </td>
          <td>
                <code>5000</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional layer name.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="fixedembedding">üîß FixedEmbedding</h3>
<p>Non-trainable sinusoidal embeddings for discrete indices (months, days, hours, etc.).</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.FixedEmbedding" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.FixedEmbedding</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Fixed Embedding layer for temporal position encoding.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.FixedEmbedding-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.FixedEmbedding.FixedEmbedding" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">FixedEmbedding</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">FixedEmbedding</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">n_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">d_model</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-6"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Fixed sinusoidal embedding layer.</p>
<p>Provides fixed (non-trainable) sinusoidal embeddings for discrete indices,
commonly used for encoding temporal features or positions.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>n_features</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of features/vocabulary size.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>d_model</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of the embedding vectors.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>(batch_size, seq_len) - integer indices</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>(batch_size, seq_len, d_model)</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">FixedEmbedding</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create fixed embedding</span>
</span><span id="__span-0-5"><span class="n">emb</span> <span class="o">=</span> <span class="n">FixedEmbedding</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">d_model</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</span><span id="__span-0-6"><span class="n">indices</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">((</span><span class="mi">16</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">minval</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
</span><span id="__span-0-7"><span class="n">embeddings</span> <span class="o">=</span> <span class="n">emb</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
</span><span id="__span-0-8"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Embeddings shape:&quot;</span><span class="p">,</span> <span class="n">embeddings</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (16, 100, 64)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the FixedEmbedding layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>n_features</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of discrete features/positions.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>d_model</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of embedding vectors.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional layer name.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="tokenembedding">üé´ TokenEmbedding</h3>
<p>1D convolution-based embedding layer for time series values.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.TokenEmbedding" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.TokenEmbedding</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Token Embedding layer for time series using 1D convolution.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.TokenEmbedding-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.TokenEmbedding.TokenEmbedding" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">TokenEmbedding</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">TokenEmbedding</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">c_in</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">d_model</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-6"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Embeds time series values using 1D convolution.</p>
<p>Uses a conv1d layer with circular padding to create embeddings from raw values.
Kaiming normal initialization is applied for proper training dynamics.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>c_in</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of input channels.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>d_model</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of output embeddings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>(batch_size, time_steps, channels)</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>(batch_size, time_steps, d_model)</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">TokenEmbedding</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create token embedding</span>
</span><span id="__span-0-5"><span class="n">token_emb</span> <span class="o">=</span> <span class="n">TokenEmbedding</span><span class="p">(</span><span class="n">c_in</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">d_model</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Apply to time series</span>
</span><span id="__span-0-8"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="__span-0-9"><span class="n">embeddings</span> <span class="o">=</span> <span class="n">token_emb</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-10"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Embeddings shape:&quot;</span><span class="p">,</span> <span class="n">embeddings</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32, 100, 64)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the TokenEmbedding layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>c_in</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of input channels.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>d_model</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of output embeddings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional layer name.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="temporalembedding">‚è∞ TemporalEmbedding</h3>
<p>Embedding layer for temporal features (month, day, weekday, hour, minute).</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.TemporalEmbedding" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.TemporalEmbedding</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Temporal Embedding layer for time feature encoding.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.TemporalEmbedding-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.TemporalEmbedding.TemporalEmbedding" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">TemporalEmbedding</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">TemporalEmbedding</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">d_model</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">embed_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;fixed&quot;</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">freq</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-7"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Embeds temporal features (month, day, weekday, hour, minute).</p>
<p>Creates embeddings for calendar features to capture temporal patterns.
Supports both fixed and trainable embedding modes.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>d_model</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of embeddings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>embed_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of embedding - 'fixed' or 'learned' (default: 'fixed').</p>
            </div>
          </td>
          <td>
                <code>&#39;fixed&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>freq</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Frequency - 't' (minute level) or 'h' (hour level) (default: 'h').</p>
            </div>
          </td>
          <td>
                <code>&#39;h&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>(batch_size, seq_len, 5) - with encoded [month, day, weekday, hour, minute]</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>(batch_size, seq_len, d_model)</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">TemporalEmbedding</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create temporal embedding</span>
</span><span id="__span-0-5"><span class="n">temp_emb</span> <span class="o">=</span> <span class="n">TemporalEmbedding</span><span class="p">(</span><span class="n">d_model</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Apply to temporal features</span>
</span><span id="__span-0-8"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">minval</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
</span><span id="__span-0-9"><span class="n">embeddings</span> <span class="o">=</span> <span class="n">temp_emb</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-10"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Embeddings shape:&quot;</span><span class="p">,</span> <span class="n">embeddings</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32, 100, 64)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the TemporalEmbedding layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>d_model</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of embeddings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>embed_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of embedding ('fixed' or 'learned').</p>
            </div>
          </td>
          <td>
                <code>&#39;fixed&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>freq</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Frequency ('t' or 'h').</p>
            </div>
          </td>
          <td>
                <code>&#39;h&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional layer name.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="dataembeddingwithoutposition">üéØ DataEmbeddingWithoutPosition</h3>
<p>Combined token and temporal embedding layer for comprehensive feature representation.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.DataEmbeddingWithoutPosition" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.DataEmbeddingWithoutPosition</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Data Embedding layer combining value and temporal embeddings.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.DataEmbeddingWithoutPosition-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.DataEmbeddingWithoutPosition.DataEmbeddingWithoutPosition" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">DataEmbeddingWithoutPosition</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">DataEmbeddingWithoutPosition</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">c_in</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">d_model</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">embed_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;fixed&quot;</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">freq</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="n">dropout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="__span-0-7">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-8">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-9"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Combines token (value) and temporal embeddings.</p>
<p>Embeds time series values using token embedding and optionally adds
temporal features. Applies dropout after combining embeddings.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>c_in</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of input channels.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>d_model</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of embeddings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>embed_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of temporal embedding ('fixed' or 'learned').</p>
            </div>
          </td>
          <td>
                <code>&#39;fixed&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>freq</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Frequency for temporal features ('t' or 'h').</p>
            </div>
          </td>
          <td>
                <code>&#39;h&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate (default: 0.1).</p>
            </div>
          </td>
          <td>
                <code>0.1</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataEmbeddingWithoutPosition</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create data embedding</span>
</span><span id="__span-0-5"><span class="n">data_emb</span> <span class="o">=</span> <span class="n">DataEmbeddingWithoutPosition</span><span class="p">(</span><span class="n">c_in</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">d_model</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Apply to time series values</span>
</span><span id="__span-0-8"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="__span-0-9"><span class="n">x_mark</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">minval</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
</span><span id="__span-0-10">
</span><span id="__span-0-11"><span class="n">embeddings</span> <span class="o">=</span> <span class="n">data_emb</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x_mark</span><span class="p">])</span>
</span><span id="__span-0-12"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Embeddings shape:&quot;</span><span class="p">,</span> <span class="n">embeddings</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32, 100, 64)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the DataEmbeddingWithoutPosition layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>c_in</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of input channels.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>d_model</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of embeddings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>embed_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of temporal embedding.</p>
            </div>
          </td>
          <td>
                <code>&#39;fixed&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>freq</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Frequency for temporal embedding.</p>
            </div>
          </td>
          <td>
                <code>&#39;h&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate.</p>
            </div>
          </td>
          <td>
                <code>0.1</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional layer name.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="movingaverage">üèÉ MovingAverage</h3>
<p>Trend extraction layer using moving average filtering for time series.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.MovingAverage" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.MovingAverage</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Moving Average layer for time series trend extraction.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.MovingAverage-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.MovingAverage.MovingAverage" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">MovingAverage</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">MovingAverage</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">kernel_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-3"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Extracts the trend component using moving average.</p>
<p>This layer computes a moving average over time series to extract the trend
component. It applies padding at both ends to maintain the temporal dimension.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>kernel_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of the moving average window.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>(batch_size, time_steps, channels)</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>(batch_size, time_steps, channels)</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">MovingAverage</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create sample time series data</span>
</span><span id="__span-0-5"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>  <span class="c1"># 32 samples, 100 time steps, 8 features</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Apply moving average</span>
</span><span id="__span-0-8"><span class="n">moving_avg</span> <span class="o">=</span> <span class="n">MovingAverage</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
</span><span id="__span-0-9"><span class="n">trend</span> <span class="o">=</span> <span class="n">moving_avg</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-10"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Trend shape:&quot;</span><span class="p">,</span> <span class="n">trend</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32, 100, 8)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the MovingAverage layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>kernel_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of the moving average kernel.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional layer name.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="seriesdecomposition">üîÄ SeriesDecomposition</h3>
<p>Trend-seasonal decomposition using moving average.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.SeriesDecomposition" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.SeriesDecomposition</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Series Decomposition layer for time series trend-seasonal separation.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.SeriesDecomposition-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.SeriesDecomposition.SeriesDecomposition" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">SeriesDecomposition</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">SeriesDecomposition</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">kernel_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-3"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Decomposes time series into trend and seasonal components.</p>
<p>Uses moving average to extract the trend component, then computes
seasonal as the residual (input - trend).</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>kernel_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of the moving average window.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>(batch_size, time_steps, channels)</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <ul>
<li>seasonal: (batch_size, time_steps, channels)</li>
<li>trend: (batch_size, time_steps, channels)</li>
</ul>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">SeriesDecomposition</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create sample time series</span>
</span><span id="__span-0-5"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Decompose into trend and seasonal</span>
</span><span id="__span-0-8"><span class="n">decomp</span> <span class="o">=</span> <span class="n">SeriesDecomposition</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
</span><span id="__span-0-9"><span class="n">seasonal</span><span class="p">,</span> <span class="n">trend</span> <span class="o">=</span> <span class="n">decomp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-10">
</span><span id="__span-0-11"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Seasonal shape: </span><span class="si">{</span><span class="n">seasonal</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># (32, 100, 8)</span>
</span><span id="__span-0-12"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trend shape: </span><span class="si">{</span><span class="n">trend</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>        <span class="c1"># (32, 100, 8)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the SeriesDecomposition layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>kernel_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of the moving average window.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional layer name.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="dftseriesdecomposition">üìä DFTSeriesDecomposition</h3>
<p>Frequency-based series decomposition using Discrete Fourier Transform.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.DFTSeriesDecomposition" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.DFTSeriesDecomposition</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>DFT-based Series Decomposition layer using frequency domain analysis.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.DFTSeriesDecomposition-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.DFTSeriesDecomposition.DFTSeriesDecomposition" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">DFTSeriesDecomposition</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">DFTSeriesDecomposition</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-3"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Decomposes time series using DFT (Discrete Fourier Transform).</p>
<p>Extracts seasonal components by selecting top-k frequencies in the frequency
domain, then computes trend as the residual. This method captures periodic
patterns more explicitly than moving average.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>top_k</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of top frequencies to keep as seasonal component.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>(batch_size, time_steps, channels)</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <ul>
<li>seasonal: (batch_size, time_steps, channels)</li>
<li>trend: (batch_size, time_steps, channels)</li>
</ul>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">DFTSeriesDecomposition</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create sample time series</span>
</span><span id="__span-0-5"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Decompose using DFT</span>
</span><span id="__span-0-8"><span class="n">decomp</span> <span class="o">=</span> <span class="n">DFTSeriesDecomposition</span><span class="p">(</span><span class="n">top_k</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="__span-0-9"><span class="n">seasonal</span><span class="p">,</span> <span class="n">trend</span> <span class="o">=</span> <span class="n">decomp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-10">
</span><span id="__span-0-11"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Seasonal shape: </span><span class="si">{</span><span class="n">seasonal</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># (32, 100, 8)</span>
</span><span id="__span-0-12"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trend shape: </span><span class="si">{</span><span class="n">trend</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>        <span class="c1"># (32, 100, 8)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the DFTSeriesDecomposition layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>top_k</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of top frequencies to keep.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional layer name.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="reversibleinstancenorm">üîÑ ReversibleInstanceNorm</h3>
<p>Reversible instance normalization with optional denormalization for time series.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.ReversibleInstanceNorm" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.ReversibleInstanceNorm</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Reversible Instance Normalization layer for time series.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.ReversibleInstanceNorm-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.ReversibleInstanceNorm.ReversibleInstanceNorm" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ReversibleInstanceNorm</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">ReversibleInstanceNorm</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">num_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-05</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">affine</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">subtract_last</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="n">non_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-7">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-8">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-9"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Reversible Instance Normalization (RevIN) for time series.</p>
<p>Normalizes each series independently and enables reversible denormalization.
This is useful for improving model performance by removing distributional shifts.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>num_features</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of features/channels.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Small value for numerical stability (default: 1e-5).</p>
            </div>
          </td>
          <td>
                <code>1e-05</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>affine</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to use learnable scale and shift (default: False).</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>subtract_last</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, normalize by last value instead of mean (default: False).</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>non_norm</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, no normalization is applied (default: False).</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">ReversibleInstanceNorm</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create normalization layer</span>
</span><span id="__span-0-5"><span class="n">revin</span> <span class="o">=</span> <span class="n">ReversibleInstanceNorm</span><span class="p">(</span><span class="n">num_features</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Normalize</span>
</span><span id="__span-0-8"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</span><span id="__span-0-9"><span class="n">x_norm</span> <span class="o">=</span> <span class="n">revin</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-10">
</span><span id="__span-0-11"><span class="c1"># Denormalize</span>
</span><span id="__span-0-12"><span class="n">x_denorm</span> <span class="o">=</span> <span class="n">revin</span><span class="p">(</span><span class="n">x_norm</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;denorm&#39;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the ReversibleInstanceNorm layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>num_features</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of features.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Epsilon for numerical stability.</p>
            </div>
          </td>
          <td>
                <code>1e-05</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>affine</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to use learnable affine transformation.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>subtract_last</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to normalize by last value.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>non_norm</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to skip normalization.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional layer name.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="reversibleinstancenormmultivariate">üèóÔ∏è ReversibleInstanceNormMultivariate</h3>
<p>Multivariate version of reversible instance normalization.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.ReversibleInstanceNormMultivariate" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.ReversibleInstanceNormMultivariate</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Multivariate Reversible Instance Normalization layer.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.ReversibleInstanceNormMultivariate-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.ReversibleInstanceNormMultivariate.ReversibleInstanceNormMultivariate" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ReversibleInstanceNormMultivariate</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">ReversibleInstanceNormMultivariate</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">num_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-05</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">affine</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-7"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Reversible Instance Normalization for multivariate time series.</p>
<p>Normalizes each series independently across the time dimension,
enabling reversible denormalization. Designed for multivariate data.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>num_features</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of features/channels.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Small value for numerical stability (default: 1e-5).</p>
            </div>
          </td>
          <td>
                <code>1e-05</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>affine</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to use learnable scale and shift (default: False).</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">ReversibleInstanceNormMultivariate</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create normalization layer</span>
</span><span id="__span-0-5"><span class="n">revin</span> <span class="o">=</span> <span class="n">ReversibleInstanceNormMultivariate</span><span class="p">(</span><span class="n">num_features</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Normalize</span>
</span><span id="__span-0-8"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</span><span id="__span-0-9"><span class="n">x_norm</span> <span class="o">=</span> <span class="n">revin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-10">
</span><span id="__span-0-11"><span class="c1"># Denormalize</span>
</span><span id="__span-0-12"><span class="n">x_denorm</span> <span class="o">=</span> <span class="n">revin</span><span class="p">(</span><span class="n">x_norm</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;denorm&#39;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the ReversibleInstanceNormMultivariate layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>num_features</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of features.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Epsilon for numerical stability.</p>
            </div>
          </td>
          <td>
                <code>1e-05</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>affine</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to use learnable affine transformation.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional layer name.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="multiscaleseasonmixing">üåä MultiScaleSeasonMixing</h3>
<p>Bottom-up multi-scale seasonal pattern mixing.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.MultiScaleSeasonMixing" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.MultiScaleSeasonMixing</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Multi-Scale Season Mixing layer for hierarchical seasonal pattern mixing.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.MultiScaleSeasonMixing-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.MultiScaleSeasonMixing.MultiScaleSeasonMixing" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">MultiScaleSeasonMixing</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">MultiScaleSeasonMixing</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">seq_len</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">down_sampling_window</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">down_sampling_layers</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-7"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Mixes seasonal patterns across multiple scales bottom-up.</p>
<p>Processes seasonal components at different temporal resolutions,
mixing information from coarse to fine scales.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>seq_len</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input sequence length.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>down_sampling_window</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Window size for downsampling.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>down_sampling_layers</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of downsampling layers.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiScaleSeasonMixing</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create season mixing layer</span>
</span><span id="__span-0-5"><span class="n">season_mix</span> <span class="o">=</span> <span class="n">MultiScaleSeasonMixing</span><span class="p">(</span><span class="n">seq_len</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">down_sampling_window</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-0-6">                                  <span class="n">down_sampling_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-7">
</span><span id="__span-0-8"><span class="c1"># Process list of seasonal components at different scales</span>
</span><span id="__span-0-9"><span class="n">season_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">8</span><span class="p">)),</span>
</span><span id="__span-0-10">               <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">8</span><span class="p">))]</span>
</span><span id="__span-0-11"><span class="n">mixed_seasons</span> <span class="o">=</span> <span class="n">season_mix</span><span class="p">(</span><span class="n">season_list</span><span class="p">)</span>
</span><span id="__span-0-12"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of outputs:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mixed_seasons</span><span class="p">))</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the MultiScaleSeasonMixing layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>seq_len</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sequence length.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>down_sampling_window</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Downsampling window size.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>down_sampling_layers</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of downsampling layers.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional layer name.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="multiscaletrendmixing">üìà MultiScaleTrendMixing</h3>
<p>Top-down multi-scale trend pattern mixing.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.MultiScaleTrendMixing" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.MultiScaleTrendMixing</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Multi-Scale Trend Mixing layer for hierarchical trend pattern mixing.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.MultiScaleTrendMixing-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.MultiScaleTrendMixing.MultiScaleTrendMixing" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">MultiScaleTrendMixing</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">MultiScaleTrendMixing</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">seq_len</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">down_sampling_window</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">down_sampling_layers</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-7"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Mixes trend patterns across multiple scales top-down.</p>
<p>Processes trend components at different temporal resolutions,
mixing information from fine to coarse scales.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>seq_len</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input sequence length.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>down_sampling_window</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Window size for downsampling.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>down_sampling_layers</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of downsampling layers.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiScaleTrendMixing</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create trend mixing layer</span>
</span><span id="__span-0-5"><span class="n">trend_mix</span> <span class="o">=</span> <span class="n">MultiScaleTrendMixing</span><span class="p">(</span><span class="n">seq_len</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">down_sampling_window</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-0-6">                                 <span class="n">down_sampling_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-7">
</span><span id="__span-0-8"><span class="c1"># Process list of trend components at different scales</span>
</span><span id="__span-0-9"><span class="n">trend_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">8</span><span class="p">)),</span>
</span><span id="__span-0-10">              <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">8</span><span class="p">))]</span>
</span><span id="__span-0-11"><span class="n">mixed_trends</span> <span class="o">=</span> <span class="n">trend_mix</span><span class="p">(</span><span class="n">trend_list</span><span class="p">)</span>
</span><span id="__span-0-12"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of outputs:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mixed_trends</span><span class="p">))</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the MultiScaleTrendMixing layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>seq_len</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sequence length.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>down_sampling_window</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Downsampling window size.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>down_sampling_layers</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of downsampling layers.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional layer name.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="pastdecomposablemixing">üîÄ PastDecomposableMixing</h3>
<p>Past decomposable mixing encoder block combining decomposition and multi-scale mixing.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.PastDecomposableMixing" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.PastDecomposableMixing</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Past Decomposable Mixing layer for time series encoder blocks.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.PastDecomposableMixing-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.PastDecomposableMixing.PastDecomposableMixing" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">PastDecomposableMixing</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">PastDecomposableMixing</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">seq_len</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">pred_len</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">down_sampling_window</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">down_sampling_layers</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="n">d_model</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-7">    <span class="n">dropout</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="__span-0-8">    <span class="n">channel_independence</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-9">    <span class="n">decomp_method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-10">    <span class="n">d_ff</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-11">    <span class="n">moving_avg</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-12">    <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-13">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-14">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-15"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Past Decomposable Mixing block for TimeMixer encoder.</p>
<p>Decomposes time series, applies multi-scale mixing to trend and seasonal
components, then reconstructs the signal.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>seq_len</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sequence length.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>pred_len</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Prediction length.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>down_sampling_window</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Downsampling window size.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>down_sampling_layers</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of downsampling layers.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>d_model</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Model dimension.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>channel_independence</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to use channel-independent processing.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>decomp_method</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Decomposition method ('moving_avg' or 'dft_decomp').</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>d_ff</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Feed-forward dimension.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>moving_avg</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Window size for moving average.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>top_k</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Top-k frequencies for DFT.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">PastDecomposableMixing</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create PDM block</span>
</span><span id="__span-0-5"><span class="n">pdm</span> <span class="o">=</span> <span class="n">PastDecomposableMixing</span><span class="p">(</span><span class="n">seq_len</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">pred_len</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
</span><span id="__span-0-6">                             <span class="n">down_sampling_window</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-0-7">                             <span class="n">down_sampling_layers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-8">
</span><span id="__span-0-9"><span class="c1"># Process multi-scale inputs</span>
</span><span id="__span-0-10"><span class="n">x_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">8</span><span class="p">))]</span>
</span><span id="__span-0-11"><span class="n">output</span> <span class="o">=</span> <span class="n">pdm</span><span class="p">(</span><span class="n">x_list</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the PastDecomposableMixing layer.</p>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="temporalmixing">‚è±Ô∏è TemporalMixing</h3>
<p>MLP-based temporal mixing layer for TSMixer that applies transformations across the time dimension.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.TemporalMixing" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.TemporalMixing</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Temporal Mixing layer for TSMixer model.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.TemporalMixing-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.TemporalMixing.TemporalMixing" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">TemporalMixing</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">TemporalMixing</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">n_series</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">input_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">dropout</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-7"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Temporal mixing layer using MLP on time dimension.</p>
<p>Applies batch normalization and linear transformation across the time
dimension to mix temporal information while preserving the multivariate
structure.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>n_series</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of time series (channels/features).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>input_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Length of the time series (sequence length).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate between 0 and 1.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>(batch_size, input_size, n_series)</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>(batch_size, input_size, n_series)</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>layer = TemporalMixing(n_series=7, input_size=96, dropout=0.1)
x = keras.random.normal((32, 96, 7))
output = layer(x)
output.shape
(32, 96, 7)</p>
</blockquote>
</blockquote>
</blockquote>
</details>  
      <p>Initialize the TemporalMixing layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>n_series</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of time series.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>input_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Length of time series.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional layer name.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="featuremixing">üîÄ FeatureMixing</h3>
<p>Feed-forward network mixing layer for TSMixer that learns cross-series correlations across feature dimension.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.FeatureMixing" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.FeatureMixing</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Feature Mixing layer for TSMixer model.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.FeatureMixing-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.FeatureMixing.FeatureMixing" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">FeatureMixing</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">FeatureMixing</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">n_series</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">input_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">dropout</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">ff_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-7">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-8"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Feature mixing layer using MLP on channel dimension.</p>
<p>Applies batch normalization and feed-forward network across the feature
(channel) dimension to mix information between different time series
while preserving temporal structure.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>n_series</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of time series (channels/features).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>input_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Length of the time series (sequence length).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate between 0 and 1.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>ff_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of the hidden layer in the feed-forward network.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>(batch_size, input_size, n_series)</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>(batch_size, input_size, n_series)</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>layer = FeatureMixing(n_series=7, input_size=96, dropout=0.1, ff_dim=64)
x = keras.random.normal((32, 96, 7))
output = layer(x)
output.shape
(32, 96, 7)</p>
</blockquote>
</blockquote>
</blockquote>
</details>  
      <p>Initialize the FeatureMixing layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>n_series</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of time series.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>input_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Length of time series.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>ff_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Feed-forward hidden dimension.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional layer name.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="mixinglayer">üîÄ MixingLayer</h3>
<p>Core mixing block combining TemporalMixing and FeatureMixing for the TSMixer architecture.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.MixingLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.MixingLayer</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Mixing Layer combining temporal and feature mixing for TSMixer.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.MixingLayer-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.MixingLayer.MixingLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">MixingLayer</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">MixingLayer</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">n_series</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">input_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">dropout</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">ff_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-7">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-8"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Mixing layer combining temporal and feature mixing.</p>
<p>A mixing layer consists of sequential temporal and feature MLPs that
jointly learn temporal and cross-sectional representations.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>n_series</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of time series (channels/features).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>input_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Length of the time series (sequence length).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate between 0 and 1.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>ff_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of the hidden layer in the feed-forward network.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>(batch_size, input_size, n_series)</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>(batch_size, input_size, n_series)</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>layer = MixingLayer(n_series=7, input_size=96, dropout=0.1, ff_dim=64)
x = keras.random.normal((32, 96, 7))
output = layer(x)
output.shape
(32, 96, 7)</p>
</blockquote>
</blockquote>
</blockquote>
</details>  
      <p>Initialize the MixingLayer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>n_series</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of time series.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>input_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Length of time series.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>ff_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Feed-forward hidden dimension.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional layer name.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h2 id="feature-selection-gating">üéØ Feature Selection &amp; Gating</h2>
<h3 id="variableselection">üîÄ VariableSelection</h3>
<p>Dynamic feature selection using gated residual networks with optional context conditioning.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.VariableSelection" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.VariableSelection</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a VariableSelection layer that applies a gated residual network to each
feature independently and learns feature weights through a softmax layer. It's particularly
useful for dynamic feature selection in time series and tabular models.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.VariableSelection-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.VariableSelection.VariableSelection" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">VariableSelection</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">VariableSelection</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">nr_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">units</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">use_context</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-7">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-8"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Layer for dynamic feature selection using gated residual networks.</p>
<p>This layer applies a gated residual network to each feature independently and learns
feature weights through a softmax layer. It can optionally use a context vector to
condition the feature selection.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>nr_features</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of input features</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>units</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of hidden units in the gated residual network</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate for regularization</p>
            </div>
          </td>
          <td>
                <code>0.1</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>use_context</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to use a context vector for conditioning</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name for the layer</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>If use_context is False:
    - Single tensor with shape: <code>(batch_size, nr_features, feature_dim)</code>
If use_context is True:
    - List of two tensors:
        - Features tensor with shape: <code>(batch_size, nr_features, feature_dim)</code>
        - Context tensor with shape: <code>(batch_size, context_dim)</code></p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>Tuple of two tensors:
- Selected features: <code>(batch_size, feature_dim)</code>
- Feature weights: <code>(batch_size, nr_features)</code></p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">VariableSelection</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create sample input data</span>
</span><span id="__span-0-5"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>  <span class="c1"># 32 batches, 10 features, 16 dims per feature</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Without context</span>
</span><span id="__span-0-8"><span class="n">vs</span> <span class="o">=</span> <span class="n">VariableSelection</span><span class="p">(</span><span class="n">nr_features</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</span><span id="__span-0-9"><span class="n">selected</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">vs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-10"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Selected features shape:&quot;</span><span class="p">,</span> <span class="n">selected</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32, 16)</span>
</span><span id="__span-0-11"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Feature weights shape:&quot;</span><span class="p">,</span> <span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32, 10)</span>
</span><span id="__span-0-12">
</span><span id="__span-0-13"><span class="c1"># With context</span>
</span><span id="__span-0-14"><span class="n">context</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">))</span>  <span class="c1"># 32 batches, 64-dim context</span>
</span><span id="__span-0-15"><span class="n">vs_context</span> <span class="o">=</span> <span class="n">VariableSelection</span><span class="p">(</span><span class="n">nr_features</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">use_context</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-16"><span class="n">selected</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">vs_context</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">context</span><span class="p">])</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the VariableSelection layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>nr_features</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of input features.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>units</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of units in the selection network.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate.</p>
            </div>
          </td>
          <td>
                <code>0.1</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>use_context</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to use context for selection.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">







<h6 id="kerasfactory.layers.VariableSelection.VariableSelection-functions">Functions</h6>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.VariableSelection.VariableSelection.compute_output_shape" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_output_shape</span>


</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">compute_output_shape</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">input_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span>
</span><span id="__span-0-3"><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Compute the output shape of the layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_shape</code></td>
          <td>
                <code>tuple[int, ...] | list[tuple[int, ...]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor or list of shapes if using context.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>list[tuple[int, ...]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of shapes for the output tensors.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="gatedfeatureselection">üö™ GatedFeatureSelection</h3>
<p>Feature selection layer using gating mechanisms for conditional feature routing.</p>


<div class="doc doc-object doc-class">



<h3 id="kerasfactory.layers.GatedFeatureSelection" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">kerasfactory.layers.GatedFeatureSelection</span>


</h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">GatedFeatureSelection</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">input_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">reduction_ratio</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</span><span id="__span-0-5"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents first">

  
      <p>Gated feature selection layer with residual connection.</p>
<p>This layer implements a learnable feature selection mechanism using a gating network.
Each feature is assigned a dynamic importance weight between 0 and 1 through a multi-layer
gating network. The gating network includes batch normalization and ReLU activations
for stable training. A small residual connection (0.1) is added to maintain gradient flow.</p>
<p>The layer is particularly useful for:
1. Dynamic feature importance learning
2. Feature selection in time-series data
3. Attention-like mechanisms for tabular data
4. Reducing noise in input features</p>
<p>Example:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">keras</span><span class="w"> </span><span class="kn">import</span> <span class="n">layers</span><span class="p">,</span> <span class="n">Model</span>
</span><span id="__span-0-3"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">GatedFeatureSelection</span>
</span><span id="__span-0-4">
</span><span id="__span-0-5"><span class="c1"># Create sample input data</span>
</span><span id="__span-0-6"><span class="n">input_dim</span> <span class="o">=</span> <span class="mi">20</span>
</span><span id="__span-0-7"><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">))</span>
</span><span id="__span-0-8">
</span><span id="__span-0-9"><span class="c1"># Build model with gated feature selection</span>
</span><span id="__span-0-10"><span class="n">inputs</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">input_dim</span><span class="p">,))</span>
</span><span id="__span-0-11"><span class="n">x</span> <span class="o">=</span> <span class="n">GatedFeatureSelection</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">input_dim</span><span class="p">,</span> <span class="n">reduction_ratio</span><span class="o">=</span><span class="mi">4</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="__span-0-12"><span class="n">outputs</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-13"><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
</span><span id="__span-0-14">
</span><span id="__span-0-15"><span class="c1"># The layer will learn which features are most important</span>
</span><span id="__span-0-16"><span class="c1"># and dynamically adjust their contribution to the output</span>
</span></code></pre></div></td></tr></table></div></p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of the input features</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>reduction_ratio</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ratio to reduce the hidden dimension of the gating network.
A higher ratio means fewer parameters but potentially less expressive gates.
Default is 4, meaning the hidden dimension will be input_dim // 4.</p>
            </div>
          </td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>
  
      <p>Initialize the gated feature selection layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of the input features. Must match the last dimension
of the input tensor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>reduction_ratio</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ratio to reduce the hidden dimension of the gating network.
The hidden dimension will be max(input_dim // reduction_ratio, 1).
Default is 4.</p>
            </div>
          </td>
          <td>
                <code>4</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code>dict[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional layer arguments passed to the parent Layer class.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">







<h4 id="kerasfactory.layers.GatedFeatureSelection-functions">Functions</h4>


<div class="doc doc-object doc-function">



<h5 id="kerasfactory.layers.GatedFeatureSelection.from_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">from_config</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">from_config</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</span><span id="__span-0-3"><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GatedFeatureSelection</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Create layer from configuration.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>config</code></td>
          <td>
                <code>dict[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Layer configuration dictionary</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code><a class="autorefs autorefs-internal" title="kerasfactory.layers.GatedFeaturesSelection.GatedFeatureSelection" href="#kerasfactory.layers.GatedFeatureSelection">GatedFeatureSelection</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>GatedFeatureSelection instance</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div><h3 id="gatedfeaturefusion">üåä GatedFeatureFusion</h3>
<p>Combines and fuses features using gated mechanisms for adaptive feature integration.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.GatedFeatureFusion" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.GatedFeatureFusion</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a GatedFeatureFusion layer that combines two feature representations
through a learned gating mechanism. It's particularly useful for tabular datasets with
multiple representations (e.g., raw numeric features alongside embeddings).</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.GatedFeatureFusion-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.GatedFeatureFusion.GatedFeatureFusion" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">GatedFeatureFusion</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">GatedFeatureFusion</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;sigmoid&quot;</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-5"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Gated feature fusion layer for combining two feature representations.</p>
<p>This layer takes two inputs (e.g., numerical features and their embeddings) and fuses
them using a learned gate to balance their contributions. The gate is computed using
a dense layer with sigmoid activation, applied to the concatenation of both inputs.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>activation</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Activation function to use for the gate. Default is 'sigmoid'.</p>
            </div>
          </td>
          <td>
                <code>&#39;sigmoid&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>A list of 2 tensors with shape: <code>[(batch_size, ..., features), (batch_size, ..., features)]</code>
Both inputs must have the same shape.</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>Tensor with shape: <code>(batch_size, ..., features)</code>, same as each input.</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">GatedFeatureFusion</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Two representations for the same 10 features</span>
</span><span id="__span-0-5"><span class="n">feat1</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="__span-0-6"><span class="n">feat2</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="__span-0-7">
</span><span id="__span-0-8"><span class="n">fusion_layer</span> <span class="o">=</span> <span class="n">GatedFeatureFusion</span><span class="p">()</span>
</span><span id="__span-0-9"><span class="n">fused</span> <span class="o">=</span> <span class="n">fusion_layer</span><span class="p">([</span><span class="n">feat1</span><span class="p">,</span> <span class="n">feat2</span><span class="p">])</span>
</span><span id="__span-0-10"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fused output shape:&quot;</span><span class="p">,</span> <span class="n">fused</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Expected: (32, 10)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the GatedFeatureFusion layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>activation</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Activation function for the gate.</p>
            </div>
          </td>
          <td>
                <code>&#39;sigmoid&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="gatedlinearunit">üìç GatedLinearUnit</h3>
<p>Gated linear transformation for controlling information flow in neural networks.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.GatedLinearUnit" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.GatedLinearUnit</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a GatedLinearUnit layer that applies a gated linear transformation
to input tensors. It's particularly useful for controlling information flow in neural networks.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.GatedLinearUnit-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.GatedLinearUnit.GatedLinearUnit" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">GatedLinearUnit</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">GatedLinearUnit</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">units</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-3"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>GatedLinearUnit is a custom Keras layer that implements a gated linear unit.</p>
<p>This layer applies a dense linear transformation to the input tensor and multiplies the result with the output
of a dense sigmoid transformation. The result is a tensor where the input data is filtered based on the learned
weights and biases of the layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>units</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Positive integer, dimensionality of the output space.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>Tensor with shape: <code>(batch_size, ..., input_dim)</code></p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>Tensor with shape: <code>(batch_size, ..., units)</code></p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">GatedLinearUnit</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create sample input data</span>
</span><span id="__span-0-5"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>  <span class="c1"># 32 samples, 16 features</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Create the layer</span>
</span><span id="__span-0-8"><span class="n">glu</span> <span class="o">=</span> <span class="n">GatedLinearUnit</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="__span-0-9"><span class="n">y</span> <span class="o">=</span> <span class="n">glu</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-10"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output shape:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32, 8)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the GatedLinearUnit layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>units</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of units in the layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="gatedresidualnetwork">üîó GatedResidualNetwork</h3>
<p>Gated residual network architecture for feature processing with residual connections.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.GatedResidualNetwork" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.GatedResidualNetwork</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a GatedResidualNetwork layer that combines residual connections
with gated linear units for improved gradient flow and feature transformation.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.GatedResidualNetwork-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.GatedResidualNetwork.GatedResidualNetwork" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">GatedResidualNetwork</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">GatedResidualNetwork</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">units</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-6"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>GatedResidualNetwork is a custom Keras layer that implements a gated residual network.</p>
<p>This layer applies a series of transformations to the input tensor and combines the result with the input
using a residual connection. The transformations include a dense layer with ELU activation, a dense linear
layer, a dropout layer, a gated linear unit layer, layer normalization, and a final dense layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>units</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Positive integer, dimensionality of the output space.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate for regularization. Defaults to 0.2.</p>
            </div>
          </td>
          <td>
                <code>0.2</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>Tensor with shape: <code>(batch_size, ..., input_dim)</code></p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>Tensor with shape: <code>(batch_size, ..., units)</code></p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">GatedResidualNetwork</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create sample input data</span>
</span><span id="__span-0-5"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>  <span class="c1"># 32 samples, 16 features</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Create the layer</span>
</span><span id="__span-0-8"><span class="n">grn</span> <span class="o">=</span> <span class="n">GatedResidualNetwork</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</span><span id="__span-0-9"><span class="n">y</span> <span class="o">=</span> <span class="n">grn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-10"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output shape:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32, 16)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the GatedResidualNetwork.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>units</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of units in the network.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate.</p>
            </div>
          </td>
          <td>
                <code>0.2</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h2 id="attention-mechanisms">üëÅÔ∏è Attention Mechanisms</h2>
<h3 id="tabularattention">üéØ TabularAttention</h3>
<p>Dual attention mechanism for tabular data with inter-feature and inter-sample attention.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.TabularAttention" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.TabularAttention</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a TabularAttention layer that applies inter-feature and inter-sample
attention mechanisms for tabular data. It's particularly useful for capturing complex
relationships between features and samples in tabular datasets.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.TabularAttention-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.TabularAttention.TabularAttention" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">TabularAttention</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">TabularAttention</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">num_heads</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">d_model</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-7"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Custom layer to apply inter-feature and inter-sample attention for tabular data.</p>
<p>This layer implements a dual attention mechanism:
1. Inter-feature attention: Captures dependencies between features for each sample
2. Inter-sample attention: Captures dependencies between samples for each feature</p>
<p>The layer uses MultiHeadAttention for both attention mechanisms and includes
layer normalization, dropout, and a feed-forward network.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>num_heads</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of attention heads</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>d_model</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimensionality of the attention model</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate for regularization</p>
            </div>
          </td>
          <td>
                <code>0.1</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name for the layer</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>Tensor with shape: <code>(batch_size, num_samples, num_features)</code></p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>Tensor with shape: <code>(batch_size, num_samples, d_model)</code></p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularAttention</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create sample input data</span>
</span><span id="__span-0-5"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>  <span class="c1"># 32 batches, 100 samples, 20 features</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Apply tabular attention</span>
</span><span id="__span-0-8"><span class="n">attention</span> <span class="o">=</span> <span class="n">TabularAttention</span><span class="p">(</span><span class="n">num_heads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">d_model</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</span><span id="__span-0-9"><span class="n">y</span> <span class="o">=</span> <span class="n">attention</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-10"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output shape:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32, 100, 32)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the TabularAttention layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>num_heads</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of attention heads.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>d_model</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Model dimension.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate.</p>
            </div>
          </td>
          <td>
                <code>0.1</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">







<h6 id="kerasfactory.layers.TabularAttention.TabularAttention-functions">Functions</h6>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.TabularAttention.TabularAttention.compute_output_shape" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_output_shape</span>


</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">compute_output_shape</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">input_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="__span-0-3"><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Compute the output shape of the layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_shape</code></td>
          <td>
                <code>tuple[int, ...]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>tuple[int, ...]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the output tensor.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="multiresolutiontabularattention">üìä MultiResolutionTabularAttention</h3>
<p>Multi-resolution attention mechanism for capturing features at different scales.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.MultiResolutionTabularAttention" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.MultiResolutionTabularAttention</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a MultiResolutionTabularAttention layer that applies separate attention
mechanisms for numerical and categorical features, along with cross-attention between them.
It's particularly useful for mixed-type tabular data.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.MultiResolutionTabularAttention-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.MultiResolutionTabularAttention.MultiResolutionTabularAttention" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">MultiResolutionTabularAttention</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">MultiResolutionTabularAttention</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">num_heads</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">d_model</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-7"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Custom layer to apply multi-resolution attention for mixed-type tabular data.</p>
<p>This layer implements separate attention mechanisms for numerical and categorical features,
along with cross-attention between them. It's designed to handle the different characteristics
of numerical and categorical features in tabular data.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>num_heads</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of attention heads</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>d_model</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimensionality of the attention model</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate for regularization</p>
            </div>
          </td>
          <td>
                <code>0.1</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name for the layer</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>List of two tensors:
- Numerical features: <code>(batch_size, num_samples, num_numerical_features)</code>
- Categorical features: <code>(batch_size, num_samples, num_categorical_features)</code></p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>List of two tensors with shapes:
- <code>(batch_size, num_samples, d_model)</code> (numerical features)
- <code>(batch_size, num_samples, d_model)</code> (categorical features)</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiResolutionTabularAttention</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create sample input data</span>
</span><span id="__span-0-5"><span class="n">numerical</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>  <span class="c1"># 32 batches, 100 samples, 10 numerical features</span>
</span><span id="__span-0-6"><span class="n">categorical</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>  <span class="c1"># 32 batches, 100 samples, 5 categorical features</span>
</span><span id="__span-0-7">
</span><span id="__span-0-8"><span class="c1"># Apply multi-resolution attention</span>
</span><span id="__span-0-9"><span class="n">attention</span> <span class="o">=</span> <span class="n">MultiResolutionTabularAttention</span><span class="p">(</span><span class="n">num_heads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">d_model</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</span><span id="__span-0-10"><span class="n">num_out</span><span class="p">,</span> <span class="n">cat_out</span> <span class="o">=</span> <span class="n">attention</span><span class="p">([</span><span class="n">numerical</span><span class="p">,</span> <span class="n">categorical</span><span class="p">])</span>
</span><span id="__span-0-11"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Numerical output shape:&quot;</span><span class="p">,</span> <span class="n">num_out</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32, 100, 32)</span>
</span><span id="__span-0-12"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Categorical output shape:&quot;</span><span class="p">,</span> <span class="n">cat_out</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32, 100, 32)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the MultiResolutionTabularAttention.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>num_heads</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of attention heads.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>d_model</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Model dimension.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate.</p>
            </div>
          </td>
          <td>
                <code>0.1</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">







<h6 id="kerasfactory.layers.MultiResolutionTabularAttention.MultiResolutionTabularAttention-functions">Functions</h6>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.MultiResolutionTabularAttention.MultiResolutionTabularAttention.compute_output_shape" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_output_shape</span>


</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">compute_output_shape</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">input_shape</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span>
</span><span id="__span-0-3"><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Compute the output shape of the layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_shape</code></td>
          <td>
                <code>list[tuple[int, ...]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of shapes of the input tensors.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>list[tuple[int, ...]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of shapes of the output tensors.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="interpretablemultiheadattention">üîç InterpretableMultiHeadAttention</h3>
<p>Interpretable multi-head attention layer with explainability features.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.InterpretableMultiHeadAttention" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.InterpretableMultiHeadAttention</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Interpretable Multi-Head Attention layer implementation.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.InterpretableMultiHeadAttention-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.InterpretableMultiHeadAttention.InterpretableMultiHeadAttention" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">InterpretableMultiHeadAttention</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">InterpretableMultiHeadAttention</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">d_model</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">n_head</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</span><span id="__span-0-6"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Interpretable Multi-Head Attention layer.</p>
<p>This layer wraps Keras MultiHeadAttention and stores the attention scores
for interpretability purposes. The attention scores can be accessed via
the <code>attention_scores</code> attribute after calling the layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>d_model</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of each attention head for query, key, value.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>n_head</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of attention heads.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout probability. Default: 0.1.</p>
            </div>
          </td>
          <td>
                <code>0.1</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code>dict[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional arguments passed to MultiHeadAttention.
Supported arguments:
- value_dim: Size of each attention head for value.
- use_bias: Whether to use bias. Default: True.
- output_shape: Expected output shape. Default: None.
- attention_axes: Axes for attention. Default: None.
- kernel_initializer: Initializer for kernels. Default: 'glorot_uniform'.
- bias_initializer: Initializer for biases. Default: 'zeros'.
- kernel_regularizer: Regularizer for kernels. Default: None.
- bias_regularizer: Regularizer for biases. Default: None.
- activity_regularizer: Regularizer for activity. Default: None.
- kernel_constraint: Constraint for kernels. Default: None.
- bias_constraint: Constraint for biases. Default: None.
- seed: Random seed for dropout. Default: None.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="call-args" open>
  <summary>Call Args</summary>
  <p>query: Query tensor of shape <code>(B, S, E)</code> where B is batch size,
    S is sequence length, and E is the feature dimension.
key: Key tensor of shape <code>(B, S, E)</code>.
value: Value tensor of shape <code>(B, S, E)</code>.
training: Python boolean indicating whether the layer should behave in
    training mode (applying dropout) or in inference mode (no dropout).</p>
</details>


  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>output</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Attention output of shape <code>(B, S, E)</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="n">d_model</span> <span class="o">=</span> <span class="mi">64</span>
</span><span id="__span-0-2"><span class="n">n_head</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="__span-0-3"><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-0-4"><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>
</span><span id="__span-0-5">
</span><span id="__span-0-6"><span class="n">layer</span> <span class="o">=</span> <span class="n">InterpretableMultiHeadAttention</span><span class="p">(</span>
</span><span id="__span-0-7">    <span class="n">d_model</span><span class="o">=</span><span class="n">d_model</span><span class="p">,</span>
</span><span id="__span-0-8">    <span class="n">n_head</span><span class="o">=</span><span class="n">n_head</span><span class="p">,</span>
</span><span id="__span-0-9">    <span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;he_normal&#39;</span><span class="p">,</span>
</span><span id="__span-0-10">    <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span>
</span><span id="__span-0-11"><span class="p">)</span>
</span><span id="__span-0-12"><span class="n">query</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">,</span> <span class="n">d_model</span><span class="p">))</span>
</span><span id="__span-0-13"><span class="n">output</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-14"><span class="n">attention_scores</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">attention_scores</span>  <span class="c1"># Access attention weights</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the layer.</p>


  

  <div class="doc doc-children">







<h6 id="kerasfactory.layers.InterpretableMultiHeadAttention.InterpretableMultiHeadAttention-functions">Functions</h6>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.InterpretableMultiHeadAttention.InterpretableMultiHeadAttention.from_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">from_config</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">from_config</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</span><span id="__span-0-3"><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InterpretableMultiHeadAttention</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Create layer from configuration.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>config</code></td>
          <td>
                <code>dict[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Layer configuration dictionary</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code><a class="autorefs autorefs-internal" title="kerasfactory.layers.InterpretableMultiHeadAttention.InterpretableMultiHeadAttention" href="#kerasfactory.layers.InterpretableMultiHeadAttention.InterpretableMultiHeadAttention">InterpretableMultiHeadAttention</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Layer instance</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="transformerblock">üß† TransformerBlock</h3>
<p>Complete transformer block combining self-attention and feed-forward networks.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.TransformerBlock" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.TransformerBlock</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a TransformerBlock layer that applies transformer-style self-attention
and feed-forward processing to input tensors. It's particularly useful for capturing complex
relationships in tabular data.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.TransformerBlock-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.TransformerBlock.TransformerBlock" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">TransformerBlock</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">TransformerBlock</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">dim_model</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">num_heads</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">ff_units</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-7">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-8"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Transformer block with multi-head attention and feed-forward layers.</p>
<p>This layer implements a standard transformer block with multi-head self-attention
followed by a feed-forward network, with residual connections and layer normalization.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>dim_model</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimensionality of the model.</p>
            </div>
          </td>
          <td>
                <code>32</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>num_heads</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of attention heads.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>ff_units</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of units in the feed-forward network.</p>
            </div>
          </td>
          <td>
                <code>16</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate for regularization.</p>
            </div>
          </td>
          <td>
                <code>0.2</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>Tensor with shape: <code>(batch_size, sequence_length, dim_model)</code> or
<code>(batch_size, dim_model)</code> which will be automatically reshaped.</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>Tensor with shape: <code>(batch_size, sequence_length, dim_model)</code> or
<code>(batch_size, dim_model)</code> matching the input shape.</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">TransformerBlock</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create sample input data</span>
</span><span id="__span-0-5"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">64</span><span class="p">))</span>  <span class="c1"># 32 samples, 10 time steps, 64 features</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Apply transformer block</span>
</span><span id="__span-0-8"><span class="n">transformer</span> <span class="o">=</span> <span class="n">TransformerBlock</span><span class="p">(</span><span class="n">dim_model</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">num_heads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ff_units</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</span><span id="__span-0-9"><span class="n">y</span> <span class="o">=</span> <span class="n">transformer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-10"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output shape:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32, 10, 64)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the TransformerBlock layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>dim_model</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Model dimension.</p>
            </div>
          </td>
          <td>
                <code>32</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>num_heads</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of attention heads.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>ff_units</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Feed-forward units.</p>
            </div>
          </td>
          <td>
                <code>16</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate.</p>
            </div>
          </td>
          <td>
                <code>0.2</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">







<h6 id="kerasfactory.layers.TransformerBlock.TransformerBlock-functions">Functions</h6>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.TransformerBlock.TransformerBlock.compute_output_shape" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_output_shape</span>


</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">compute_output_shape</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">input_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="__span-0-3"><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Compute the output shape of the layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_shape</code></td>
          <td>
                <code>tuple[int, ...]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>tuple[int, ...]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the output tensor.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="columnattention">üìå ColumnAttention</h3>
<p>Attention mechanism focused on inter-column (feature) relationships.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.ColumnAttention" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.ColumnAttention</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Column attention mechanism for weighting features dynamically.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.ColumnAttention-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.ColumnAttention.ColumnAttention" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ColumnAttention</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">ColumnAttention</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">input_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">hidden_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</span><span id="__span-0-5"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Column attention mechanism to weight features dynamically.</p>
<p>This layer applies attention weights to each feature (column) in the input tensor.
The attention weights are computed using a two-layer neural network that takes
the input features and outputs attention weights for each feature.</p>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">ColumnAttention</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create sample data</span>
</span><span id="__span-0-5"><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>
</span><span id="__span-0-6"><span class="n">input_dim</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-0-7"><span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">))</span>
</span><span id="__span-0-8">
</span><span id="__span-0-9"><span class="c1"># Apply column attention</span>
</span><span id="__span-0-10"><span class="n">attention</span> <span class="o">=</span> <span class="n">ColumnAttention</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">input_dim</span><span class="p">)</span>
</span><span id="__span-0-11"><span class="n">weighted_outputs</span> <span class="o">=</span> <span class="n">attention</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize column attention.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input dimension</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>hidden_dim</code></td>
          <td>
                <code>int | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Hidden layer dimension. If None, uses input_dim // 2</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code>dict[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional layer arguments</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">







<h6 id="kerasfactory.layers.ColumnAttention.ColumnAttention-functions">Functions</h6>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.ColumnAttention.ColumnAttention.from_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">from_config</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">from_config</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">ColumnAttention</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Create layer from configuration.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>config</code></td>
          <td>
                <code>dict[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Layer configuration dictionary</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code><a class="autorefs autorefs-internal" title="kerasfactory.layers.ColumnAttention.ColumnAttention" href="#kerasfactory.layers.ColumnAttention.ColumnAttention">ColumnAttention</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ColumnAttention instance</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="rowattention">üìç RowAttention</h3>
<p>Attention mechanism focused on inter-row (sample) relationships.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.RowAttention" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.RowAttention</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Row attention mechanism for weighting samples in a batch.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.RowAttention-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.RowAttention.RowAttention" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">RowAttention</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">RowAttention</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">feature_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">hidden_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</span><span id="__span-0-5"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Row attention mechanism to weight samples dynamically.</p>
<p>This layer applies attention weights to each sample (row) in the input tensor.
The attention weights are computed using a two-layer neural network that takes
each sample as input and outputs a scalar attention weight.</p>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">RowAttention</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create sample data</span>
</span><span id="__span-0-5"><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>
</span><span id="__span-0-6"><span class="n">feature_dim</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-0-7"><span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">feature_dim</span><span class="p">))</span>
</span><span id="__span-0-8">
</span><span id="__span-0-9"><span class="c1"># Apply row attention</span>
</span><span id="__span-0-10"><span class="n">attention</span> <span class="o">=</span> <span class="n">RowAttention</span><span class="p">(</span><span class="n">feature_dim</span><span class="o">=</span><span class="n">feature_dim</span><span class="p">)</span>
</span><span id="__span-0-11"><span class="n">weighted_outputs</span> <span class="o">=</span> <span class="n">attention</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize row attention.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>feature_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of input features</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>hidden_dim</code></td>
          <td>
                <code>int | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Hidden layer dimension. If None, uses feature_dim // 2</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code>dict[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional layer arguments</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">







<h6 id="kerasfactory.layers.RowAttention.RowAttention-functions">Functions</h6>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.RowAttention.RowAttention.from_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">from_config</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">from_config</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">RowAttention</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Create layer from configuration.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>config</code></td>
          <td>
                <code>dict[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Layer configuration dictionary</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code><a class="autorefs autorefs-internal" title="kerasfactory.layers.RowAttention.RowAttention" href="#kerasfactory.layers.RowAttention.RowAttention">RowAttention</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>RowAttention instance</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h2 id="data-preprocessing-transformation">üìä Data Preprocessing &amp; Transformation</h2>
<h3 id="distributiontransformlayer">üîÑ DistributionTransformLayer</h3>
<p>Transforms data distributions (log, Box-Cox, Yeo-Johnson, etc.) for improved analysis.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.DistributionTransformLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.DistributionTransformLayer</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a DistributionTransformLayer that applies various transformations
to make data more normally distributed or to handle specific distribution types better.
It's particularly useful for preprocessing data before anomaly detection or other statistical analyses.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.DistributionTransformLayer-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.DistributionTransformLayer.DistributionTransformLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">DistributionTransformLayer</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">DistributionTransformLayer</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">transform_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">lambda_param</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">epsilon</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">min_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="n">max_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="__span-0-7">    <span class="n">clip_values</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-8">    <span class="n">auto_candidates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-9">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-10">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-11"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Layer for transforming data distributions to improve anomaly detection.</p>
<p>This layer applies various transformations to make data more normally distributed
or to handle specific distribution types better. Supported transformations include
log, square root, Box-Cox, Yeo-Johnson, arcsinh, cube-root, logit, quantile,
robust-scale, and min-max.</p>
<p>When transform_type is set to 'auto', the layer automatically selects the most
appropriate transformation based on the data characteristics during training.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>transform_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of transformation to apply. Options are 'none', 'log', 'sqrt',
'box-cox', 'yeo-johnson', 'arcsinh', 'cube-root', 'logit', 'quantile',
'robust-scale', 'min-max', or 'auto'. Default is 'none'.</p>
            </div>
          </td>
          <td>
                <code>&#39;none&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>lambda_param</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameter for parameterized transformations like Box-Cox and Yeo-Johnson.
Default is 0.0.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>epsilon</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Small value added to prevent numerical issues like log(0). Default is 1e-10.</p>
            </div>
          </td>
          <td>
                <code>1e-10</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>min_value</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Minimum value for min-max scaling. Default is 0.0.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>max_value</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Maximum value for min-max scaling. Default is 1.0.</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>clip_values</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to clip values to the specified range in min-max scaling. Default is True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>auto_candidates</code></td>
          <td>
                <code>list[str] | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>list of transformation types to consider when transform_type is 'auto'.
If None, all available transformations will be considered. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>N-D tensor with shape: (batch_size, ..., features)</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>Same shape as input: (batch_size, ..., features)</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-0-3"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">DistributionTransformLayer</span>
</span><span id="__span-0-4">
</span><span id="__span-0-5"><span class="c1"># Create sample input data with skewed distribution</span>
</span><span id="__span-0-6"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>  <span class="c1"># 32 samples, 10 features</span>
</span><span id="__span-0-7">
</span><span id="__span-0-8"><span class="c1"># Apply log transformation</span>
</span><span id="__span-0-9"><span class="n">log_transform</span> <span class="o">=</span> <span class="n">DistributionTransformLayer</span><span class="p">(</span><span class="n">transform_type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</span><span id="__span-0-10"><span class="n">y</span> <span class="o">=</span> <span class="n">log_transform</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-11"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Transformed output shape:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32, 10)</span>
</span><span id="__span-0-12">
</span><span id="__span-0-13"><span class="c1"># Apply Box-Cox transformation with lambda=0.5</span>
</span><span id="__span-0-14"><span class="n">box_cox</span> <span class="o">=</span> <span class="n">DistributionTransformLayer</span><span class="p">(</span><span class="n">transform_type</span><span class="o">=</span><span class="s2">&quot;box-cox&quot;</span><span class="p">,</span> <span class="n">lambda_param</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="__span-0-15"><span class="n">z</span> <span class="o">=</span> <span class="n">box_cox</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-16">
</span><span id="__span-0-17"><span class="c1"># Apply arcsinh transformation (handles both positive and negative values)</span>
</span><span id="__span-0-18"><span class="n">arcsinh_transform</span> <span class="o">=</span> <span class="n">DistributionTransformLayer</span><span class="p">(</span><span class="n">transform_type</span><span class="o">=</span><span class="s2">&quot;arcsinh&quot;</span><span class="p">)</span>
</span><span id="__span-0-19"><span class="n">a</span> <span class="o">=</span> <span class="n">arcsinh_transform</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-20">
</span><span id="__span-0-21"><span class="c1"># Apply min-max scaling to range [0, 1]</span>
</span><span id="__span-0-22"><span class="n">min_max</span> <span class="o">=</span> <span class="n">DistributionTransformLayer</span><span class="p">(</span><span class="n">transform_type</span><span class="o">=</span><span class="s2">&quot;min-max&quot;</span><span class="p">,</span> <span class="n">min_value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="__span-0-23"><span class="n">b</span> <span class="o">=</span> <span class="n">min_max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-24">
</span><span id="__span-0-25"><span class="c1"># Use automatic transformation selection</span>
</span><span id="__span-0-26"><span class="n">auto_transform</span> <span class="o">=</span> <span class="n">DistributionTransformLayer</span><span class="p">(</span><span class="n">transform_type</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
</span><span id="__span-0-27"><span class="n">c</span> <span class="o">=</span> <span class="n">auto_transform</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Will select the best transformation during training</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the DistributionTransformLayer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>transform_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of transformation to apply.</p>
            </div>
          </td>
          <td>
                <code>&#39;none&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>lambda_param</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Lambda parameter for Box-Cox transformation.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>epsilon</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Small value to avoid division by zero.</p>
            </div>
          </td>
          <td>
                <code>1e-10</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>min_value</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Minimum value for clipping.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>max_value</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Maximum value for clipping.</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>clip_values</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to clip values.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>auto_candidates</code></td>
          <td>
                <code>list[str] | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of candidate transformations for auto mode.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="distributionawareencoder">üéì DistributionAwareEncoder</h3>
<p>Encodes features while accounting for their underlying distributions.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.DistributionAwareEncoder" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.DistributionAwareEncoder</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a DistributionAwareEncoder layer that automatically detects
the distribution type of input data and applies appropriate transformations and encodings.
It builds upon the DistributionTransformLayer but adds more sophisticated distribution
detection and specialized encoding for different distribution types.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.DistributionAwareEncoder-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.DistributionAwareEncoder.DistributionAwareEncoder" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">DistributionAwareEncoder</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">DistributionAwareEncoder</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">embedding_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">auto_detect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">distribution_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">transform_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="n">add_distribution_embedding</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-7">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-8">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-9"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Layer that automatically detects and encodes data based on its distribution.</p>
<p>This layer first detects the distribution type of the input data and then applies
appropriate transformations and encodings. It builds upon the DistributionTransformLayer
but adds more sophisticated distribution detection and specialized encoding for
different distribution types.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>embedding_dim</code></td>
          <td>
                <code>int | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of the output embedding. If None, the output will have
the same dimension as the input. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>auto_detect</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to automatically detect the distribution type. If False,
the layer will use the specified distribution_type. Default is True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>distribution_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The distribution type to use if auto_detect is False.
Options are "normal", "exponential", "lognormal", "uniform", "beta",
"bimodal", "heavy_tailed", "mixed", "bounded", "unknown". Default is "unknown".</p>
            </div>
          </td>
          <td>
                <code>&#39;unknown&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>transform_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The transformation type to use. If "auto", the layer will
automatically select the best transformation based on the detected distribution.
See DistributionTransformLayer for available options. Default is "auto".</p>
            </div>
          </td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>add_distribution_embedding</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to add a learned embedding of the distribution
type to the output. Default is False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>N-D tensor with shape: <code>(batch_size, ..., features)</code>.</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>If embedding_dim is None, same shape as input: <code>(batch_size, ..., features)</code>.
If embedding_dim is specified: <code>(batch_size, ..., embedding_dim)</code>.
If add_distribution_embedding is True, the output will have an additional
dimension for the distribution embedding.</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-0-3"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">DistributionAwareEncoder</span>
</span><span id="__span-0-4">
</span><span id="__span-0-5"><span class="c1"># Create sample input data with different distributions</span>
</span><span id="__span-0-6"><span class="c1"># Normal distribution</span>
</span><span id="__span-0-7"><span class="n">normal_data</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span>
</span><span id="__span-0-8">    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span>
</span><span id="__span-0-9"><span class="p">)</span>
</span><span id="__span-0-10">
</span><span id="__span-0-11"><span class="c1"># Exponential distribution</span>
</span><span id="__span-0-12"><span class="n">exp_data</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span>
</span><span id="__span-0-13">    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span>
</span><span id="__span-0-14"><span class="p">)</span>
</span><span id="__span-0-15">
</span><span id="__span-0-16"><span class="c1"># Create the encoder</span>
</span><span id="__span-0-17"><span class="n">encoder</span> <span class="o">=</span> <span class="n">DistributionAwareEncoder</span><span class="p">(</span><span class="n">embedding_dim</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">add_distribution_embedding</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-18">
</span><span id="__span-0-19"><span class="c1"># Apply to normal data</span>
</span><span id="__span-0-20"><span class="n">normal_encoded</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">normal_data</span><span class="p">)</span>
</span><span id="__span-0-21"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Normal encoded shape:&quot;</span><span class="p">,</span> <span class="n">normal_encoded</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (100, 16)</span>
</span><span id="__span-0-22">
</span><span id="__span-0-23"><span class="c1"># Apply to exponential data</span>
</span><span id="__span-0-24"><span class="n">exp_encoded</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">exp_data</span><span class="p">)</span>
</span><span id="__span-0-25"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exponential encoded shape:&quot;</span><span class="p">,</span> <span class="n">exp_encoded</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (100, 16)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the DistributionAwareEncoder.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>embedding_dim</code></td>
          <td>
                <code>int | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Embedding dimension.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>auto_detect</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to auto-detect distribution type.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>distribution_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of distribution.</p>
            </div>
          </td>
          <td>
                <code>&#39;unknown&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>transform_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of transformation to apply.</p>
            </div>
          </td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>add_distribution_embedding</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to add distribution embedding.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="advancednumericalembedding">üìà AdvancedNumericalEmbedding</h3>
<p>Advanced numerical embedding layer for rich feature representations.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.AdvancedNumericalEmbedding" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.AdvancedNumericalEmbedding</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements an AdvancedNumericalEmbedding layer that embeds continuous numerical features
into a higher-dimensional space using a combination of continuous and discrete branches.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.AdvancedNumericalEmbedding-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.AdvancedNumericalEmbedding.AdvancedNumericalEmbedding" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">AdvancedNumericalEmbedding</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">AdvancedNumericalEmbedding</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">embedding_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">mlp_hidden_units</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">num_bins</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">init_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="n">init_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span>
</span><span id="__span-0-7">    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="__span-0-8">    <span class="n">use_batch_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-9">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-10">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-11"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Advanced numerical embedding layer for continuous features.</p>
<p>This layer embeds each continuous numerical feature into a higher-dimensional space by
combining two branches:</p>
<ol>
<li>Continuous Branch: Each feature is processed via a small MLP.</li>
<li>Discrete Branch: Each feature is discretized into bins using learnable min/max boundaries
     and then an embedding is looked up for its bin.</li>
</ol>
<p>A learnable gate combines the two branch outputs per feature and per embedding dimension.
Additionally, the continuous branch uses a residual connection and optional batch normalization
to improve training stability.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>embedding_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Output embedding dimension per feature.</p>
            </div>
          </td>
          <td>
                <code>8</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>mlp_hidden_units</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Hidden units for the continuous branch MLP.</p>
            </div>
          </td>
          <td>
                <code>16</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>num_bins</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of bins for discretization.</p>
            </div>
          </td>
          <td>
                <code>10</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>init_min</code></td>
          <td>
                <code>float or list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initial minimum values for discretization boundaries. If a scalar is
provided, it is applied to all features.</p>
            </div>
          </td>
          <td>
                <code>-3.0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>init_max</code></td>
          <td>
                <code>float or list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initial maximum values for discretization boundaries.</p>
            </div>
          </td>
          <td>
                <code>3.0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate applied to the continuous branch.</p>
            </div>
          </td>
          <td>
                <code>0.1</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>use_batch_norm</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to apply batch normalization to the continuous branch.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>Tensor with shape: <code>(batch_size, num_features)</code></p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>Tensor with shape: <code>(batch_size, num_features, embedding_dim)</code> or
<code>(batch_size, embedding_dim)</code> if num_features=1</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">AdvancedNumericalEmbedding</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create sample input data</span>
</span><span id="__span-0-5"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>  <span class="c1"># 32 samples, 5 features</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Create the layer</span>
</span><span id="__span-0-8"><span class="n">embedding</span> <span class="o">=</span> <span class="n">AdvancedNumericalEmbedding</span><span class="p">(</span>
</span><span id="__span-0-9">    <span class="n">embedding_dim</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
</span><span id="__span-0-10">    <span class="n">mlp_hidden_units</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
</span><span id="__span-0-11">    <span class="n">num_bins</span><span class="o">=</span><span class="mi">10</span>
</span><span id="__span-0-12"><span class="p">)</span>
</span><span id="__span-0-13"><span class="n">y</span> <span class="o">=</span> <span class="n">embedding</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-14"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output shape:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32, 5, 8)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the AdvancedNumericalEmbedding layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>embedding_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Embedding dimension.</p>
            </div>
          </td>
          <td>
                <code>8</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>mlp_hidden_units</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Hidden units in MLP.</p>
            </div>
          </td>
          <td>
                <code>16</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>num_bins</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of bins for discretization.</p>
            </div>
          </td>
          <td>
                <code>10</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>init_min</code></td>
          <td>
                <code>float | list[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Minimum initialization value.</p>
            </div>
          </td>
          <td>
                <code>-3.0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>init_max</code></td>
          <td>
                <code>float | list[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Maximum initialization value.</p>
            </div>
          </td>
          <td>
                <code>3.0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate.</p>
            </div>
          </td>
          <td>
                <code>0.1</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>use_batch_norm</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to use batch normalization.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">







<h6 id="kerasfactory.layers.AdvancedNumericalEmbedding.AdvancedNumericalEmbedding-functions">Functions</h6>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.AdvancedNumericalEmbedding.AdvancedNumericalEmbedding.compute_output_shape" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_output_shape</span>


</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">compute_output_shape</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">input_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="__span-0-3"><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Compute the output shape of the layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_shape</code></td>
          <td>
                <code>tuple[int, ...]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>tuple[int, ...]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the output tensor.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="dateparsinglayer">üìÖ DateParsingLayer</h3>
<p>Parses and processes date/time features.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.DateParsingLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.DateParsingLayer</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Date Parsing Layer for Keras 3.</p>
<p>This module provides a layer for parsing date strings into numerical components.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.DateParsingLayer-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.DateParsingLayer.DateParsingLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">DateParsingLayer</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">DateParsingLayer</span><span class="p">(</span><span class="n">date_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;YYYY-MM-DD&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Layer for parsing date strings into numerical components.</p>
<p>This layer takes date strings in a specified format and returns a tensor
containing the year, month, day of the month, and day of the week.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>date_format</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Format of the date strings. Currently supports 'YYYY-MM-DD'
and 'YYYY/MM/DD'. Default is 'YYYY-MM-DD'.</p>
            </div>
          </td>
          <td>
                <code>&#39;YYYY-MM-DD&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments to pass to the base layer.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>String tensor of any shape.</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>Same as input shape with an additional dimension of size 4 appended.
For example, if input shape is [batch_size], output shape will be
[batch_size, 4].</p>
</details>  
      <p>Initialize the layer.</p>


  

  <div class="doc doc-children">







<h6 id="kerasfactory.layers.DateParsingLayer.DateParsingLayer-functions">Functions</h6>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.DateParsingLayer.DateParsingLayer.compute_output_shape" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_output_shape</span>


</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">compute_output_shape</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Compute the output shape of the layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_shape</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>tuple[int, ...]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the output tensor.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="dateencodinglayer">üïê DateEncodingLayer</h3>
<p>Encodes dates into learnable embeddings for temporal features.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.DateEncodingLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.DateEncodingLayer</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>DateEncodingLayer for encoding date components into cyclical features.</p>
<p>This layer takes date components (year, month, day, day of week) and encodes them
into cyclical features using sine and cosine transformations.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.DateEncodingLayer-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.DateEncodingLayer.DateEncodingLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">DateEncodingLayer</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">DateEncodingLayer</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">min_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1900</span><span class="p">,</span> <span class="n">max_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2100</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="__span-0-3"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Layer for encoding date components into cyclical features.</p>
<p>This layer takes date components (year, month, day, day of week) and encodes them
into cyclical features using sine and cosine transformations. The year is normalized
to a range between 0 and 1 based on min_year and max_year.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>min_year</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Minimum year for normalization (default: 1900)</p>
            </div>
          </td>
          <td>
                <code>1900</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>max_year</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Maximum year for normalization (default: 2100)</p>
            </div>
          </td>
          <td>
                <code>2100</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional layer arguments</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>Tensor with shape: <code>(..., 4)</code> containing [year, month, day, day_of_week]</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>Tensor with shape: <code>(..., 8)</code> containing cyclical encodings:
[year_sin, year_cos, month_sin, month_cos, day_sin, day_cos, dow_sin, dow_cos]</p>
</details>  
      <p>Initialize the layer.</p>


  

  <div class="doc doc-children">







<h6 id="kerasfactory.layers.DateEncodingLayer.DateEncodingLayer-functions">Functions</h6>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.DateEncodingLayer.DateEncodingLayer.compute_output_shape" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_output_shape</span>


</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">compute_output_shape</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Compute the output shape of the layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_shape</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>tuple[int, ...]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Output shape</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="seasonlayer">üåô SeasonLayer</h3>
<p>Extracts and processes seasonal patterns from temporal data.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.SeasonLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.SeasonLayer</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>SeasonLayer for adding seasonal information based on month.</p>
<p>This layer adds seasonal information based on the month, encoding it as a one-hot vector
for the four seasons: Winter, Spring, Summer, and Fall.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.SeasonLayer-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.SeasonLayer.SeasonLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">SeasonLayer</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">SeasonLayer</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Layer for adding seasonal information based on month.</p>
<p>This layer adds seasonal information based on the month, encoding it as a one-hot vector
for the four seasons: Winter, Spring, Summer, and Fall.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional layer arguments</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>Tensor with shape: <code>(..., 4)</code> containing [year, month, day, day_of_week]</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>Tensor with shape: <code>(..., 8)</code> containing the original 4 components plus
4 one-hot encoded season values</p>
</details>  
      <p>Initialize the layer.</p>


  

  <div class="doc doc-children">







<h6 id="kerasfactory.layers.SeasonLayer.SeasonLayer-functions">Functions</h6>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.SeasonLayer.SeasonLayer.compute_output_shape" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_output_shape</span>


</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">compute_output_shape</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">input_shape</span><span class="p">,</span>
</span><span id="__span-0-3"><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Compute the output shape of the layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_shape</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>tuple[tuple[int, ...], tuple[int, ...]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Output shape</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="differentialpreprocessinglayer">üîÄ DifferentialPreprocessingLayer</h3>
<p>Applies differential preprocessing transformations to features.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.DifferentialPreprocessingLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.DifferentialPreprocessingLayer</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a DifferentialPreprocessingLayer that applies multiple candidate transformations
to tabular data and learns to combine them optimally. It also handles missing values with learnable imputation.
This approach is useful for tabular data where the optimal preprocessing strategy is not known in advance.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.DifferentialPreprocessingLayer-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.DifferentialPreprocessingLayer.DifferentialPreprocessingLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">DifferentialPreprocessingLayer</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">DifferentialPreprocessingLayer</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">num_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">mlp_hidden_units</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-6"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Differentiable preprocessing layer for numeric tabular data with multiple candidate transformations.</p>

<details class="this-layer" open>
  <summary>This layer</summary>
  <ol>
<li>Imputes missing values using a learnable imputation vector.</li>
<li>Applies several candidate transformations:</li>
<li>Identity (pass-through)</li>
<li>Affine transformation (learnable scaling and bias)</li>
<li>Nonlinear transformation via a small MLP</li>
<li>Log transformation (using a softplus to ensure positivity)</li>
<li>Learns softmax combination weights to aggregate the candidates.</li>
</ol>
</details>      <p>The entire preprocessing pipeline is differentiable, so the network learns the optimal
imputation and transformation jointly with downstream tasks.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>num_features</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of numeric features in the input.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>mlp_hidden_units</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of hidden units in the nonlinear branch. Default is 4.</p>
            </div>
          </td>
          <td>
                <code>4</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>2D tensor with shape: <code>(batch_size, num_features)</code></p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>2D tensor with shape: <code>(batch_size, num_features)</code> (same as input)</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-0-3"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">DifferentialPreprocessingLayer</span>
</span><span id="__span-0-4">
</span><span id="__span-0-5"><span class="c1"># Create dummy data: 6 samples, 4 features (with some missing values)</span>
</span><span id="__span-0-6"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">([</span>
</span><span id="__span-0-7">    <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">),</span> <span class="mf">4.0</span><span class="p">],</span>
</span><span id="__span-0-8">    <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">),</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">],</span>
</span><span id="__span-0-9">    <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">),</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">],</span>
</span><span id="__span-0-10">    <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)],</span>
</span><span id="__span-0-11">    <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">],</span>
</span><span id="__span-0-12">    <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span>
</span><span id="__span-0-13"><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span>
</span><span id="__span-0-14">
</span><span id="__span-0-15"><span class="c1"># Instantiate the layer for 4 features.</span>
</span><span id="__span-0-16"><span class="n">preproc_layer</span> <span class="o">=</span> <span class="n">DifferentialPreprocessingLayer</span><span class="p">(</span><span class="n">num_features</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">mlp_hidden_units</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="__span-0-17"><span class="n">y</span> <span class="o">=</span> <span class="n">preproc_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-18"><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the DifferentialPreprocessingLayer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>num_features</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of input features.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>mlp_hidden_units</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of hidden units in MLP.</p>
            </div>
          </td>
          <td>
                <code>4</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="differentiabletabularpreprocessor">üîß DifferentiableTabularPreprocessor</h3>
<p>Differentiable preprocessing layer for tabular data end-to-end training.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.DifferentiableTabularPreprocessor" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.DifferentiableTabularPreprocessor</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a DifferentiableTabularPreprocessor layer that integrates preprocessing
into the model so that the optimal imputation and normalization parameters are learned end-to-end.
This approach is useful for tabular data with missing values and features that need normalization.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.DifferentiableTabularPreprocessor-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.DifferentiableTabularPreprocessor.DifferentiableTabularPreprocessor" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">DifferentiableTabularPreprocessor</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">DifferentiableTabularPreprocessor</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">num_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-5"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>A differentiable preprocessing layer for numeric tabular data.</p>

<details class="this-layer" open>
  <summary>This layer</summary>
  <ul>
<li>Replaces missing values (NaNs) with a learnable imputation vector.</li>
<li>Applies a learned affine transformation (scaling and shifting) to each feature.</li>
</ul>
</details>      <p>The idea is to integrate preprocessing into the model so that the optimal
imputation and normalization parameters are learned end-to-end.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>num_features</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of numeric features in the input.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>2D tensor with shape: <code>(batch_size, num_features)</code></p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>2D tensor with shape: <code>(batch_size, num_features)</code> (same as input)</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-0-3"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">DifferentiableTabularPreprocessor</span>
</span><span id="__span-0-4">
</span><span id="__span-0-5"><span class="c1"># Suppose we have tabular data with 5 numeric features</span>
</span><span id="__span-0-6"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">([</span>
</span><span id="__span-0-7">    <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span>
</span><span id="__span-0-8">    <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span>
</span><span id="__span-0-9"><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span>
</span><span id="__span-0-10">
</span><span id="__span-0-11"><span class="n">preproc</span> <span class="o">=</span> <span class="n">DifferentiableTabularPreprocessor</span><span class="p">(</span><span class="n">num_features</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="__span-0-12"><span class="n">y</span> <span class="o">=</span> <span class="n">preproc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-13"><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the DifferentiableTabularPreprocessor.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>num_features</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of input features.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="casttofloat32layer">üé® CastToFloat32Layer</h3>
<p>Type casting layer for ensuring float32 precision.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.CastToFloat32Layer" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.CastToFloat32Layer</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a CastToFloat32Layer that casts input tensors to float32 data type.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.CastToFloat32Layer-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.CastToFloat32Layer.CastToFloat32Layer" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">CastToFloat32Layer</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">CastToFloat32Layer</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Layer that casts input tensors to float32 data type.</p>
<p>This layer is useful for ensuring consistent data types in a model,
especially when working with mixed precision or when receiving inputs
of various data types.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>Tensor of any shape and numeric data type.</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>Same as input shape, but with float32 data type.</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-0-3"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">CastToFloat32Layer</span>
</span><span id="__span-0-4">
</span><span id="__span-0-5"><span class="c1"># Create sample input data with int64 type</span>
</span><span id="__span-0-6"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">))</span>
</span><span id="__span-0-7">
</span><span id="__span-0-8"><span class="c1"># Apply casting layer</span>
</span><span id="__span-0-9"><span class="n">cast_layer</span> <span class="o">=</span> <span class="n">CastToFloat32Layer</span><span class="p">()</span>
</span><span id="__span-0-10"><span class="n">y</span> <span class="o">=</span> <span class="n">cast_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-11">
</span><span id="__span-0-12"><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  <span class="c1"># float32</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the CastToFloat32Layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">







<h6 id="kerasfactory.layers.CastToFloat32Layer.CastToFloat32Layer-functions">Functions</h6>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.CastToFloat32Layer.CastToFloat32Layer.compute_output_shape" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_output_shape</span>


</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">compute_output_shape</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">input_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="__span-0-3"><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Compute the output shape of the layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_shape</code></td>
          <td>
                <code>tuple[int, ...]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>tuple[int, ...]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Same shape as input.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h2 id="graph-ensemble-methods">üåê Graph &amp; Ensemble Methods</h2>
<h3 id="graphfeatureaggregation">üìä GraphFeatureAggregation</h3>
<p>Aggregates features from graph structures for relational learning.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.GraphFeatureAggregation" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.GraphFeatureAggregation</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a GraphFeatureAggregation layer that treats features as nodes in a graph
and uses attention mechanisms to learn relationships between features. This approach is useful
for tabular data where features have inherent relationships.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.GraphFeatureAggregation-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.GraphFeatureAggregation.GraphFeatureAggregation" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">GraphFeatureAggregation</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">GraphFeatureAggregation</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">embed_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">leaky_relu_alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-7"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Graph-based feature aggregation layer with self-attention for tabular data.</p>
<p>This layer treats each input feature as a node and projects it into an embedding space.
It then computes pairwise attention scores between features and aggregates feature
information based on these scores. Finally, it projects the aggregated features back
to the original feature space and adds a residual connection.</p>

<details class="the-process-involves" open>
  <summary>The process involves</summary>
  <ol>
<li>Projecting each scalar feature to an embedding (shape: [batch, num_features, embed_dim]).</li>
<li>Computing pairwise concatenated embeddings and scoring them via a learnable attention vector.</li>
<li>Normalizing the scores with softmax to yield a dynamic adjacency (attention) matrix.</li>
<li>Aggregating neighboring features via weighted sum.</li>
<li>Projecting back to a vector of original dimension, then adding a residual connection.</li>
</ol>
</details>


  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>embed_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimensionality of the projected feature embeddings. Default is 8.</p>
            </div>
          </td>
          <td>
                <code>8</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate to apply on attention weights. Default is 0.0.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>leaky_relu_alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha parameter for the LeakyReLU activation. Default is 0.2.</p>
            </div>
          </td>
          <td>
                <code>0.2</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>2D tensor with shape: <code>(batch_size, num_features)</code></p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>2D tensor with shape: <code>(batch_size, num_features)</code> (same as input)</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">GraphFeatureAggregation</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Tabular data with 10 features</span>
</span><span id="__span-0-5"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Create the layer with an embedding dimension of 8 and dropout rate of 0.1</span>
</span><span id="__span-0-8"><span class="n">graph_layer</span> <span class="o">=</span> <span class="n">GraphFeatureAggregation</span><span class="p">(</span><span class="n">embed_dim</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</span><span id="__span-0-9"><span class="n">y</span> <span class="o">=</span> <span class="n">graph_layer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-10"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output shape:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Expected: (32, 10)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the GraphFeatureAggregation layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>embed_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Embedding dimension.</p>
            </div>
          </td>
          <td>
                <code>8</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>leaky_relu_alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha parameter for LeakyReLU.</p>
            </div>
          </td>
          <td>
                <code>0.2</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="advancedgraphfeaturelayer">üß¨ AdvancedGraphFeatureLayer</h3>
<p>Advanced graph feature processing with multi-hop aggregation.</p>


<div class="doc doc-object doc-class">



<h3 id="kerasfactory.layers.AdvancedGraphFeatureLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">kerasfactory.layers.AdvancedGraphFeatureLayer</span>


</h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">AdvancedGraphFeatureLayer</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">embed_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">num_heads</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">hierarchical</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="n">num_groups</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-7">    <span class="o">**</span><span class="n">kwargs</span>
</span><span id="__span-0-8"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents first">

  
      <p>Advanced graph-based feature layer for tabular data.</p>
<p>This layer projects scalar features into an embedding space and then applies
multi-head self-attention to compute data-dependent dynamic adjacencies between
features. It learns edge attributes by considering both the raw embeddings and
their differences. Optionally, a hierarchical aggregation is applied, where
features are grouped via a learned soft-assignment and then re-expanded back to
the original feature space. A residual connection and layer normalization are
applied before the final projection back to the original feature space.</p>
<p>The layer is highly configurable, allowing for control over the embedding dimension,
number of attention heads, dropout rate, and hierarchical aggregation.</p>

<details class="notes" open>
  <summary>Notes</summary>
  <p><strong>When to Use This Layer:</strong>
- When working with tabular data where feature interactions are important
- For complex feature engineering tasks where manual feature crosses are insufficient
- When dealing with heterogeneous features that require dynamic, learned relationships
- In scenarios where feature importance varies across different samples
- When hierarchical feature relationships exist in your data</p>
<p><strong>Best Practices:</strong>
- Start with a small embed_dim (e.g., 16 or 32) and increase if needed
- Use num_heads=4 or 8 for most applications
- Enable hierarchical=True when you have many features (&gt;20) or known grouping structure
- Set dropout_rate=0.1 or 0.2 for regularization during training
- Use layer normalization (enabled by default) to stabilize training</p>
<p><strong>Performance Considerations:</strong>
- Memory usage scales quadratically with the number of features
- Consider using hierarchical mode for large feature sets to reduce complexity
- The layer works best with normalized input features
- For very large feature sets (&gt;100), consider feature pre-selection</p>
</details>


  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>embed_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimensionality of the projected feature embeddings. Determines the size
of the learned feature representations.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>num_heads</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of attention heads. Must divide embed_dim evenly. Each head
learns different aspects of feature relationships.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate applied to attention weights during training.
Helps prevent overfitting. Defaults to 0.0.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>hierarchical</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to apply hierarchical aggregation. If True, features
are grouped into clusters, and aggregation is performed at the cluster level.
Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>num_groups</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of groups to cluster features into when hierarchical is True.
Must be provided if hierarchical is True. Controls the granularity of hierarchical
aggregation.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Raises:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If embed_dim is not divisible by num_heads. Ensures that the embedding dimension
can be evenly split across attention heads.</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If hierarchical is True but num_groups is not provided. The number of groups
must be specified when hierarchical aggregation is enabled.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><span class="doc-section-title">Examples:</span></p>
    <p><strong>Basic Usage:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">AdvancedGraphFeatureLayer</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Dummy tabular data with 10 features for 32 samples.</span>
</span><span id="__span-0-5"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="__span-0-6"><span class="c1"># Create the advanced graph layer with an embedding dimension of 16 and 4 heads.</span>
</span><span id="__span-0-7"><span class="n">layer</span> <span class="o">=</span> <span class="n">AdvancedGraphFeatureLayer</span><span class="p">(</span><span class="n">embed_dim</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">num_heads</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</span><span id="__span-0-8"><span class="n">y</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-9"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output shape:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Expected: (32, 10)</span>
</span></code></pre></div></td></tr></table></div>
<p><strong>With Hierarchical Aggregation:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-1-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">AdvancedGraphFeatureLayer</span>
</span><span id="__span-1-3">
</span><span id="__span-1-4"><span class="c1"># Dummy tabular data with 10 features for 32 samples.</span>
</span><span id="__span-1-5"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="__span-1-6"><span class="c1"># Create the advanced graph layer with hierarchical aggregation into 4 groups.</span>
</span><span id="__span-1-7"><span class="n">layer</span> <span class="o">=</span> <span class="n">AdvancedGraphFeatureLayer</span><span class="p">(</span><span class="n">embed_dim</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">num_heads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">hierarchical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">num_groups</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</span><span id="__span-1-8"><span class="n">y</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-1-9"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output shape:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Expected: (32, 10)</span>
</span></code></pre></div></td></tr></table></div>
<p><strong>Without Training:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-2-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">AdvancedGraphFeatureLayer</span>
</span><span id="__span-2-3">
</span><span id="__span-2-4"><span class="c1"># Dummy tabular data with 10 features for 32 samples.</span>
</span><span id="__span-2-5"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="__span-2-6"><span class="c1"># Create the advanced graph layer with an embedding dimension of 16 and 4 heads.</span>
</span><span id="__span-2-7"><span class="n">layer</span> <span class="o">=</span> <span class="n">AdvancedGraphFeatureLayer</span><span class="p">(</span><span class="n">embed_dim</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">num_heads</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</span><span id="__span-2-8"><span class="n">y</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-2-9"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output shape:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Expected: (32, 10)</span>
</span></code></pre></div></td></tr></table></div>
  
      <p>Initialize the AdvancedGraphFeature layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>embed_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Embedding dimension.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>num_heads</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of attention heads.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>hierarchical</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to use hierarchical attention.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>num_groups</code></td>
          <td>
                <code>int | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of groups for hierarchical attention.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">







<h4 id="kerasfactory.layers.AdvancedGraphFeatureLayer-functions">Functions</h4>


<div class="doc doc-object doc-function">



<h5 id="kerasfactory.layers.AdvancedGraphFeatureLayer.compute_output_shape" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_output_shape</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">compute_output_shape</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Compute the output shape of the layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_shape</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape tuple (batch_size, num_features)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>tuple[int, ...]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Output shape tuple (batch_size, num_features)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div><h3 id="multiheadgraphfeaturepreprocessor">üë• MultiHeadGraphFeaturePreprocessor</h3>
<p>Multi-head preprocessing for graph features with parallel aggregation.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.MultiHeadGraphFeaturePreprocessor" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.MultiHeadGraphFeaturePreprocessor</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a MultiHeadGraphFeaturePreprocessor layer that treats features as nodes
in a graph and learns multiple "views" (heads) of the feature interactions via self-attention.
This approach is useful for tabular data where complex feature relationships need to be captured.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.MultiHeadGraphFeaturePreprocessor-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.MultiHeadGraphFeaturePreprocessor.MultiHeadGraphFeaturePreprocessor" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">MultiHeadGraphFeaturePreprocessor</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">MultiHeadGraphFeaturePreprocessor</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">embed_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">num_heads</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-7"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Multi-head graph-based feature preprocessor for tabular data.</p>
<p>This layer treats each feature as a node and applies multi-head self-attention
to capture and aggregate complex interactions among features. The process is:</p>
<ol>
<li>Project each scalar input into an embedding of dimension <code>embed_dim</code>.</li>
<li>Split the embedding into <code>num_heads</code> heads.</li>
<li>For each head, compute queries, keys, and values and calculate scaled dot-product
   attention across the feature dimension.</li>
<li>Concatenate the head outputs, project back to the original feature dimension,
   and add a residual connection.</li>
</ol>
<p>This mechanism allows the network to learn multiple relational views among features,
which can significantly boost performance on tabular data.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>embed_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of the feature embeddings. Default is 16.</p>
            </div>
          </td>
          <td>
                <code>16</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>num_heads</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of attention heads. Default is 4.</p>
            </div>
          </td>
          <td>
                <code>4</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate applied to attention weights. Default is 0.0.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>2D tensor with shape: <code>(batch_size, num_features)</code></p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>2D tensor with shape: <code>(batch_size, num_features)</code> (same as input)</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiHeadGraphFeaturePreprocessor</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Tabular data with 10 features</span>
</span><span id="__span-0-5"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Create the layer with 16-dim embeddings and 4 attention heads</span>
</span><span id="__span-0-8"><span class="n">graph_preproc</span> <span class="o">=</span> <span class="n">MultiHeadGraphFeaturePreprocessor</span><span class="p">(</span><span class="n">embed_dim</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">num_heads</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</span><span id="__span-0-9"><span class="n">y</span> <span class="o">=</span> <span class="n">graph_preproc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-10"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output shape:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Expected: (32, 10)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the MultiHeadGraphFeaturePreprocessor.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>embed_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Embedding dimension.</p>
            </div>
          </td>
          <td>
                <code>16</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>num_heads</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of attention heads.</p>
            </div>
          </td>
          <td>
                <code>4</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">







<h6 id="kerasfactory.layers.MultiHeadGraphFeaturePreprocessor.MultiHeadGraphFeaturePreprocessor-functions">Functions</h6>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.MultiHeadGraphFeaturePreprocessor.MultiHeadGraphFeaturePreprocessor.split_heads" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">split_heads</span>


</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">split_heads</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">x</span><span class="p">:</span> <span class="n">KerasTensor</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="n">KerasTensor</span>
</span><span id="__span-0-3"><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KerasTensor</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Split the last dimension into (num_heads, depth) and transpose.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>x</code></td>
          <td>
                <code><span title="keras.KerasTensor">KerasTensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input tensor with shape (batch_size, num_features, embed_dim).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>batch_size</code></td>
          <td>
                <code><span title="keras.KerasTensor">KerasTensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Batch size tensor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code><span title="keras.KerasTensor">KerasTensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor with shape (batch_size, num_heads, num_features, depth).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="boostingblock">üìà BoostingBlock</h3>
<p>Boosting ensemble block for combining weak learners.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.BoostingBlock" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.BoostingBlock</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a BoostingBlock layer that simulates gradient boosting behavior in a neural network.
The layer computes a correction term via a configurable MLP and adds a scaled version to the input.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.BoostingBlock-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.BoostingBlock.BoostingBlock" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">BoostingBlock</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">BoostingBlock</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">hidden_units</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">hidden_activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">output_activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">gamma_trainable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-0-7">    <span class="o">|</span> <span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="s2">&quot;ones&quot;</span><span class="p">,</span>
</span><span id="__span-0-8">    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-9">    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-0-10">    <span class="o">|</span> <span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="s2">&quot;glorot_uniform&quot;</span><span class="p">,</span>
</span><span id="__span-0-11">    <span class="n">bias_initializer</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-0-12">    <span class="o">|</span> <span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
</span><span id="__span-0-13">    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-14">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-15">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-16"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>A neural network layer that simulates gradient boosting behavior.</p>
<p>This layer implements a weak learner that computes a correction term via a configurable MLP
and adds a scaled version of this correction to the input. Stacking several such blocks
can mimic the iterative residual-correction process of gradient boosting.</p>

<details class="the-output-is-computed-as" open>
  <summary>The output is computed as</summary>
  <p>output = inputs + gamma * f(inputs)</p>
</details>      <p>where:
    - f is a configurable MLP (default: two-layer network)
    - gamma is a learnable or fixed scaling factor</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>hidden_units</code></td>
          <td>
                <code>int | list[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of units in the hidden layer(s). Can be an int for single hidden layer
or a list of ints for multiple hidden layers. Default is 64.</p>
            </div>
          </td>
          <td>
                <code>64</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>hidden_activation</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Activation function for hidden layers. Default is 'relu'.</p>
            </div>
          </td>
          <td>
                <code>&#39;relu&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>output_activation</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Activation function for the output layer. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>gamma_trainable</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether the scaling factor gamma is trainable. Default is True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>gamma_initializer</code></td>
          <td>
                <code>str | <span title="keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initializer for the gamma scaling factor. Default is 'ones'.</p>
            </div>
          </td>
          <td>
                <code>&#39;ones&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>use_bias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to include bias terms in the dense layers. Default is True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>kernel_initializer</code></td>
          <td>
                <code>str | <span title="keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initializer for the dense layer kernels. Default is 'glorot_uniform'.</p>
            </div>
          </td>
          <td>
                <code>&#39;glorot_uniform&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>bias_initializer</code></td>
          <td>
                <code>str | <span title="keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initializer for the dense layer biases. Default is 'zeros'.</p>
            </div>
          </td>
          <td>
                <code>&#39;zeros&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional dropout rate to apply after hidden layers. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>N-D tensor with shape: (batch_size, ..., input_dim)</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>Same shape as input: (batch_size, ..., input_dim)</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">BoostingBlock</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create sample input data</span>
</span><span id="__span-0-5"><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>  <span class="c1"># 32 samples, 16 features</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Basic usage</span>
</span><span id="__span-0-8"><span class="n">block</span> <span class="o">=</span> <span class="n">BoostingBlock</span><span class="p">(</span><span class="n">hidden_units</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</span><span id="__span-0-9"><span class="n">y</span> <span class="o">=</span> <span class="n">block</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-10"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output shape:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32, 16)</span>
</span><span id="__span-0-11">
</span><span id="__span-0-12"><span class="c1"># Advanced configuration</span>
</span><span id="__span-0-13"><span class="n">block</span> <span class="o">=</span> <span class="n">BoostingBlock</span><span class="p">(</span>
</span><span id="__span-0-14">    <span class="n">hidden_units</span><span class="o">=</span><span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>  <span class="c1"># Two hidden layers</span>
</span><span id="__span-0-15">    <span class="n">hidden_activation</span><span class="o">=</span><span class="s1">&#39;selu&#39;</span><span class="p">,</span>
</span><span id="__span-0-16">    <span class="n">dropout_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="__span-0-17">    <span class="n">gamma_trainable</span><span class="o">=</span><span class="kc">False</span>
</span><span id="__span-0-18"><span class="p">)</span>
</span><span id="__span-0-19"><span class="n">y</span> <span class="o">=</span> <span class="n">block</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the BoostingBlock layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>hidden_units</code></td>
          <td>
                <code>int | list[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of hidden units or list of units per layer.</p>
            </div>
          </td>
          <td>
                <code>64</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>hidden_activation</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Activation function for hidden layers.</p>
            </div>
          </td>
          <td>
                <code>&#39;relu&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>output_activation</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Activation function for output layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>gamma_trainable</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether gamma parameter is trainable.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>gamma_initializer</code></td>
          <td>
                <code>str | <span title="keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initializer for gamma parameter.</p>
            </div>
          </td>
          <td>
                <code>&#39;ones&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>use_bias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to use bias.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>kernel_initializer</code></td>
          <td>
                <code>str | <span title="keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initializer for kernel weights.</p>
            </div>
          </td>
          <td>
                <code>&#39;glorot_uniform&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>bias_initializer</code></td>
          <td>
                <code>str | <span title="keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initializer for bias weights.</p>
            </div>
          </td>
          <td>
                <code>&#39;zeros&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="boostingensemblelayer">üéØ BoostingEnsembleLayer</h3>
<p>Ensemble layer implementing gradient boosting mechanisms.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.BoostingEnsembleLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.BoostingEnsembleLayer</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a BoostingEnsembleLayer that aggregates multiple BoostingBlocks in parallel.
Their outputs are combined via learnable weights to form an ensemble prediction.
This is similar in spirit to boosting ensembles but implemented in a differentiable, end-to-end manner.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.BoostingEnsembleLayer-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.BoostingEnsembleLayer.BoostingEnsembleLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">BoostingEnsembleLayer</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">BoostingEnsembleLayer</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">num_learners</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">learner_units</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">hidden_activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">output_activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="n">gamma_trainable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-7">    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-9">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-10"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Ensemble layer of boosting blocks for tabular data.</p>
<p>This layer aggregates multiple boosting blocks (weak learners) in parallel. Each
learner produces a correction to the input. A gating mechanism (via learnable weights)
then computes a weighted sum of the learners' outputs.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>num_learners</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of boosting blocks in the ensemble. Default is 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>learner_units</code></td>
          <td>
                <code>int | list[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of hidden units in each boosting block. Can be an int for
single hidden layer or a list of ints for multiple hidden layers. Default is 64.</p>
            </div>
          </td>
          <td>
                <code>64</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>hidden_activation</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Activation function for hidden layers in boosting blocks. Default is 'relu'.</p>
            </div>
          </td>
          <td>
                <code>&#39;relu&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>output_activation</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Activation function for the output layer in boosting blocks. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>gamma_trainable</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether the scaling factor gamma in boosting blocks is trainable. Default is True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional dropout rate to apply in boosting blocks. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>N-D tensor with shape: (batch_size, ..., input_dim)</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>Same shape as input: (batch_size, ..., input_dim)</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">BoostingEnsembleLayer</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create sample input data</span>
</span><span id="__span-0-5"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>  <span class="c1"># 32 samples, 16 features</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Basic usage</span>
</span><span id="__span-0-8"><span class="n">ensemble</span> <span class="o">=</span> <span class="n">BoostingEnsembleLayer</span><span class="p">(</span><span class="n">num_learners</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">learner_units</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</span><span id="__span-0-9"><span class="n">y</span> <span class="o">=</span> <span class="n">ensemble</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-10"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ensemble output shape:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32, 16)</span>
</span><span id="__span-0-11">
</span><span id="__span-0-12"><span class="c1"># Advanced configuration</span>
</span><span id="__span-0-13"><span class="n">ensemble</span> <span class="o">=</span> <span class="n">BoostingEnsembleLayer</span><span class="p">(</span>
</span><span id="__span-0-14">    <span class="n">num_learners</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="__span-0-15">    <span class="n">learner_units</span><span class="o">=</span><span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>  <span class="c1"># Two hidden layers in each learner</span>
</span><span id="__span-0-16">    <span class="n">hidden_activation</span><span class="o">=</span><span class="s1">&#39;selu&#39;</span><span class="p">,</span>
</span><span id="__span-0-17">    <span class="n">dropout_rate</span><span class="o">=</span><span class="mf">0.1</span>
</span><span id="__span-0-18"><span class="p">)</span>
</span><span id="__span-0-19"><span class="n">y</span> <span class="o">=</span> <span class="n">ensemble</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the BoostingEnsembleLayer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>num_learners</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of boosting learners.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>learner_units</code></td>
          <td>
                <code>int | list[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of units per learner or list of units.</p>
            </div>
          </td>
          <td>
                <code>64</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>hidden_activation</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Activation function for hidden layers.</p>
            </div>
          </td>
          <td>
                <code>&#39;relu&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>output_activation</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Activation function for output layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>gamma_trainable</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether gamma parameter is trainable.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dropout_rate</code></td>
          <td>
                <code>float | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dropout rate.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="tabularmoelayer">üìä TabularMoELayer</h3>
<p>Mixture of Experts layer optimized for tabular data.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.TabularMoELayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.TabularMoELayer</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a TabularMoELayer (Mixture-of-Experts) that routes input features
through multiple expert sub-networks and aggregates their outputs via a learnable gating mechanism.
This approach is useful for tabular data where different experts can specialize in different feature patterns.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.TabularMoELayer-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.TabularMoELayer.TabularMoELayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">TabularMoELayer</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">TabularMoELayer</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">num_experts</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">expert_units</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-6"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Mixture-of-Experts layer for tabular data.</p>
<p>This layer routes input features through multiple expert sub-networks and
aggregates their outputs via a learnable gating mechanism. Each expert is a small
MLP, and the gate learns to weight their contributions.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>num_experts</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of expert networks. Default is 4.</p>
            </div>
          </td>
          <td>
                <code>4</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>expert_units</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of hidden units in each expert network. Default is 16.</p>
            </div>
          </td>
          <td>
                <code>16</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>2D tensor with shape: <code>(batch_size, num_features)</code></p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>2D tensor with shape: <code>(batch_size, num_features)</code> (same as input)</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularMoELayer</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Tabular data with 8 features</span>
</span><span id="__span-0-5"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Create the layer with 4 experts and 16 units per expert</span>
</span><span id="__span-0-8"><span class="n">moe_layer</span> <span class="o">=</span> <span class="n">TabularMoELayer</span><span class="p">(</span><span class="n">num_experts</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">expert_units</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</span><span id="__span-0-9"><span class="n">y</span> <span class="o">=</span> <span class="n">moe_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-10"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MoE output shape:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Expected: (32, 8)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the TabularMoELayer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>num_experts</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of expert networks.</p>
            </div>
          </td>
          <td>
                <code>4</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>expert_units</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of units in each expert.</p>
            </div>
          </td>
          <td>
                <code>16</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="businessruleslayer">üèóÔ∏è BusinessRulesLayer</h3>
<p>Layer for integrating domain-specific business rules into model.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.BusinessRulesLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.BusinessRulesLayer</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a BusinessRulesLayer that allows applying configurable business rules
to neural network outputs. This enables combining learned patterns with explicit domain knowledge.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.BusinessRulesLayer-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.BusinessRulesLayer.BusinessRulesLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">BusinessRulesLayer</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">BusinessRulesLayer</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Rule</span><span class="p">],</span>
</span><span id="__span-0-3">    <span class="n">feature_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">trainable_weights</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">weight_initializer</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-0-6">    <span class="o">|</span> <span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="s2">&quot;ones&quot;</span><span class="p">,</span>
</span><span id="__span-0-7">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-8">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-9"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Evaluates business-defined rules for anomaly detection.</p>
<p>This layer applies user-defined business rules to detect anomalies. Rules can be
defined for both numerical and categorical features.</p>

<details class="for-numerical-features" open>
  <summary>For numerical features</summary>
  <ul>
<li>Comparison operators: '&gt;' and '&lt;'</li>
<li>Example: [("&gt;", 0), ("&lt;", 100)] for range validation</li>
</ul>
</details>
<details class="for-categorical-features" open>
  <summary>For categorical features</summary>
  <ul>
<li>Set operators: '==', 'in', '!=', 'not in'</li>
<li>Example: [("in", ["red", "green", "blue"])] for valid categories</li>
</ul>
</details>


  <p><span class="doc-section-title">Attributes:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code><span title="kerasfactory.layers.BusinessRulesLayer.BusinessRulesLayer.rules">rules</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of rule tuples (operator, value).</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="kerasfactory.layers.BusinessRulesLayer.BusinessRulesLayer.feature_type">feature_type</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of feature ('numerical' or 'categorical').</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="c1"># Numerical rules</span>
</span><span id="__span-0-2"><span class="n">layer</span> <span class="o">=</span> <span class="n">BusinessRulesLayer</span><span class="p">(</span><span class="n">rules</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)],</span> <span class="n">feature_type</span><span class="o">=</span><span class="s2">&quot;numerical&quot;</span><span class="p">)</span>
</span><span id="__span-0-3"><span class="n">outputs</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([[</span><span class="mf">50.0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">10.0</span><span class="p">]]))</span>
</span><span id="__span-0-4"><span class="nb">print</span><span class="p">(</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;business_anomaly&#39;</span><span class="p">])</span>  <span class="c1"># [[False], [True]]</span>
</span><span id="__span-0-5">
</span><span id="__span-0-6"><span class="c1"># Categorical rules</span>
</span><span id="__span-0-7"><span class="n">layer</span> <span class="o">=</span> <span class="n">BusinessRulesLayer</span><span class="p">(</span>
</span><span id="__span-0-8">    <span class="n">rules</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;in&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">])],</span>
</span><span id="__span-0-9">    <span class="n">feature_type</span><span class="o">=</span><span class="s2">&quot;categorical&quot;</span>
</span><span id="__span-0-10"><span class="p">)</span>
</span><span id="__span-0-11"><span class="n">outputs</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([[</span><span class="s2">&quot;red&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;blue&quot;</span><span class="p">]]))</span>
</span><span id="__span-0-12"><span class="nb">print</span><span class="p">(</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;business_anomaly&#39;</span><span class="p">])</span>  <span class="c1"># [[False], [True]]</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initializes the layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>rules</code></td>
          <td>
                <code>list[<span title="kerasfactory.layers.BusinessRulesLayer.Rule">Rule</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of rule tuples (operator, value).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>feature_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of feature ('numerical' or 'categorical').</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>trainable_weights</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to use trainable weights for soft rule enforcement.
Default is True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>weight_initializer</code></td>
          <td>
                <code>str | <span title="keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initializer for rule weights. Default is 'ones'.</p>
            </div>
          </td>
          <td>
                <code>&#39;ones&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional layer arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Raises:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If feature_type is invalid or rules have invalid operators.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">







<h6 id="kerasfactory.layers.BusinessRulesLayer.BusinessRulesLayer-functions">Functions</h6>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.BusinessRulesLayer.BusinessRulesLayer.compute_output_shape" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_output_shape</span>


</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">compute_output_shape</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">input_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
</span><span id="__span-0-3"><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Compute the output shape of the layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_shape</code></td>
          <td>
                <code>tuple[int | None, int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input shape tuple.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>dict[str, tuple[int | None, int]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary mapping output names to their shapes.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h2 id="regularization-robustness">üõ°Ô∏è Regularization &amp; Robustness</h2>
<h3 id="stochasticdepth">üé≤ StochasticDepth</h3>
<p>Stochastic depth regularization for improved generalization.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.StochasticDepth" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.StochasticDepth</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Stochastic depth layer for neural networks.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.StochasticDepth-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.StochasticDepth.StochasticDepth" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">StochasticDepth</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">StochasticDepth</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">survival_prob</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</span><span id="__span-0-5"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Stochastic depth layer for regularization.</p>
<p>This layer randomly drops entire residual branches with a specified probability
during training. During inference, all branches are kept and scaled appropriately.
This technique helps reduce overfitting and training time in deep networks.</p>

<details class="reference" open>
  <summary>Reference</summary>
  <ul>
<li><a href="https://arxiv.org/abs/1603.09382">Deep Networks with Stochastic Depth</a></li>
</ul>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">from</span><span class="w"> </span><span class="nn">keras</span><span class="w"> </span><span class="kn">import</span> <span class="n">random</span><span class="p">,</span> <span class="n">layers</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">StochasticDepth</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create sample residual branch</span>
</span><span id="__span-0-5"><span class="n">inputs</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
</span><span id="__span-0-6"><span class="n">residual</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="__span-0-7"><span class="n">residual</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">residual</span><span class="p">)</span>
</span><span id="__span-0-8"><span class="n">residual</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()(</span><span class="n">residual</span><span class="p">)</span>
</span><span id="__span-0-9">
</span><span id="__span-0-10"><span class="c1"># Apply stochastic depth</span>
</span><span id="__span-0-11"><span class="n">outputs</span> <span class="o">=</span> <span class="n">StochasticDepth</span><span class="p">(</span><span class="n">survival_prob</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)([</span><span class="n">inputs</span><span class="p">,</span> <span class="n">residual</span><span class="p">])</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize stochastic depth.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>survival_prob</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Probability of keeping the residual branch (default: 0.5)</p>
            </div>
          </td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>seed</code></td>
          <td>
                <code>int | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Random seed for reproducibility</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code>dict[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional layer arguments</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Raises:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If survival_prob is not in [0, 1]</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">







<h6 id="kerasfactory.layers.StochasticDepth.StochasticDepth-functions">Functions</h6>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.StochasticDepth.StochasticDepth.compute_output_shape" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_output_shape</span>


</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">compute_output_shape</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">input_shape</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span>
</span><span id="__span-0-3"><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Compute output shape.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_shape</code></td>
          <td>
                <code>list[tuple[int, ...]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of input shape tuples</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>tuple[int, ...]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Output shape tuple</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.StochasticDepth.StochasticDepth.from_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">from_config</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">from_config</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">StochasticDepth</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Create layer from configuration.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>config</code></td>
          <td>
                <code>dict[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Layer configuration dictionary</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code><a class="autorefs autorefs-internal" title="kerasfactory.layers.StochasticDepth.StochasticDepth" href="#kerasfactory.layers.StochasticDepth.StochasticDepth">StochasticDepth</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>StochasticDepth instance</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="featurecutout">üóëÔ∏è FeatureCutout</h3>
<p>Feature cutout regularization for dropout-like effects on features.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.FeatureCutout" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.FeatureCutout</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>Feature cutout regularization layer for neural networks.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.FeatureCutout-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.FeatureCutout.FeatureCutout" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">FeatureCutout</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">FeatureCutout</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">cutout_prob</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">noise_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</span><span id="__span-0-6"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Feature cutout regularization layer.</p>
<p>This layer randomly masks out (sets to zero) a specified fraction of features
during training to improve model robustness and prevent overfitting. During
inference, all features are kept intact.</p>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">from</span><span class="w"> </span><span class="nn">keras</span><span class="w"> </span><span class="kn">import</span> <span class="n">random</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureCutout</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create sample data</span>
</span><span id="__span-0-5"><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>
</span><span id="__span-0-6"><span class="n">feature_dim</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-0-7"><span class="n">inputs</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">feature_dim</span><span class="p">))</span>
</span><span id="__span-0-8">
</span><span id="__span-0-9"><span class="c1"># Apply feature cutout</span>
</span><span id="__span-0-10"><span class="n">cutout</span> <span class="o">=</span> <span class="n">FeatureCutout</span><span class="p">(</span><span class="n">cutout_prob</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</span><span id="__span-0-11"><span class="n">masked_outputs</span> <span class="o">=</span> <span class="n">cutout</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize feature cutout.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>cutout_prob</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Probability of masking each feature</p>
            </div>
          </td>
          <td>
                <code>0.1</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>noise_value</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Value to use for masked features (default: 0.0)</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>seed</code></td>
          <td>
                <code>int | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Random seed for reproducibility</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code>dict[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional layer arguments</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Raises:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If cutout_prob is not in [0, 1]</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">







<h6 id="kerasfactory.layers.FeatureCutout.FeatureCutout-functions">Functions</h6>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.FeatureCutout.FeatureCutout.compute_output_shape" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_output_shape</span>


</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">compute_output_shape</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">input_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="__span-0-3"><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Compute output shape.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_shape</code></td>
          <td>
                <code>tuple[int, ...]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input shape tuple</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>tuple[int, ...]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Output shape tuple</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.FeatureCutout.FeatureCutout.from_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">from_config</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">from_config</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">FeatureCutout</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Create layer from configuration.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>config</code></td>
          <td>
                <code>dict[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Layer configuration dictionary</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code><a class="autorefs autorefs-internal" title="kerasfactory.layers.FeatureCutout.FeatureCutout" href="#kerasfactory.layers.FeatureCutout.FeatureCutout">FeatureCutout</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>FeatureCutout instance</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="sparseattentionweighting">üéØ SparseAttentionWeighting</h3>
<p>Sparse attention weighting for computational efficiency.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.SparseAttentionWeighting" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.SparseAttentionWeighting</span>


</h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.SparseAttentionWeighting-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.SparseAttentionWeighting.SparseAttentionWeighting" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">SparseAttentionWeighting</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">SparseAttentionWeighting</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">num_modules</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</span><span id="__span-0-5"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Sparse attention mechanism with temperature scaling for module outputs combination.</p>
<p>This layer implements a learnable attention mechanism that combines outputs from multiple
modules using temperature-scaled attention weights. The attention weights are learned
during training and can be made more or less sparse by adjusting the temperature parameter.
A higher temperature leads to more uniform weights, while a lower temperature makes the
weights more concentrated on specific modules.</p>
<p>Key features:
1. Learnable module importance weights
2. Temperature-controlled sparsity
3. Softmax-based attention mechanism
4. Support for variable number of input features per module</p>
<p>Example:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">keras</span><span class="w"> </span><span class="kn">import</span> <span class="n">layers</span><span class="p">,</span> <span class="n">Model</span>
</span><span id="__span-0-3"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">SparseAttentionWeighting</span>
</span><span id="__span-0-4">
</span><span id="__span-0-5"><span class="c1"># Create sample module outputs</span>
</span><span id="__span-0-6"><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>
</span><span id="__span-0-7"><span class="n">num_modules</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="__span-0-8"><span class="n">feature_dim</span> <span class="o">=</span> <span class="mi">64</span>
</span><span id="__span-0-9">
</span><span id="__span-0-10"><span class="c1"># Create three different module outputs</span>
</span><span id="__span-0-11"><span class="n">module1</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">feature_dim</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="__span-0-12"><span class="n">module2</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">feature_dim</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="__span-0-13"><span class="n">module3</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">feature_dim</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="__span-0-14">
</span><span id="__span-0-15"><span class="c1"># Combine module outputs using sparse attention</span>
</span><span id="__span-0-16"><span class="n">attention</span> <span class="o">=</span> <span class="n">SparseAttentionWeighting</span><span class="p">(</span>
</span><span id="__span-0-17">    <span class="n">num_modules</span><span class="o">=</span><span class="n">num_modules</span><span class="p">,</span>
</span><span id="__span-0-18">    <span class="n">temperature</span><span class="o">=</span><span class="mf">0.5</span>  <span class="c1"># Lower temperature for sharper attention</span>
</span><span id="__span-0-19"><span class="p">)</span>
</span><span id="__span-0-20"><span class="n">combined_output</span> <span class="o">=</span> <span class="n">attention</span><span class="p">([</span><span class="n">module1</span><span class="p">,</span> <span class="n">module2</span><span class="p">,</span> <span class="n">module3</span><span class="p">])</span>
</span><span id="__span-0-21">
</span><span id="__span-0-22"><span class="c1"># The layer will learn which modules are most important</span>
</span><span id="__span-0-23"><span class="c1"># and weight their outputs accordingly</span>
</span></code></pre></div></td></tr></table></div></p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>num_modules</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of input modules whose outputs will be combined.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>temperature</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Temperature parameter for softmax scaling. Default is 1.0.
- temperature &gt; 1.0: More uniform attention weights
- temperature &lt; 1.0: More sparse attention weights
- temperature = 1.0: Standard softmax behavior</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
    </tbody>
  </table>
  
      <p>Initialize sparse attention weighting layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>num_modules</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of input modules to weight. Must be positive.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>temperature</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Temperature parameter for softmax scaling. Must be positive.
Controls the sparsity of attention weights:
- Higher values (&gt;1.0) lead to more uniform weights
- Lower values (&lt;1.0) lead to more concentrated weights</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code>dict[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional layer arguments passed to the parent Layer class.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Raises:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If num_modules &lt;= 0 or temperature &lt;= 0</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">







<h6 id="kerasfactory.layers.SparseAttentionWeighting.SparseAttentionWeighting-functions">Functions</h6>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.SparseAttentionWeighting.SparseAttentionWeighting.from_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">from_config</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">from_config</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</span><span id="__span-0-3"><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparseAttentionWeighting</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Create layer from configuration.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>config</code></td>
          <td>
                <code>dict[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Layer configuration dictionary</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code><a class="autorefs autorefs-internal" title="kerasfactory.layers.SparseAttentionWeighting.SparseAttentionWeighting" href="#kerasfactory.layers.SparseAttentionWeighting.SparseAttentionWeighting">SparseAttentionWeighting</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>SparseAttentionWeighting instance</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h2 id="specialized-processing">üîß Specialized Processing</h2>
<h3 id="slownetwork">üê¢ SlowNetwork</h3>
<p>Slow network layer for temporal smoothing and stability.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.SlowNetwork" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.SlowNetwork</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a SlowNetwork layer that processes features through multiple dense layers.
It's designed to be used as a component in more complex architectures.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.SlowNetwork-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.SlowNetwork.SlowNetwork" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">SlowNetwork</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">SlowNetwork</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">input_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">num_layers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">units</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-6">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-7"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>A multi-layer network with configurable depth and width.</p>
<p>This layer processes input features through multiple dense layers with ReLU activations,
and projects the output back to the original feature dimension.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of the input features.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>num_layers</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of hidden layers. Default is 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>units</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of units per hidden layer. Default is 128.</p>
            </div>
          </td>
          <td>
                <code>128</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input-shape" open>
  <summary>Input shape</summary>
  <p>2D tensor with shape: <code>(batch_size, input_dim)</code></p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>2D tensor with shape: <code>(batch_size, input_dim)</code> (same as input)</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">SlowNetwork</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create sample input data</span>
</span><span id="__span-0-5"><span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>  <span class="c1"># 32 samples, 16 features</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="c1"># Create the layer</span>
</span><span id="__span-0-8"><span class="n">slow_net</span> <span class="o">=</span> <span class="n">SlowNetwork</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</span><span id="__span-0-9"><span class="n">y</span> <span class="o">=</span> <span class="n">slow_net</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-10"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output shape:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32, 16)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the SlowNetwork layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input dimension.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>num_layers</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of hidden layers.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>units</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of units in each layer.</p>
            </div>
          </td>
          <td>
                <code>128</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="hyperzzwoperator">‚ö° HyperZZWOperator</h3>
<p>Specialized hyperparameter operator for advanced transformations.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.HyperZZWOperator" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.HyperZZWOperator</span>


</h3>

  <div class="doc doc-contents first">
  
      <p>This module implements a HyperZZWOperator layer that computes context-dependent weights
by multiplying inputs with hyper-kernels. This is a specialized layer for the Terminator model.</p>

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.HyperZZWOperator-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.HyperZZWOperator.HyperZZWOperator" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">HyperZZWOperator</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">HyperZZWOperator</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">input_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-3">    <span class="n">context_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="__span-0-6"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>A layer that computes context-dependent weights by multiplying inputs with hyper-kernels.</p>
<p>This layer takes two inputs: the original input tensor and a context tensor.
It generates hyper-kernels from the context and performs a context-dependent transformation
of the input.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of the input features.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>context_dim</code></td>
          <td>
                <code>int | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional dimension of the context features. If not provided, it will be inferred.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional name for the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="input" open>
  <summary>Input</summary>
  <p>A list of two tensors:
- inputs[0]: Input tensor with shape (batch_size, input_dim).
- inputs[1]: Context tensor with shape (batch_size, context_dim).</p>
</details>
<details class="output-shape" open>
  <summary>Output shape</summary>
  <p>2D tensor with shape: <code>(batch_size, input_dim)</code> (same as input)</p>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">HyperZZWOperator</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Create sample input data</span>
</span><span id="__span-0-5"><span class="n">inputs</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>  <span class="c1"># 32 samples, 16 features</span>
</span><span id="__span-0-6"><span class="n">context</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>  <span class="c1"># 32 samples, 8 context features</span>
</span><span id="__span-0-7">
</span><span id="__span-0-8"><span class="c1"># Create the layer</span>
</span><span id="__span-0-9"><span class="n">zzw_op</span> <span class="o">=</span> <span class="n">HyperZZWOperator</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">context_dim</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="__span-0-10"><span class="n">context_weights</span> <span class="o">=</span> <span class="n">zzw_op</span><span class="p">([</span><span class="n">inputs</span><span class="p">,</span> <span class="n">context</span><span class="p">])</span>
</span><span id="__span-0-11"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output shape:&quot;</span><span class="p">,</span> <span class="n">context_weights</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (32, 16)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the HyperZZWOperator.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input dimension.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>context_dim</code></td>
          <td>
                <code>int | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Context dimension.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the layer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h2 id="anomaly-detection">üö® Anomaly Detection</h2>
<h3 id="numericalanomalydetection">üìâ NumericalAnomalyDetection</h3>
<p>Detects anomalies in numerical features using statistical methods.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.NumericalAnomalyDetection" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.NumericalAnomalyDetection</span>


</h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.NumericalAnomalyDetection-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.NumericalAnomalyDetection.NumericalAnomalyDetection" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">NumericalAnomalyDetection</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">NumericalAnomalyDetection</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">hidden_dims</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
</span><span id="__span-0-3">    <span class="n">reconstruction_weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
</span><span id="__span-0-4">    <span class="n">distribution_weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
</span><span id="__span-0-5">    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</span><span id="__span-0-6"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Numerical anomaly detection layer for identifying outliers in numerical features.</p>
<p>This layer learns a distribution for each numerical feature and outputs an anomaly
score for each feature based on how far it deviates from the learned distribution.
The layer uses a combination of mean, variance, and autoencoder reconstruction error
to detect anomalies.</p>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
</span><span id="__span-0-2"><span class="kn">from</span><span class="w"> </span><span class="nn">kerasfactory.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumericalAnomalyDetection</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Suppose we have 5 numerical features</span>
</span><span id="__span-0-5"><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>  <span class="c1"># Batch of 32 samples</span>
</span><span id="__span-0-6"><span class="c1"># Create a NumericalAnomalyDetection layer</span>
</span><span id="__span-0-7"><span class="n">anomaly_layer</span> <span class="o">=</span> <span class="n">NumericalAnomalyDetection</span><span class="p">(</span>
</span><span id="__span-0-8">    <span class="n">hidden_dims</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
</span><span id="__span-0-9">    <span class="n">reconstruction_weight</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="__span-0-10">    <span class="n">distribution_weight</span><span class="o">=</span><span class="mf">0.5</span>
</span><span id="__span-0-11"><span class="p">)</span>
</span><span id="__span-0-12"><span class="n">anomaly_scores</span> <span class="o">=</span> <span class="n">anomaly_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-13"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Anomaly scores shape:&quot;</span><span class="p">,</span> <span class="n">anomaly_scores</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Expected: (32, 5)</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initialize the layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>hidden_dims</code></td>
          <td>
                <code>list[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of hidden dimensions for the autoencoder.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>reconstruction_weight</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Weight for reconstruction error in anomaly score.</p>
            </div>
          </td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>distribution_weight</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Weight for distribution-based error in anomaly score.</p>
            </div>
          </td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
                <code>dict[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">







<h6 id="kerasfactory.layers.NumericalAnomalyDetection.NumericalAnomalyDetection-functions">Functions</h6>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.NumericalAnomalyDetection.NumericalAnomalyDetection.compute_output_shape" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_output_shape</span>


</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">compute_output_shape</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">input_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="__span-0-3"><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Compute output shape.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_shape</code></td>
          <td>
                <code>tuple[int, ...]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input shape tuple.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>tuple[int, ...]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Output shape tuple.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h3 id="categoricalanomalydetectionlayer">üìä CategoricalAnomalyDetectionLayer</h3>
<p>Detects anomalies in categorical features.</p>


<div class="doc doc-object doc-module">



<h3 id="kerasfactory.layers.CategoricalAnomalyDetectionLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">kerasfactory.layers.CategoricalAnomalyDetectionLayer</span>


</h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">






<h4 id="kerasfactory.layers.CategoricalAnomalyDetectionLayer-classes">Classes</h4>

<div class="doc doc-object doc-class">



<h5 id="kerasfactory.layers.CategoricalAnomalyDetectionLayer.CategoricalAnomalyDetectionLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">CategoricalAnomalyDetectionLayer</span>


</h5>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">CategoricalAnomalyDetectionLayer</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="__span-0-3"><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">

  
      <p>Backend-agnostic anomaly detection for categorical features.</p>
<p>This layer detects anomalies in categorical features by checking if values belong to
a predefined set of valid categories. Values not in this set are considered anomalous.</p>
<p>The layer uses a Keras StringLookup or IntegerLookup layer internally to efficiently
map input values to indices, which are then used to determine if a value is valid.</p>



  <p><span class="doc-section-title">Attributes:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code><a class="autorefs autorefs-internal" title="kerasfactory.layers.CategoricalAnomalyDetectionLayer.CategoricalAnomalyDetectionLayer.dtype" href="#kerasfactory.layers.CategoricalAnomalyDetectionLayer.CategoricalAnomalyDetectionLayer.dtype">dtype</a></code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The data type of input values ('string' or 'int32').</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="kerasfactory.layers.CategoricalAnomalyDetectionLayer.CategoricalAnomalyDetectionLayer.lookup">lookup</span></code></td>
          <td>
                <code><span title="keras.layers.StringLookup">StringLookup</span> | <span title="keras.layers.IntegerLookup">IntegerLookup</span> | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A Keras lookup layer for mapping values to indices.</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="kerasfactory.layers.CategoricalAnomalyDetectionLayer.CategoricalAnomalyDetectionLayer.vocabulary">vocabulary</span></code></td>
          <td>
                <code><span title="keras.layers.StringLookup">StringLookup</span> | <span title="keras.layers.IntegerLookup">IntegerLookup</span> | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>list of valid categorical values.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="n">layer</span> <span class="o">=</span> <span class="n">CategoricalAnomalyDetectionLayer</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;string&#39;</span><span class="p">)</span>
</span><span id="__span-0-2"><span class="n">layer</span><span class="o">.</span><span class="n">initialize_from_stats</span><span class="p">(</span><span class="n">vocabulary</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">])</span>
</span><span id="__span-0-3"><span class="n">outputs</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([[</span><span class="s1">&#39;red&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;purple&#39;</span><span class="p">]]))</span>
</span><span id="__span-0-4"><span class="nb">print</span><span class="p">(</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;anomaly&#39;</span><span class="p">])</span>  <span class="c1"># [[False], [True]]</span>
</span></code></pre></div></td></tr></table></div>
</details>  
      <p>Initializes the layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>dtype</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Data type of input values ('string' or 'int32'). Defaults to 'string'.</p>
            </div>
          </td>
          <td>
                <code>&#39;string&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional layer arguments.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Raises:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If dtype is not 'string' or 'int32'.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">





<h6 id="kerasfactory.layers.CategoricalAnomalyDetectionLayer.CategoricalAnomalyDetectionLayer-attributes">Attributes</h6>

<div class="doc doc-object doc-attribute">



<h7 id="kerasfactory.layers.CategoricalAnomalyDetectionLayer.CategoricalAnomalyDetectionLayer.dtype" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">dtype</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="n">dtype</span><span class="p">:</span> <span class="n">Any</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Get the dtype of the layer.</p>
  </div>

</div>

<h6 id="kerasfactory.layers.CategoricalAnomalyDetectionLayer.CategoricalAnomalyDetectionLayer-functions">Functions</h6>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.CategoricalAnomalyDetectionLayer.CategoricalAnomalyDetectionLayer.set_dtype" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">set_dtype</span>


</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">set_dtype</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Set the dtype and initialize the appropriate lookup layer.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.CategoricalAnomalyDetectionLayer.CategoricalAnomalyDetectionLayer.initialize_from_stats" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">initialize_from_stats</span>


</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">initialize_from_stats</span><span class="p">(</span><span class="n">vocabulary</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Initializes the layer with a vocabulary of valid values.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>vocabulary</code></td>
          <td>
                <code>list[str | int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>list of valid categorical values.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.CategoricalAnomalyDetectionLayer.CategoricalAnomalyDetectionLayer.compute_output_shape" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_output_shape</span>


</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">compute_output_shape</span><span class="p">(</span>
</span><span id="__span-0-2">    <span class="n">input_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
</span><span id="__span-0-3"><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Compute the output shape of the layer.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>input_shape</code></td>
          <td>
                <code>tuple[int | None, int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input shape tuple.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>dict[str, tuple[int | None, int]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary mapping output names to their shapes.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h7 id="kerasfactory.layers.CategoricalAnomalyDetectionLayer.CategoricalAnomalyDetectionLayer.from_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">from_config</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="nf">from_config</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span>
</span></code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Create layer from configuration.</p>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div>












                
  
  

              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.path", "navigation.top", "navigation.instant", "navigation.tracking", "navigation.indexes", "search.highlight", "search.share", "search.suggest", "content.code.copy", "content.code.annotate", "content.code.select", "content.tabs.link", "content.action.edit", "content.action.view", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>