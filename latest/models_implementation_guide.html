
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://unicolab.github.io/KerasFactory/0.1.0/models_implementation_guide.html">
      
      
        <link rel="prev" href="layers_implementation_guide.html">
      
      
        <link rel="next" href="data_analyzer.html">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>Model Implementation Guide - KerasFactory</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.75 1.75 0 0 1 1 7.775m1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.5 1.75v11.5c0 .138.112.25.25.25h3.17a.75.75 0 0 1 0 1.5H2.75A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8.5C12.216 0 13 .784 13 1.75v7.736a.75.75 0 0 1-1.5 0V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25m13.274 9.537zl-4.557 4.45a.75.75 0 0 1-1.055-.008l-1.943-1.95a.75.75 0 0 1 1.062-1.058l1.419 1.425 4.026-3.932a.75.75 0 1 1 1.048 1.074M4.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5M4 7.75A.75.75 0 0 1 4.75 7h2a.75.75 0 0 1 0 1.5h-2A.75.75 0 0 1 4 7.75"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13M6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75M8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3.499.75a.75.75 0 0 1 1.5 0v.996C5.9 2.903 6.793 3.65 7.662 4.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873 10.794-.045 12.622.26 14.408.558 16 1.94 16 4.25c0 1.278-.954 2.575-2.44 2.734l.146.508.065.22c.203.701.412 1.455.476 2.226.142 1.707-.4 3.03-1.487 3.898C11.714 14.671 10.27 15 8.75 15h-6a.75.75 0 0 1 0-1.5h1.376a4.5 4.5 0 0 1-.563-1.191 3.84 3.84 0 0 1-.05-2.063 4.65 4.65 0 0 1-2.025-.293.75.75 0 0 1 .525-1.406c1.357.507 2.376-.006 2.698-.318l.009-.01a.747.747 0 0 1 1.06 0 .75.75 0 0 1-.012 1.074c-.912.92-.992 1.835-.768 2.586.221.74.745 1.337 1.196 1.621H8.75c1.343 0 2.398-.296 3.074-.836.635-.507 1.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.4 2.4 0 0 1-.507-.441 3.1 3.1 0 0 1-.633-1.248.75.75 0 0 1 1.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738 0 1.25-.615 1.25-1.25 0-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706 1.345-.46.92-.27 1.774.019 3.062l.042.19.01.05c.348.443.666.949.94 1.553a.75.75 0 1 1-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7 5.527c-.814-.68-1.75-1.462-2.692-2.619a3.7 3.7 0 0 0-1.023.88c-.406.495-.663 1.036-.722 1.508.116.122.306.21.591.239.388.038.797-.06 1.032-.19a.75.75 0 0 1 .728 1.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75 5.677V5.5c0-.984.48-1.94 1.077-2.664.46-.559 1.05-1.055 1.673-1.353z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.75.75 0 0 1 .018-1.042.75.75 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13M6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.76 2.76 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6 6 0 0 0-.26.16 1 1 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661q.154-.1.313-.195l.007-.004c.1-.061.182-.11.258-.161a1 1 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.61.61 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1 1 0 0 0-.34.398M9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0M9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.344 2.343za8 8 0 0 1 11.314 11.314A8.002 8.002 0 0 1 .234 10.089a8 8 0 0 1 2.11-7.746m1.06 10.253a6.5 6.5 0 1 0 9.108-9.275 6.5 6.5 0 0 0-9.108 9.275M6.03 4.97 8 6.94l1.97-1.97a.749.749 0 0 1 1.275.326.75.75 0 0 1-.215.734L9.06 8l1.97 1.97a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215L8 9.06l-1.97 1.97a.749.749 0 0 1-1.275-.326.75.75 0 0 1 .215-.734L6.94 8 4.97 6.03a.75.75 0 0 1 .018-1.042.75.75 0 0 1 1.042-.018"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M9.504.43a1.516 1.516 0 0 1 2.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.25 1.25 0 0 1-.871.354h-.302a1.25 1.25 0 0 1-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004zm1.047 1.074L3.286 8.571A.25.25 0 0 0 3.462 9H6.75a.75.75 0 0 1 .694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0 0 12.538 7H9.25a.75.75 0 0 1-.683-1.06l2.008-4.418.003-.006-.004-.009-.006-.006-.008-.001q-.005 0-.009.004"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4.72.22a.75.75 0 0 1 1.06 0l1 .999a3.5 3.5 0 0 1 2.441 0l.999-1a.748.748 0 0 1 1.265.332.75.75 0 0 1-.205.729l-.775.776c.616.63.995 1.493.995 2.444v.327q0 .15-.025.292c.408.14.764.392 1.029.722l1.968-.787a.75.75 0 0 1 .556 1.392L13 7.258V9h2.25a.75.75 0 0 1 0 1.5H13v.5q-.002.615-.141 1.186l2.17.868a.75.75 0 0 1-.557 1.392l-2.184-.873A5 5 0 0 1 8 16a5 5 0 0 1-4.288-2.427l-2.183.873a.75.75 0 0 1-.558-1.392l2.17-.868A5 5 0 0 1 3 11v-.5H.75a.75.75 0 0 1 0-1.5H3V7.258L.971 6.446a.75.75 0 0 1 .558-1.392l1.967.787c.265-.33.62-.583 1.03-.722a1.7 1.7 0 0 1-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72 1.28a.75.75 0 0 1 0-1.06m.53 6.28a.75.75 0 0 0-.75.75V11a3.5 3.5 0 1 0 7 0V7.25a.75.75 0 0 0-.75-.75ZM6.173 5h3.654A.17.17 0 0 0 10 4.827V4.5a2 2 0 1 0-4 0v.327c0 .096.077.173.173.173"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.75.75 0 0 1 9.5 6Z"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.75 2.5h10.5a.75.75 0 0 1 0 1.5H1.75a.75.75 0 0 1 0-1.5m4 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5m0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5M2.5 7.75v6a.75.75 0 0 1-1.5 0v-6a.75.75 0 0 1 1.5 0"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="KerasFactory" class="md-header__button md-logo" aria-label="KerasFactory" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 11a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1M4.22 4.22C5.65 2.79 8.75 3.43 12 5.56c3.25-2.13 6.35-2.77 7.78-1.34s.79 4.53-1.34 7.78c2.13 3.25 2.77 6.35 1.34 7.78s-4.53.79-7.78-1.34c-3.25 2.13-6.35 2.77-7.78 1.34S3.43 15.25 5.56 12C3.43 8.75 2.79 5.65 4.22 4.22m11.32 4.24c.61.62 1.17 1.25 1.69 1.88 1.38-2.13 1.88-3.96 1.13-4.7-.74-.75-2.57-.25-4.7 1.13.63.52 1.26 1.08 1.88 1.69m-7.08 7.08c-.61-.62-1.17-1.25-1.69-1.88-1.38 2.13-1.88 3.96-1.13 4.7.74.75 2.57.25 4.7-1.13-.63-.52-1.26-1.08-1.88-1.69m-2.82-9.9c-.75.74-.25 2.57 1.13 4.7.52-.63 1.08-1.26 1.69-1.88.62-.61 1.25-1.17 1.88-1.69-2.13-1.38-3.96-1.88-4.7-1.13m4.24 8.48c.7.7 1.42 1.34 2.12 1.91.7-.57 1.42-1.21 2.12-1.91s1.34-1.42 1.91-2.12c-.57-.7-1.21-1.42-1.91-2.12S12.7 8.54 12 7.97c-.7.57-1.42 1.21-2.12 1.91S8.54 11.3 7.97 12c.57.7 1.21 1.42 1.91 2.12m8.48 4.24c.75-.74.25-2.57-1.13-4.7-.52.63-1.08 1.26-1.69 1.88-.62.61-1.25 1.17-1.88 1.69 2.13 1.38 3.96 1.88 4.7 1.13"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            KerasFactory
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Model Implementation Guide
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="pink"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/UnicoLab/KerasFactory" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    KerasFactory
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="index.html" class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="getting-started/quickstart.html" class="md-tabs__link">
          
  
    
  
  üöÄ Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="layers_overview.html" class="md-tabs__link">
          
  
    
  
  üß© Layers

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="tutorials/basic-workflows.html" class="md-tabs__link">
          
  
    
  
  üìö Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="examples/index.html" class="md-tabs__link">
          
  
    
  
  üìñ Examples

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="api/layers.html" class="md-tabs__link">
          
  
    
  
  üìë API Reference

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="contributing.html" class="md-tabs__link">
          
  
    
  
  ü§ù Contributing

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="KerasFactory" class="md-nav__button md-logo" aria-label="KerasFactory" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 11a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1M4.22 4.22C5.65 2.79 8.75 3.43 12 5.56c3.25-2.13 6.35-2.77 7.78-1.34s.79 4.53-1.34 7.78c2.13 3.25 2.77 6.35 1.34 7.78s-4.53.79-7.78-1.34c-3.25 2.13-6.35 2.77-7.78 1.34S3.43 15.25 5.56 12C3.43 8.75 2.79 5.65 4.22 4.22m11.32 4.24c.61.62 1.17 1.25 1.69 1.88 1.38-2.13 1.88-3.96 1.13-4.7-.74-.75-2.57-.25-4.7 1.13.63.52 1.26 1.08 1.88 1.69m-7.08 7.08c-.61-.62-1.17-1.25-1.69-1.88-1.38 2.13-1.88 3.96-1.13 4.7.74.75 2.57.25 4.7-1.13-.63-.52-1.26-1.08-1.88-1.69m-2.82-9.9c-.75.74-.25 2.57 1.13 4.7.52-.63 1.08-1.26 1.69-1.88.62-.61 1.25-1.17 1.88-1.69-2.13-1.38-3.96-1.88-4.7-1.13m4.24 8.48c.7.7 1.42 1.34 2.12 1.91.7-.57 1.42-1.21 2.12-1.91s1.34-1.42 1.91-2.12c-.57-.7-1.21-1.42-1.91-2.12S12.7 8.54 12 7.97c-.7.57-1.42 1.21-2.12 1.91S8.54 11.3 7.97 12c.57.7 1.21 1.42 1.91 2.12m8.48 4.24c.75-.74.25-2.57-1.13-4.7-.52.63-1.08 1.26-1.69 1.88-.62.61-1.25 1.17-1.88 1.69 2.13 1.38 3.96 1.88 4.7 1.13"/></svg>

    </a>
    KerasFactory
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/UnicoLab/KerasFactory" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    KerasFactory
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üöÄ Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            üöÄ Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="getting-started/quickstart.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick Start
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="getting-started/installation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="getting-started/concepts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Core Concepts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üß© Layers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            üß© Layers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers_overview.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Layer Overview & Explorer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üß† Attention
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            üß† Attention
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/tabular-attention.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TabularAttention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/multi-resolution-tabular-attention.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MultiResolutionTabularAttention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/column-attention.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ColumnAttention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/row-attention.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RowAttention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/interpretable-multi-head-attention.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    InterpretableMultiHeadAttention
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üîß Preprocessing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            üîß Preprocessing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/differentiable-tabular-preprocessor.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DifferentiableTabularPreprocessor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/differential-preprocessing-layer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DifferentialPreprocessingLayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/date-parsing-layer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DateParsingLayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/date-encoding-layer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DateEncodingLayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/season-layer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SeasonLayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/cast-to-float32-layer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CastToFloat32Layer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ‚öôÔ∏è Feature Engineering
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            ‚öôÔ∏è Feature Engineering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/variable-selection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VariableSelection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/gated-feature-selection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GatedFeatureSelection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/gated-feature-fusion.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GatedFeatureFusion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/advanced-numerical-embedding.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AdvancedNumericalEmbedding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/distribution-aware-encoder.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DistributionAwareEncoder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/distribution-transform-layer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DistributionTransformLayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/sparse-attention-weighting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SparseAttentionWeighting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/feature-cutout.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FeatureCutout
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üèóÔ∏è Specialized
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            üèóÔ∏è Specialized
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/gated-residual-network.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GatedResidualNetwork
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/gated-linear-unit.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GatedLinearUnit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/transformer-block.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TransformerBlock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/tabular-moe-layer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TabularMoELayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/boosting-block.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BoostingBlock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/boosting-ensemble-layer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BoostingEnsembleLayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/business-rules-layer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BusinessRulesLayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/stochastic-depth.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StochasticDepth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/slow-network.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SlowNetwork
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/hyper-zzw-operator.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HyperZZWOperator
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üõ†Ô∏è Utility
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            üõ†Ô∏è Utility
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/advanced-graph-feature.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AdvancedGraphFeature
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/graph-feature-aggregation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GraphFeatureAggregation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/multi-head-graph-feature-preprocessor.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MultiHeadGraphFeaturePreprocessor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/numerical-anomaly-detection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NumericalAnomalyDetection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/categorical-anomaly-detection-layer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CategoricalAnomalyDetectionLayer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ‚è∞ Time Series
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            ‚è∞ Time Series
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/moving-average.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MovingAverage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/series-decomposition.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SeriesDecomposition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/dft-series-decomposition.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFTSeriesDecomposition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/reversible-instance-norm.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReversibleInstanceNorm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/reversible-instance-norm-multivariate.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReversibleInstanceNormMultivariate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/positional-embedding.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PositionalEmbedding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/fixed-embedding.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FixedEmbedding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/token-embedding.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TokenEmbedding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/temporal-embedding.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TemporalEmbedding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/data-embedding-without-position.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DataEmbeddingWithoutPosition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/temporal-mixing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TemporalMixing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/feature-mixing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FeatureMixing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/mixing-layer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MixingLayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/multi-scale-season-mixing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MultiScaleSeasonMixing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/multi-scale-trend-mixing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MultiScaleTrendMixing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers/past-decomposable-mixing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PastDecomposableMixing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üìö Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            üìö Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tutorials/basic-workflows.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Workflows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tutorials/feature-engineering.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feature Engineering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tutorials/model-building.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Building
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="examples/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    üìñ Examples
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            üìñ Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="examples/rich_docstrings_showcase.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rich Docstrings Showcase
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="examples/feed_forward_guide.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BaseFeedForwardModel Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="examples/kdp_integration_guide.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    KDP Integration Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="examples/data_analyzer_examples.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Analyzer Examples
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üìë API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            üìë API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api/layers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Layers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api/models.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="models/tsmixer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TSMixer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="models/timemixer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TimeMixer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="models/base-feed-forward-model.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BaseFeedForwardModel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="models/sfne-block.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SFNEBlock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="models/terminator-model.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TerminatorModel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="models/autoencoder.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Autoencoder
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api/metrics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api/utils.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    ü§ù Contributing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            ü§ù Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="contributing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="layers_implementation_guide.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Layer Implementation Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
      <a href="models_implementation_guide.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Model Implementation Guide
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="data_analyzer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Analyzer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  
  
  
                  

  
    <a href="https://github.com/UnicoLab/KerasFactory/edit/master/docs/models_implementation_guide.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/UnicoLab/KerasFactory/raw/master/docs/models_implementation_guide.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


  <h1>Model Implementation Guide</h1>

<p>[38;5;243m   1[0m [38;5;249m# ü§ñ Model Implementation Guide for KerasFactory[0m
[38;5;243m   2[0m 
[38;5;243m   3[0m [38;5;249mThis guide outlines the complete process and best practices for implementing new models in the KerasFactory project. Follow the checklists to ensure your implementation meets all KerasFactory standards.[0m
[38;5;243m   4[0m 
[38;5;243m   5[0m [38;5;249m## üìã Model Implementation Checklist[0m
[38;5;243m   6[0m 
[38;5;243m   7[0m [38;5;249mUse this checklist when implementing a new model. Check off each item as you complete it.[0m
[38;5;243m   8[0m 
[38;5;243m   9[0m [38;5;249m### Phase 1: Planning &amp; Design[0m
[38;5;243m  10[0m [38;5;249m- [ ] <strong>Define Purpose</strong>: Clearly document what the model does and when to use it[0m
[38;5;243m  11[0m [38;5;249m- [ ] <strong>Review Architecture</strong>: Design the model architecture (layers, connections, data flow)[0m
[38;5;243m  12[0m [38;5;249m- [ ] <strong>Plan Layers</strong>: Identify which layers the model needs[0m
[38;5;243m  13[0m [38;5;249m  - [ ] Check if all required layers exist in <code>kerasfactory/layers/</code>[0m
[38;5;243m  14[0m [38;5;249m  - [ ] Plan to implement missing layers separately first[0m
[38;5;243m  15[0m [38;5;249m  - [ ] Prioritize reusability (create standalone layers, not embedded logic)[0m
[38;5;243m  16[0m [38;5;249m- [ ] <strong>Define Inputs/Outputs</strong>: Plan input and output specifications[0m
[38;5;243m  17[0m [38;5;249m- [ ] <strong>Document Algorithm</strong>: Write mathematical description or pseudo-code[0m
[38;5;243m  18[0m 
[38;5;243m  19[0m [38;5;249m### Phase 2: Layer Implementation (if needed)[0m
[38;5;243m  20[0m [38;5;249m<strong>IMPORTANT</strong>: Implement any missing layers FIRST as standalone, reusable components.[0m
[38;5;243m  21[0m 
[38;5;243m  22[0m [38;5;249mFor each missing layer:[0m
[38;5;243m  23[0m [38;5;249m- [ ] Follow the <strong>Layer Implementation Checklist</strong> from <code>layers_implementation_guide.md</code>[0m
[38;5;243m  24[0m [38;5;249m- [ ] Implement layer code[0m
[38;5;243m  25[0m [38;5;249m- [ ] Write comprehensive tests[0m
[38;5;243m  26[0m [38;5;249m- [ ] Create documentation[0m
[38;5;243m  27[0m [38;5;249m- [ ] Update API references[0m
[38;5;243m  28[0m [38;5;249m- [ ] Run all tests and linting[0m
[38;5;243m  29[0m 
[38;5;243m  30[0m [38;5;249m### Phase 3: Implementation - Core Model Code[0m
[38;5;243m  31[0m [38;5;249m- [ ] <strong>Create File</strong>: Create <code>kerasfactory/models/YourModelName.py</code> following naming conventions[0m
[38;5;243m  32[0m [38;5;249m- [ ] <strong>Add Module Docstring</strong>: Document the module's purpose[0m
[38;5;243m  33[0m [38;5;249m- [ ] <strong>Implement Pure Keras 3</strong>: Use only Keras operations (no TensorFlow)[0m
[38;5;243m  34[0m [38;5;249m- [ ] <strong>Apply @register_keras_serializable</strong>: Decorate class with <code>@register_keras_serializable(package="kerasfactory.models")</code>[0m
[38;5;243m  35[0m [38;5;249m- [ ] <strong>Inherit from BaseModel</strong>: Extend <code>kerasfactory.models._base.BaseModel</code>[0m
[38;5;243m  36[0m [38;5;249m- [ ] <strong>Implement <strong>init</strong></strong>: [0m
[38;5;243m  37[0m [38;5;249m  - [ ] Set private attributes first (<code>self._param = param</code>)[0m
[38;5;243m  38[0m [38;5;249m  - [ ] Validate parameters (in <strong>init</strong> or _validate_params)[0m
[38;5;243m  39[0m [38;5;249m  - [ ] Set public attributes (<code>self.param = self._param</code>)[0m
[38;5;243m  40[0m [38;5;249m  - [ ] Call <code>super().__init__(name=name, **kwargs)</code> AFTER setting public attributes[0m
[38;5;243m  41[0m [38;5;249m- [ ] <strong>Implement _validate_params</strong>: Add parameter validation logic[0m
[38;5;243m  42[0m [38;5;249m- [ ] <strong>Implement build()</strong>: Initialize all layers and sublayers[0m
[38;5;243m  43[0m [38;5;249m- [ ] <strong>Implement call()</strong>: Implement forward pass with Keras operations only[0m
[38;5;243m  44[0m [38;5;249m- [ ] <strong>Implement get_config()</strong>: Return all constructor parameters[0m
[38;5;243m  45[0m [38;5;249m- [ ] <strong>Add Type Hints</strong>: All methods and parameters have proper type annotations[0m
[38;5;243m  46[0m [38;5;249m- [ ] <strong>Add Logging</strong>: Use <code>loguru</code> for debug messages[0m
[38;5;243m  47[0m [38;5;249m- [ ] <strong>Add Comprehensive Docstring</strong>: Google-style docstring with:[0m
[38;5;243m  48[0m [38;5;249m  - [ ] Description[0m
[38;5;243m  49[0m [38;5;249m  - [ ] Parameters[0m
[38;5;243m  50[0m [38;5;249m  - [ ] Input/output shapes[0m
[38;5;243m  51[0m [38;5;249m  - [ ] Usage examples[0m
[38;5;243m  52[0m [38;5;249m  - [ ] References (if applicable)[0m
[38;5;243m  53[0m 
[38;5;243m  54[0m [38;5;249m### Phase 4: Unit Tests[0m
[38;5;243m  55[0m [38;5;249m- [ ] <strong>Create Test File</strong>: Create <code>tests/models/test__YourModelName.py</code>[0m
[38;5;243m  56[0m [38;5;249m- [ ] <strong>Test Initialization</strong>: [0m
[38;5;243m  57[0m [38;5;249m  - [ ] Default parameters[0m
[38;5;243m  58[0m [38;5;249m  - [ ] Custom parameters[0m
[38;5;243m  59[0m [38;5;249m  - [ ] Invalid parameters (should raise errors)[0m
[38;5;243m  60[0m [38;5;249m- [ ] <strong>Test Model Building</strong>: Build with different input shapes[0m
[38;5;243m  61[0m [38;5;249m- [ ] <strong>Test Output Shape</strong>: Verify output shapes match expected values[0m
[38;5;243m  62[0m [38;5;249m- [ ] <strong>Test Output Type</strong>: Verify output is correct dtype[0m
[38;5;243m  63[0m [38;5;249m- [ ] <strong>Test Different Batch Sizes</strong>: Test with various batch dimensions[0m
[38;5;243m  64[0m [38;5;249m- [ ] <strong>Test Forward Pass</strong>: Model produces valid outputs[0m
[38;5;243m  65[0m [38;5;249m- [ ] <strong>Test Training Loop</strong>:[0m
[38;5;243m  66[0m [38;5;249m  - [ ] Can compile the model[0m
[38;5;243m  67[0m [38;5;249m  - [ ] Can train for multiple epochs[0m
[38;5;243m  68[0m [38;5;249m  - [ ] Loss decreases over training[0m
[38;5;243m  69[0m [38;5;249m- [ ] <strong>Test Serialization</strong>:[0m
[38;5;243m  70[0m [38;5;249m  - [ ] <code>get_config()</code> returns correct dict[0m
[38;5;243m  71[0m [38;5;249m  - [ ] <code>from_config()</code> recreates model correctly[0m
[38;5;243m  72[0m [38;5;249m  - [ ] <code>keras.saving.serialize_keras_object()</code> works[0m
[38;5;243m  73[0m [38;5;249m  - [ ] <code>keras.saving.deserialize_keras_object()</code> works[0m
[38;5;243m  74[0m [38;5;249m  - [ ] Model can be saved/loaded (<code>.keras</code> format)[0m
[38;5;243m  75[0m [38;5;249m  - [ ] Weights can be saved/loaded (<code>.h5</code> format)[0m
[38;5;243m  76[0m [38;5;249m  - [ ] Predictions consistent after loading[0m
[38;5;243m  77[0m [38;5;249m- [ ] <strong>Test Deterministic Output</strong>: Same input produces same output (with same seed)[0m
[38;5;243m  78[0m [38;5;249m- [ ] <strong>Test Layer Integration</strong>: All constituent layers work correctly together[0m
[38;5;243m  79[0m [38;5;249m- [ ] <strong>Test Prediction</strong>: Model can make predictions on new data[0m
[38;5;243m  80[0m [38;5;249m- [ ] <strong>All Tests Pass</strong>: Run <code>pytest tests/models/test__YourModelName.py -v</code>[0m
[38;5;243m  81[0m 
[38;5;243m  82[0m [38;5;249m### Phase 5: Documentation[0m
[38;5;243m  83[0m [38;5;249m- [ ] <strong>Create Documentation File</strong>: Create <code>docs/models/your-model-name.md</code>[0m
[38;5;243m  84[0m [38;5;249m- [ ] <strong>Follow Template</strong>: Use structure from similar model in <code>docs/models/</code>[0m
[38;5;243m  85[0m [38;5;249m- [ ] <strong>Include Comprehensive Sections</strong>:[0m
[38;5;243m  86[0m [38;5;249m  - [ ] Overview and problem it solves[0m
[38;5;243m  87[0m [38;5;249m  - [ ] Architecture overview with diagram[0m
[38;5;243m  88[0m [38;5;249m  - [ ] Key features and innovations[0m
[38;5;243m  89[0m [38;5;249m  - [ ] Input/output specifications[0m
[38;5;243m  90[0m [38;5;249m  - [ ] Parameters and their impact[0m
[38;5;243m  91[0m [38;5;249m  - [ ] Quick start example[0m
[38;5;243m  92[0m [38;5;249m  - [ ] Advanced usage (custom training loop, transfer learning, etc.)[0m
[38;5;243m  93[0m [38;5;249m  - [ ] Performance characteristics and benchmarks[0m
[38;5;243m  94[0m [38;5;249m  - [ ] Comparison with related architectures[0m
[38;5;243m  95[0m [38;5;249m  - [ ] Training best practices[0m
[38;5;243m  96[0m [38;5;249m  - [ ] Common issues &amp; troubleshooting[0m
[38;5;243m  97[0m [38;5;249m  - [ ] Integration with other KerasFactory components[0m
[38;5;243m  98[0m [38;5;249m  - [ ] References and citations[0m
[38;5;243m  99[0m [38;5;249m- [ ] <strong>Add Code Examples</strong>: Real, working examples (training, evaluation, prediction)[0m
[38;5;243m 100[0m [38;5;249m- [ ] <strong>Include Mathematical Details</strong>: Equations, loss functions, optimization details[0m
[38;5;243m 101[0m [38;5;249m- [ ] <strong>Add Visual Aids</strong>: Architecture diagrams, Mermaid diagrams, flowcharts[0m
[38;5;243m 102[0m [38;5;249m- [ ] <strong>Include Reproducibility Info</strong>: Random seeds, hardware requirements, etc.[0m
[38;5;243m 103[0m 
[38;5;243m 104[0m [38;5;249m### Phase 6: Jupyter Notebook Example[0m
[38;5;243m 105[0m [38;5;249m- [ ] <strong>Create Notebook</strong>: Create <code>notebooks/your_model_name_demo.ipynb</code> or <code>your_model_name_end_to_end_demo.ipynb</code>[0m
[38;5;243m 106[0m [38;5;249m- [ ] <strong>Include Sections</strong>:[0m
[38;5;243m 107[0m [38;5;249m  - [ ] Title and description[0m
[38;5;243m 108[0m [38;5;249m  - [ ] Setup and imports[0m
[38;5;243m 109[0m [38;5;249m  - [ ] Data generation/loading[0m
[38;5;243m 110[0m [38;5;249m  - [ ] Data exploration/visualization[0m
[38;5;243m 111[0m [38;5;249m  - [ ] Model creation and architecture overview[0m
[38;5;243m 112[0m [38;5;249m  - [ ] Model training with visualization[0m
[38;5;243m 113[0m [38;5;249m  - [ ] Model evaluation[0m
[38;5;243m 114[0m [38;5;249m  - [ ] Predictions and visualization[0m
[38;5;243m 115[0m [38;5;249m  - [ ] Performance comparison (if applicable)[0m
[38;5;243m 116[0m [38;5;249m  - [ ] Model serialization and loading[0m
[38;5;243m 117[0m [38;5;249m  - [ ] Best practices and tips[0m
[38;5;243m 118[0m [38;5;249m  - [ ] Summary and conclusions[0m
[38;5;243m 119[0m [38;5;249m- [ ] <strong>Add Visualizations</strong>: [0m
[38;5;243m 120[0m [38;5;249m  - [ ] Training curves (loss, metrics)[0m
[38;5;243m 121[0m [38;5;249m  - [ ] Predictions vs actual[0m
[38;5;243m 122[0m [38;5;249m  - [ ] Performance metrics[0m
[38;5;243m 123[0m [38;5;249m  - [ ] Model comparisons (if applicable)[0m
[38;5;243m 124[0m [38;5;249m- [ ] <strong>Include Output</strong>: Run all cells to verify they work[0m
[38;5;243m 125[0m [38;5;249m- [ ] <strong>Use Interactive Plots</strong>: Plotly for better interactivity[0m
[38;5;243m 126[0m 
[38;5;243m 127[0m [38;5;249m### Phase 7: Integration &amp; Updates[0m
[38;5;243m 128[0m [38;5;249m- [ ] <strong>Update Imports</strong>: Add to <code>kerasfactory/models/__init__.py</code>[0m
[38;5;243m 129[0m [38;5;249m  - [ ] Add import statement[0m
[38;5;243m 130[0m [38;5;249m  - [ ] Add model name to <code>__all__</code> list[0m
[38;5;243m 131[0m [38;5;249m- [ ] <strong>Update API Documentation</strong>: Add entry to <code>docs/api/models.md</code>[0m
[38;5;243m 132[0m [38;5;249m  - [ ] Add model name and description[0m
[38;5;243m 133[0m [38;5;249m  - [ ] Include autodoc reference (<code>kerasfactory.models.YourModelName</code>)[0m
[38;5;243m 134[0m [38;5;249m  - [ ] List key features[0m
[38;5;243m 135[0m [38;5;249m  - [ ] Add use case recommendations[0m
[38;5;243m 136[0m [38;5;249m- [ ] <strong>Update Models Overview</strong>: If exists, add to <code>docs/models_overview.md</code> or similar[0m
[38;5;243m 137[0m [38;5;249m- [ ] <strong>Update Main README</strong>: If it's a significant model[0m
[38;5;243m 138[0m [38;5;249m  - [ ] Add to feature list[0m
[38;5;243m 139[0m [38;5;249m  - [ ] Link to documentation[0m
[38;5;243m 140[0m [38;5;249m- [ ] <strong>Update Tutorials</strong>: If introducing new concepts[0m
[38;5;243m 141[0m [38;5;249m- [ ] <strong>Update Data Analyzer</strong>: If applicable, add to <code>kerasfactory/utils/data_analyzer.py</code>[0m
[38;5;243m 142[0m 
[38;5;243m 143[0m [38;5;249m### Phase 8: Quality Assurance[0m
[38;5;243m 144[0m [38;5;249m- [ ] <strong>Run All Tests</strong>: [0m
[38;5;243m 145[0m [38;5;249m  - [ ] Model tests pass: <code>pytest tests/models/test__YourModelName.py -v</code>[0m
[38;5;243m 146[0m [38;5;249m  - [ ] All layer tests pass: <code>pytest tests/layers/ -v</code>[0m
[38;5;243m 147[0m [38;5;249m  - [ ] No regressions: <code>pytest tests/ -v</code>[0m
[38;5;243m 148[0m [38;5;249m- [ ] <strong>Pre-commit Hooks</strong>: Run <code>pre-commit run --all-files</code>[0m
[38;5;243m 149[0m [38;5;249m  - [ ] Black formatting passes[0m
[38;5;243m 150[0m [38;5;249m  - [ ] Ruff linting passes[0m
[38;5;243m 151[0m [38;5;249m  - [ ] No unused imports or variables[0m
[38;5;243m 152[0m [38;5;249m  - [ ] Proper type hints[0m
[38;5;243m 153[0m [38;5;249m  - [ ] Docstring formatting[0m
[38;5;243m 154[0m [38;5;249m- [ ] <strong>Documentation Build</strong>: <code>mkdocs serve</code> builds without errors[0m
[38;5;243m 155[0m [38;5;249m  - [ ] No broken links[0m
[38;5;243m 156[0m [38;5;249m  - [ ] All images load correctly[0m
[38;5;243m 157[0m [38;5;249m  - [ ] Code examples render properly[0m
[38;5;243m 158[0m [38;5;249m- [ ] <strong>Notebook Execution</strong>: Run full notebook end-to-end[0m
[38;5;243m 159[0m [38;5;249m  - [ ] All cells execute without errors[0m
[38;5;243m 160[0m [38;5;249m  - [ ] Visualizations render correctly[0m
[38;5;243m 161[0m [38;5;249m  - [ ] No performance issues (reasonable execution time)[0m
[38;5;243m 162[0m [38;5;249m- [ ] <strong>Code Review</strong>: Request code review from team[0m
[38;5;243m 163[0m [38;5;249m- [ ] <strong>Integration Test</strong>: Test model in real-world scenario[0m
[38;5;243m 164[0m [38;5;249m- [ ] <strong>Performance Test</strong>: Verify model meets performance requirements[0m
[38;5;243m 165[0m 
[38;5;243m 166[0m [38;5;249m---[0m
[38;5;243m 167[0m 
[38;5;243m 168[0m [38;5;249m## Key Requirements[0m
[38;5;243m 169[0m 
[38;5;243m 170[0m [38;5;249m### ‚úÖ Keras 3 Only[0m
[38;5;243m 171[0m [38;5;249mAll model implementations MUST use only Keras 3 operations and layers. NO TensorFlow dependencies are allowed in model implementations.[0m
[38;5;243m 172[0m [38;5;249m- <strong>Allowed</strong>: <code>keras.layers</code>, <code>keras.ops</code>, <code>kerasfactory.layers</code>, <code>kerasfactory.models</code>[0m
[38;5;243m 173[0m [38;5;249m- <strong>NOT Allowed</strong>: <code>tensorflow.python.*</code>, <code>tf.nn.*</code> (use <code>keras.ops.*</code> instead)[0m
[38;5;243m 174[0m [38;5;249m- <strong>Exception</strong>: TensorFlow can ONLY be used in test files and notebooks for validation[0m
[38;5;243m 175[0m 
[38;5;243m 176[0m [38;5;249m### ‚úÖ Reusable Components[0m
[38;5;243m 177[0m [38;5;249mAvoid embedding layer logic directly in models. Create standalone, reusable layers first:[0m
[38;5;243m 178[0m [38;5;249m- <strong>Good</strong>: Implement <code>TemporalMixing</code> as a layer, use it in <code>TSMixer</code> model[0m
[38;5;243m 179[0m [38;5;249m- <strong>Bad</strong>: Implement temporal mixing logic directly in model[0m
[38;5;243m 180[0m 
[38;5;243m 181[0m [38;5;249m### ‚úÖ Proper Inheritance[0m
[38;5;243m 182[0m [38;5;249m- Models must inherit from <code>kerasfactory.models._base.BaseModel</code>[0m
[38;5;243m 183[0m [38;5;249m- Layers must inherit from <code>kerasfactory.layers._base_layer.BaseLayer</code>[0m
[38;5;243m 184[0m 
[38;5;243m 185[0m [38;5;249m### ‚úÖ Type Annotations (Python 3.12+)[0m
[38;5;243m 186[0m [38;5;249mUse modern type hints with the union operator:[0m
[38;5;243m 187[0m [38;5;249m<code>python[0m
[38;5;243m 188[0m [38;5;249mparam: int | float = 0.1  # Instead of Union[int, float][0m
[38;5;243m 189[0m [38;5;249m</code>[0m
[38;5;243m 190[0m 
[38;5;243m 191[0m [38;5;249m### ‚úÖ Comprehensive Documentation[0m
[38;5;243m 192[0m [38;5;249mEvery model needs extensive documentation covering usage, architecture, and best practices.[0m
[38;5;243m 193[0m 
[38;5;243m 194[0m [38;5;249m---[0m
[38;5;243m 195[0m 
[38;5;243m 196[0m [38;5;249m## Implementation Pattern[0m
[38;5;243m 197[0m 
[38;5;243m 198[0m [38;5;249mFollow this pattern for implementing models:[0m
[38;5;243m 199[0m 
[38;5;243m 200[0m [38;5;249m<code>python[0m
[38;5;243m 201[0m [38;5;249m"""[0m
[38;5;243m 202[0m [38;5;249mModule docstring describing the model's purpose and functionality.[0m
[38;5;243m 203[0m [38;5;249m"""[0m
[38;5;243m 204[0m 
[38;5;243m 205[0m [38;5;249mfrom typing import Any[0m
[38;5;243m 206[0m [38;5;249mfrom loguru import logger[0m
[38;5;243m 207[0m [38;5;249mfrom keras import layers, ops[0m
[38;5;243m 208[0m [38;5;249mfrom keras import KerasTensor[0m
[38;5;243m 209[0m [38;5;249mfrom keras.saving import register_keras_serializable[0m
[38;5;243m 210[0m [38;5;249mfrom kerasfactory.models._base import BaseModel[0m
[38;5;243m 211[0m [38;5;249mfrom kerasfactory.layers import YourCustomLayer  # Use existing layers[0m
[38;5;243m 212[0m 
[38;5;243m 213[0m [38;5;249m@register_keras_serializable(package="kerasfactory.models")[0m
[38;5;243m 214[0m [38;5;249mclass YourCustomModel(BaseModel):[0m
[38;5;243m 215[0m [38;5;249m    """Comprehensive model description.[0m
[38;5;243m 216[0m [38;5;249m    [0m
[38;5;243m 217[0m [38;5;249m    This model implements [algorithm/architecture] for [task].[0m
[38;5;243m 218[0m [38;5;249m    It combines multiple layers to [describe what it does].[0m
[38;5;243m 219[0m [38;5;249m    [0m
[38;5;243m 220[0m [38;5;249m    Args:[0m
[38;5;243m 221[0m [38;5;249m        param1: Description with type and default.[0m
[38;5;243m 222[0m [38;5;249m        param2: Description with type and default.[0m
[38;5;243m 223[0m [38;5;249m        name: Optional name for the model.[0m
[38;5;243m 224[0m [38;5;249m    [0m
[38;5;243m 225[0m [38;5;249m    Input shape:[0m
[38;5;243m 226[0m [38;5;249m        `(batch_size, ...)` - Description of input.[0m
[38;5;243m 227[0m [38;5;249m    [0m
[38;5;243m 228[0m [38;5;249m    Output shape:[0m
[38;5;243m 229[0m [38;5;249m        `(batch_size, ...)` - Description of output.[0m
[38;5;243m 230[0m [38;5;249m    [0m
[38;5;243m 231[0m [38;5;249m    Example:[0m
[38;5;243m 232[0m [38;5;249m</code>python[0m
[38;5;243m 233[0m [38;5;249m        import keras[0m
[38;5;243m 234[0m [38;5;249m        from kerasfactory.models import YourCustomModel[0m
[38;5;243m 235[0m [38;5;249m        [0m
[38;5;243m 236[0m [38;5;249m        # Create model[0m
[38;5;243m 237[0m [38;5;249m        model = YourCustomModel(param1=value1, param2=value2)[0m
[38;5;243m 238[0m [38;5;249m        model.compile(optimizer='adam', loss='mse')[0m
[38;5;243m 239[0m [38;5;249m        [0m
[38;5;243m 240[0m [38;5;249m        # Train[0m
[38;5;243m 241[0m [38;5;249m        model.fit(X_train, y_train, epochs=10)[0m
[38;5;243m 242[0m [38;5;249m        [0m
[38;5;243m 243[0m [38;5;249m        # Predict[0m
[38;5;243m 244[0m [38;5;249m        predictions = model.predict(X_test)[0m
[38;5;243m 245[0m [38;5;249m        <code>[0m
[38;5;243m 246[0m [38;5;249m    [0m
[38;5;243m 247[0m [38;5;249m    References:[0m
[38;5;243m 248[0m [38;5;249m        - Author et al. (Year). "Paper Title". Journal.[0m
[38;5;243m 249[0m [38;5;249m    """[0m
[38;5;243m 250[0m 
[38;5;243m 251[0m [38;5;249m    def __init__([0m
[38;5;243m 252[0m [38;5;249m        self,[0m
[38;5;243m 253[0m [38;5;249m        param1: int = 32,[0m
[38;5;243m 254[0m [38;5;249m        param2: float = 0.1,[0m
[38;5;243m 255[0m [38;5;249m        name: str | None = None,[0m
[38;5;243m 256[0m [38;5;249m        **kwargs: Any[0m
[38;5;243m 257[0m [38;5;249m    ) -&gt; None:[0m
[38;5;243m 258[0m [38;5;249m        # Set private attributes[0m
[38;5;243m 259[0m [38;5;249m        self._param1 = param1[0m
[38;5;243m 260[0m [38;5;249m        self._param2 = param2[0m
[38;5;243m 261[0m 
[38;5;243m 262[0m [38;5;249m        # Validate parameters[0m
[38;5;243m 263[0m [38;5;249m        self._validate_params()[0m
[38;5;243m 264[0m 
[38;5;243m 265[0m [38;5;249m        # Set public attributes BEFORE super().__init__()[0m
[38;5;243m 266[0m [38;5;249m        self.param1 = self._param1[0m
[38;5;243m 267[0m [38;5;249m        self.param2 = self._param2[0m
[38;5;243m 268[0m 
[38;5;243m 269[0m [38;5;249m        # Call parent's __init__[0m
[38;5;243m 270[0m [38;5;249m        super().__init__(name=name, **kwargs)[0m
[38;5;243m 271[0m 
[38;5;243m 272[0m [38;5;249m    def _validate_params(self) -&gt; None:[0m
[38;5;243m 273[0m [38;5;249m        """Validate model parameters."""[0m
[38;5;243m 274[0m [38;5;249m        if self._param1 &lt; 1:[0m
[38;5;243m 275[0m [38;5;249m            raise ValueError(f"param1 must be &gt;= 1, got {self._param1}")[0m
[38;5;243m 276[0m [38;5;249m        if not (0 &lt;= self._param2 &lt;= 1):[0m
[38;5;243m 277[0m [38;5;249m            raise ValueError(f"param2 must be in [0, 1], got {self._param2}")[0m
[38;5;243m 278[0m 
[38;5;243m 279[0m [38;5;249m    def build(self, input_shape: tuple[int, ...] | list[tuple[int, ...]]) -&gt; None:[0m
[38;5;243m 280[0m [38;5;249m        """Build model with given input shape(s).[0m
[38;5;243m 281[0m 
[38;5;243m 282[0m [38;5;249m        Args:[0m
[38;5;243m 283[0m [38;5;249m            input_shape: Tuple(s) of integers defining input shape(s).[0m
[38;5;243m 284[0m [38;5;249m        """[0m
[38;5;243m 285[0m [38;5;249m        # Initialize all layers[0m
[38;5;243m 286[0m [38;5;249m        self.layer1 = YourCustomLayer(self._param1)[0m
[38;5;243m 287[0m [38;5;249m        self.layer2 = layers.Dense(self._param1)[0m
[38;5;243m 288[0m [38;5;249m        self.output_layer = layers.Dense(10)  # or task-specific output[0m
[38;5;243m 289[0m [38;5;249m        [0m
[38;5;243m 290[0m [38;5;249m        logger.debug(f"Building {self.__class__.__name__} with params: "[0m
[38;5;243m 291[0m [38;5;249m                    f"param1={self.param1}, param2={self.param2}")[0m
[38;5;243m 292[0m [38;5;249m        super().build(input_shape)[0m
[38;5;243m 293[0m 
[38;5;243m 294[0m [38;5;249m    def call(self, inputs: KerasTensor, training: bool | None = None) -&gt; KerasTensor:[0m
[38;5;243m 295[0m [38;5;249m        """Forward pass.[0m
[38;5;243m 296[0m 
[38;5;243m 297[0m [38;5;249m        Args:[0m
[38;5;243m 298[0m [38;5;249m            inputs: Input tensor(s).[0m
[38;5;243m 299[0m [38;5;249m            training: Whether in training mode.[0m
[38;5;243m 300[0m 
[38;5;243m 301[0m [38;5;249m        Returns:[0m
[38;5;243m 302[0m [38;5;249m            Model output tensor.[0m
[38;5;243m 303[0m [38;5;249m        """[0m
[38;5;243m 304[0m [38;5;249m        # Forward pass through layers[0m
[38;5;243m 305[0m [38;5;249m        x = self.layer1(inputs, training=training)[0m
[38;5;243m 306[0m [38;5;249m        x = self.layer2(x)[0m
[38;5;243m 307[0m [38;5;249m        output = self.output_layer(x)[0m
[38;5;243m 308[0m [38;5;249m        return output[0m
[38;5;243m 309[0m 
[38;5;243m 310[0m [38;5;249m    def get_config(self) -&gt; dict[str, Any]:[0m
[38;5;243m 311[0m [38;5;249m        """Returns model configuration.[0m
[38;5;243m 312[0m 
[38;5;243m 313[0m [38;5;249m        Returns:[0m
[38;5;243m 314[0m [38;5;249m            Dictionary with model configuration.[0m
[38;5;243m 315[0m [38;5;249m        """[0m
[38;5;243m 316[0m [38;5;249m        config = super().get_config()[0m
[38;5;243m 317[0m [38;5;249m        config.update({[0m
[38;5;243m 318[0m [38;5;249m            "param1": self.param1,[0m
[38;5;243m 319[0m [38;5;249m            "param2": self.param2,[0m
[38;5;243m 320[0m [38;5;249m        })[0m
[38;5;243m 321[0m [38;5;249m        return config[0m
[38;5;243m 322[0m [38;5;249m</code>[0m
[38;5;243m 323[0m 
[38;5;243m 324[0m [38;5;249m---[0m
[38;5;243m 325[0m 
[38;5;243m 326[0m [38;5;249m## Model Serialization &amp; Loading[0m
[38;5;243m 327[0m 
[38;5;243m 328[0m [38;5;249mEnsure your model can be saved and loaded correctly:[0m
[38;5;243m 329[0m 
[38;5;243m 330[0m [38;5;249m<code>python[0m
[38;5;243m 331[0m [38;5;249mimport keras[0m
[38;5;243m 332[0m [38;5;249mimport tempfile[0m
[38;5;243m 333[0m 
[38;5;243m 334[0m [38;5;249m# Create and train model[0m
[38;5;243m 335[0m [38;5;249mmodel = YourCustomModel(param1=32, param2=0.1)[0m
[38;5;243m 336[0m [38;5;249mmodel.compile(optimizer='adam', loss='mse', metrics=['mae'])[0m
[38;5;243m 337[0m [38;5;249mmodel.fit(X_train, y_train, epochs=10, verbose=0)[0m
[38;5;243m 338[0m 
[38;5;243m 339[0m [38;5;249m# Save full model[0m
[38;5;243m 340[0m [38;5;249mwith tempfile.TemporaryDirectory() as tmpdir:[0m
[38;5;243m 341[0m [38;5;249m    # Save with architecture[0m
[38;5;243m 342[0m [38;5;249m    model.save(f'{tmpdir}/model.keras')[0m
[38;5;243m 343[0m [38;5;249m    [0m
[38;5;243m 344[0m [38;5;249m    # Load full model[0m
[38;5;243m 345[0m [38;5;249m    loaded_model = keras.models.load_model(f'{tmpdir}/model.keras')[0m
[38;5;243m 346[0m [38;5;249m    [0m
[38;5;243m 347[0m [38;5;249m    # Verify predictions are identical[0m
[38;5;243m 348[0m [38;5;249m    pred1 = model.predict(X_test)[0m
[38;5;243m 349[0m [38;5;249m    pred2 = loaded_model.predict(X_test)[0m
[38;5;243m 350[0m [38;5;249m    [0m
[38;5;243m 351[0m [38;5;249m    # Save only weights[0m
[38;5;243m 352[0m [38;5;249m    model.save_weights(f'{tmpdir}/weights.h5')[0m
[38;5;243m 353[0m [38;5;249m    [0m
[38;5;243m 354[0m [38;5;249m    # Load weights into new model[0m
[38;5;243m 355[0m [38;5;249m    new_model = YourCustomModel(param1=32, param2=0.1)[0m
[38;5;243m 356[0m [38;5;249m    new_model.load_weights(f'{tmpdir}/weights.h5')[0m
[38;5;243m 357[0m [38;5;249m</code>[0m
[38;5;243m 358[0m 
[38;5;243m 359[0m [38;5;249m---[0m
[38;5;243m 360[0m 
[38;5;243m 361[0m [38;5;249m## Testing Template[0m
[38;5;243m 362[0m 
[38;5;243m 363[0m [38;5;249mCreate comprehensive tests following this template:[0m
[38;5;243m 364[0m 
[38;5;243m 365[0m [38;5;249m<code>python[0m
[38;5;243m 366[0m [38;5;249mimport unittest[0m
[38;5;243m 367[0m [38;5;249mimport numpy as np[0m
[38;5;243m 368[0m [38;5;249mimport tensorflow as tf[0m
[38;5;243m 369[0m [38;5;249mimport keras[0m
[38;5;243m 370[0m 
[38;5;243m 371[0m [38;5;249mfrom kerasfactory.models import YourCustomModel[0m
[38;5;243m 372[0m 
[38;5;243m 373[0m [38;5;249mclass TestYourCustomModel(unittest.TestCase):[0m
[38;5;243m 374[0m [38;5;249m    """Test suite for YourCustomModel."""[0m
[38;5;243m 375[0m 
[38;5;243m 376[0m [38;5;249m    def setUp(self) -&gt; None:[0m
[38;5;243m 377[0m [38;5;249m        """Set up test fixtures."""[0m
[38;5;243m 378[0m [38;5;249m        self.model = YourCustomModel(param1=32, param2=0.1)[0m
[38;5;243m 379[0m [38;5;249m        self.model.compile(optimizer='adam', loss='mse', metrics=['mae'])[0m
[38;5;243m 380[0m [38;5;249m        [0m
[38;5;243m 381[0m [38;5;249m        # Create sample data[0m
[38;5;243m 382[0m [38;5;249m        self.X_train = np.random.randn(100, 20).astype(np.float32)[0m
[38;5;243m 383[0m [38;5;249m        self.y_train = np.random.randn(100, 10).astype(np.float32)[0m
[38;5;243m 384[0m [38;5;249m        self.X_test = np.random.randn(20, 20).astype(np.float32)[0m
[38;5;243m 385[0m [38;5;249m        self.y_test = np.random.randn(20, 10).astype(np.float32)[0m
[38;5;243m 386[0m 
[38;5;243m 387[0m [38;5;249m    def test_initialization(self) -&gt; None:[0m
[38;5;243m 388[0m [38;5;249m        """Test model initialization."""[0m
[38;5;243m 389[0m [38;5;249m        self.assertEqual(self.model.param1, 32)[0m
[38;5;243m 390[0m [38;5;249m        self.assertEqual(self.model.param2, 0.1)[0m
[38;5;243m 391[0m 
[38;5;243m 392[0m [38;5;249m    def test_invalid_parameters(self) -&gt; None:[0m
[38;5;243m 393[0m [38;5;249m        """Test invalid parameter handling."""[0m
[38;5;243m 394[0m [38;5;249m        with self.assertRaises(ValueError):[0m
[38;5;243m 395[0m [38;5;249m            YourCustomModel(param1=-1)[0m
[38;5;243m 396[0m 
[38;5;243m 397[0m [38;5;249m    def test_forward_pass(self) -&gt; None:[0m
[38;5;243m 398[0m [38;5;249m        """Test forward pass."""[0m
[38;5;243m 399[0m [38;5;249m        output = self.model(self.X_test)[0m
[38;5;243m 400[0m [38;5;249m        self.assertEqual(output.shape, (20, 10))[0m
[38;5;243m 401[0m 
[38;5;243m 402[0m [38;5;249m    def test_training(self) -&gt; None:[0m
[38;5;243m 403[0m [38;5;249m        """Test model training."""[0m
[38;5;243m 404[0m [38;5;249m        history = self.model.fit([0m
[38;5;243m 405[0m [38;5;249m            self.X_train, self.y_train,[0m
[38;5;243m 406[0m [38;5;249m            epochs=2, batch_size=32, verbose=0[0m
[38;5;243m 407[0m [38;5;249m        )[0m
[38;5;243m 408[0m [38;5;249m        [0m
[38;5;243m 409[0m [38;5;249m        # Verify training occurred (loss changed)[0m
[38;5;243m 410[0m [38;5;249m        self.assertIsNotNone(history.history['loss'])[0m
[38;5;243m 411[0m 
[38;5;243m 412[0m [38;5;249m    def test_serialization(self) -&gt; None:[0m
[38;5;243m 413[0m [38;5;249m        """Test model serialization."""[0m
[38;5;243m 414[0m [38;5;249m        config = self.model.get_config()[0m
[38;5;243m 415[0m [38;5;249m        new_model = YourCustomModel.from_config(config)[0m
[38;5;243m 416[0m [38;5;249m        new_model.compile(optimizer='adam', loss='mse')[0m
[38;5;243m 417[0m [38;5;249m        [0m
[38;5;243m 418[0m [38;5;249m        output1 = self.model(self.X_test)[0m
[38;5;243m 419[0m [38;5;249m        output2 = new_model(self.X_test)[0m
[38;5;243m 420[0m [38;5;249m        [0m
[38;5;243m 421[0m [38;5;249m        np.testing.assert_allclose(output1, output2, rtol=1e-5)[0m
[38;5;243m 422[0m 
[38;5;243m 423[0m [38;5;249m    def test_save_load(self) -&gt; None:[0m
[38;5;243m 424[0m [38;5;249m        """Test model save and load."""[0m
[38;5;243m 425[0m [38;5;249m        import tempfile[0m
[38;5;243m 426[0m [38;5;249m        [0m
[38;5;243m 427[0m [38;5;249m        with tempfile.TemporaryDirectory() as tmpdir:[0m
[38;5;243m 428[0m [38;5;249m            model_path = f'{tmpdir}/model.keras'[0m
[38;5;243m 429[0m [38;5;249m            self.model.save(model_path)[0m
[38;5;243m 430[0m [38;5;249m            [0m
[38;5;243m 431[0m [38;5;249m            loaded_model = keras.models.load_model(model_path)[0m
[38;5;243m 432[0m [38;5;249m            loaded_model.compile(optimizer='adam', loss='mse')[0m
[38;5;243m 433[0m [38;5;249m            [0m
[38;5;243m 434[0m [38;5;249m            pred1 = self.model.predict(self.X_test, verbose=0)[0m
[38;5;243m 435[0m [38;5;249m            pred2 = loaded_model.predict(self.X_test, verbose=0)[0m
[38;5;243m 436[0m [38;5;249m            [0m
[38;5;243m 437[0m [38;5;249m            np.testing.assert_allclose(pred1, pred2, rtol=1e-5)[0m
[38;5;243m 438[0m 
[38;5;243m 439[0m [38;5;249mif __name__ == "__main__":[0m
[38;5;243m 440[0m [38;5;249m    unittest.main()[0m
[38;5;243m 441[0m [38;5;249m</code>[0m
[38;5;243m 442[0m 
[38;5;243m 443[0m [38;5;249m---[0m
[38;5;243m 444[0m 
[38;5;243m 445[0m [38;5;249m## Common Pitfalls &amp; Solutions[0m
[38;5;243m 446[0m 
[38;5;243m 447[0m [38;5;249m| Pitfall | Problem | Solution |[0m
[38;5;243m 448[0m [38;5;249m|---------|---------|----------|[0m
[38;5;243m 449[0m [38;5;249m| Embedded layer logic | Code not reusable | Create standalone layers first |[0m
[38;5;243m 450[0m [38;5;249m| TensorFlow dependencies | Using <code>tf.*</code> operations | Use <code>keras.ops.*</code> and <code>kerasfactory.layers</code> |[0m
[38;5;243m 451[0m [38;5;249m| Wrong inheritance | Type errors | Inherit from <code>BaseModel</code> |[0m
[38;5;243m 452[0m [38;5;249m| Incomplete serialization | Cannot save/load | Include all parameters in <code>get_config()</code> |[0m
[38;5;243m 453[0m [38;5;249m| Missing layer instantiation | Runtime errors | Initialize all layers in <code>build()</code> |[0m
[38;5;243m 454[0m [38;5;249m| Wrong attribute order | <code>AttributeError</code> | Set public attributes BEFORE <code>super().__init__()</code> |[0m
[38;5;243m 455[0m [38;5;249m| Insufficient tests | Bugs in production | Write comprehensive tests |[0m
[38;5;243m 456[0m [38;5;249m| Inadequate documentation | Users confused | Write detailed guide with examples |[0m
[38;5;243m 457[0m [38;5;249m| No notebook example | Hard to get started | Create end-to-end demo notebook |[0m
[38;5;243m 458[0m 
[38;5;243m 459[0m [38;5;249m---[0m
[38;5;243m 460[0m 
[38;5;243m 461[0m [38;5;249m## Next Steps[0m
[38;5;243m 462[0m 
[38;5;243m 463[0m [38;5;249mAfter implementing and testing your model:[0m
[38;5;243m 464[0m 
[38;5;243m 465[0m [38;5;249m1. <strong>Submit for Review</strong>: Create a pull request with your implementation[0m
[38;5;243m 466[0m [38;5;249m2. <strong>Address Feedback</strong>: Update based on review comments[0m
[38;5;243m 467[0m [38;5;249m3. <strong>Final Testing</strong>: Run full test suite one more time[0m
[38;5;243m 468[0m [38;5;249m4. <strong>Merge</strong>: Once approved, merge to main branch[0m
[38;5;243m 469[0m [38;5;249m5. <strong>Announce</strong>: Notify team about new model availability[0m
[38;5;243m 470[0m [38;5;249m6. <strong>Update README</strong>: Add to main README and features list[0m
[38;5;243m 471[0m 
[38;5;243m 472[0m [38;5;249m---[0m
[38;5;243m 473[0m 
[38;5;243m 474[0m [38;5;249m## Related Resources[0m
[38;5;243m 475[0m 
[38;5;243m 476[0m [38;5;249m- <a href="layers_implementation_guide.html">Layer Implementation Guide</a> - Detailed layer implementation guide[0m
[38;5;243m 477[0m [38;5;249m- <a href="api/models.html">API Reference - Models</a> - Model API documentation[0m
[38;5;243m 478[0m [38;5;249m- <a href="contributing.html">Contributing Guidelines</a> - Project contribution guidelines[0m
[38;5;243m 479[0m [38;5;249m- <a href="https://keras.io/api/">Keras 3 Documentation</a> - Keras 3 API reference[0m
[38;5;243m 480[0m </p>












                
  
  

              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.path", "navigation.top", "navigation.instant", "navigation.tracking", "navigation.indexes", "search.highlight", "search.share", "search.suggest", "content.code.copy", "content.code.annotate", "content.code.select", "content.tabs.link", "content.action.edit", "content.action.view", "toc.follow", "toc.integrate"], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>